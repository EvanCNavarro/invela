> rest-express@1.0.0 dev
Database migrations disabled - schema already applied
[EmailService] Initializing email service
[EmailService] Email service initialized successfully
[OpenAI] Service initialized with API key: API key is set
Database module not found, creating a mock implementation
Database module not found, creating a mock implementation
Database module not found, creating a mock implementation
[Auth] Setting up authentication...
[Auth] Authentication setup completed
[KY3P-BATCH-UPDATE] Registering KY3P batch update routes
Registering KY3P batch update routes
[KY3P-BATCH-UPDATE] Registering KY3P batch update routes
Registering KY3P batch update routes
[2025-05-01T17:26:46.611Z] [INFO] [KY3P-Field-Update] Registering KY3P field update routes
[2025-05-01T17:26:46.612Z] [INFO] [OpenBankingRoutes] [OpenBankingRoutes] Setting up routes...
[Routes] Setting up unified form submission router
[Routes] Successfully registered unified form submission router
[Routes] Setting up transactional form submission router
[Routes] Successfully registered transactional form submission router
[Routes] Routes setup completed
[2025-05-01T17:26:46.614Z] [INFO] [WebSocketService] Initializing WebSocket server
[2025-05-01T17:26:46.614Z] [INFO] [WebSocketService] WebSocket server initialized successfully
5:26:46 PM [info] Setting up Vite development server
5:26:46 PM [express] Server running on 0.0.0.0:5000
5:26:46 PM [express] Environment: development
[Deployment] Server running on 0.0.0.0:5000
[Deployment] Environment: development
[Deployment] Port forwarding: Custom port: 5000
[Deployment] Development mode: Hot reloading enabled
[2025-05-01T17:26:47.566Z] New client connected to the pool (1/3)
[2025-05-01T17:26:56.255Z] New client connected to the pool (2/3)
[2025-05-01T17:26:56.307Z] New client connected to the pool (3/3)
[2025-05-01T17:26:58.830Z] [INFO] [WebSocketService] New WebSocket connection established {"path":"/ws","headers":{"host":"9606074c-a9ad-4fe1-8fe5-3d9c3eed0606-00-33ar2rv36ligj.picard.replit.dev","origin":"https://9606074c-a9ad-4fe1-8fe5-3d9c3eed0606-00-33ar2rv36ligj.picard.replit.dev"}}
[Auth] Unauthenticated user session
[2025-05-01T17:26:58.925Z] [INFO] [WebSocketService] New WebSocket connection established {"path":"/ws","headers":{"host":"9606074c-a9ad-4fe1-8fe5-3d9c3eed0606-00-33ar2rv36ligj.picard.replit.dev","origin":"https://9606074c-a9ad-4fe1-8fe5-3d9c3eed0606-00-33ar2rv36ligj.picard.replit.dev"}}
[2025-05-01T17:26:59.956Z] [INFO] [WebSocketService] WebSocket connection closed
[2025-05-01T17:26:59.957Z] [INFO] [WebSocketService] WebSocket connection closed
[Auth] Returning user session data
[Current Company] Fetching company for user: { userId: 304, companyId: 262 }
[Tasks] ====== Starting task fetch =====
[Tasks] User details: { id: 304, company_id: 262, email: 'e@e.com' }
[2025-05-01T17:27:05.126Z] [INFO] [KYBRoutes] Performing dynamic task unlocking check for company {"companyId":262,"userId":304}
[Current Company] Found company: {
  id: 262,
  name: 'DemoTest',
  onboardingCompleted: false,
  riskScore: null,
  chosenScore: null,
  isDemo: true
}
[2025-05-01T17:27:05.157Z] [INFO] [KYBRoutes] No completed KYB tasks found, skipping security task unlock check {"companyId":262}
[Tasks] Automatically unlocking all tasks for company { userId: 304, companyId: 262, requestedBy: 'automatic_task_unlock' }
[2025-05-01T17:27:05.158Z] [INFO] [TaskDependencies] [TaskDependencies] Unlocking ALL tasks for company {"companyId":262}
5:27:05 PM [info] GET /api/companies/current 304 in 69ms :: {"id":262,"name":"DemoTest","category":"FinTech","is_demo":true,"revenue_tier...
[2025-05-01T17:27:05.189Z] [INFO] [TaskDependencies] [TaskDependencies] Found tasks to unlock {"companyId":262,"count":2,"taskIds":[718,719],"taskTypes":["ky3p","open_banking"]}
[2025-05-01T17:27:05.219Z] [INFO] [WebSocketService] New WebSocket connection established {"path":"/ws","headers":{"host":"9606074c-a9ad-4fe1-8fe5-3d9c3eed0606-00-33ar2rv36ligj.picard.replit.dev","origin":"https://9606074c-a9ad-4fe1-8fe5-3d9c3eed0606-00-33ar2rv36ligj.picard.replit.dev"}}
[2025-05-01T17:27:05.222Z] [INFO] [TaskDependencies] [TaskDependencies] Unlocked task {"companyId":262,"taskId":718,"taskType":"ky3p"}
[2025-05-01T17:27:05.222Z] [DEBUG] [WebSocketService] Broadcasting task update with object format {"taskId":718,"status":"not_started"}
[2025-05-01T17:27:05.222Z] [INFO] [WebSocketService] Broadcasting task_update message to 1 clients
[2025-05-01T17:27:05.222Z] [INFO] [WebSocketService] Successfully broadcasted task_update message
[2025-05-01T17:27:05.253Z] [INFO] [TaskDependencies] [TaskDependencies] Unlocked task {"companyId":262,"taskId":719,"taskType":"open_banking"}
[2025-05-01T17:27:05.253Z] [DEBUG] [WebSocketService] Broadcasting task update with object format {"taskId":719,"status":"not_started"}
[2025-05-01T17:27:05.253Z] [INFO] [WebSocketService] Broadcasting task_update message to 1 clients
[2025-05-01T17:27:05.253Z] [INFO] [WebSocketService] Successfully broadcasted task_update message
[2025-05-01T17:27:05.254Z] [INFO] [TaskDependencies] [TaskDependencies] Successfully unlocked all tasks {"companyId":262,"count":2}
[Tasks] Successfully unlocked all tasks for company: 262
[Tasks] KYB tasks found: { count: 1 }
[Tasks] Query conditions: {
  conditions: {
    condition1: 'tasks.assigned_to = 304',
    condition2: 'tasks.created_by = 304',
    condition3: "tasks.company_id = 262 AND tasks.assigned_to IS NULL AND tasks.task_scope = 'company'",
    condition4: "tasks.task_type = 'user_onboarding' AND LOWER(tasks.user_email) = LOWER('e@e.com')"
  }
}
[Tasks] Tasks found: { count: 4 }
5:27:05 PM [info] GET /api/tasks 200 in 224ms :: [{"id":716,"title":"New User Invitation: e@e.com","description":"Complete use...
5:27:05 PM [info] GET /api/companies/current 304 in 33ms :: {"id":262,"name":"DemoTest","category":"FinTech","is_demo":true,"revenue_tier...
5:27:05 PM [info] GET /api/tasks 304 in 32ms :: [{"id":716,"title":"New User Invitation: e@e.com","description":"Complete use...
[2025-05-01T17:27:05.714Z] [INFO] [WebSocketService] New WebSocket connection established {"path":"/ws","headers":{"host":"9606074c-a9ad-4fe1-8fe5-3d9c3eed0606-00-33ar2rv36ligj.picard.replit.dev","origin":"https://9606074c-a9ad-4fe1-8fe5-3d9c3eed0606-00-33ar2rv36ligj.picard.replit.dev"}}
[2025-05-01T17:27:06.215Z] [INFO] [WebSocketService] New WebSocket connection established {"path":"/ws","headers":{"host":"9606074c-a9ad-4fe1-8fe5-3d9c3eed0606-00-33ar2rv36ligj.picard.replit.dev","origin":"https://9606074c-a9ad-4fe1-8fe5-3d9c3eed0606-00-33ar2rv36ligj.picard.replit.dev"}}
5:27:08 PM [info] GET /api/companies/current 304 in 31ms :: {"id":262,"name":"DemoTest","category":"FinTech","is_demo":true,"revenue_tier...
5:27:11 PM [info] GET /api/companies/current 304 in 31ms :: {"id":262,"name":"DemoTest","category":"FinTech","is_demo":true,"revenue_tier...
5:27:14 PM [info] GET /api/companies/current 304 in 38ms :: {"id":262,"name":"DemoTest","category":"FinTech","is_demo":true,"revenue_tier...
5:27:17 PM [info] GET /api/companies/current 304 in 32ms :: {"id":262,"name":"DemoTest","category":"FinTech","is_demo":true,"revenue_tier...
[Current Company] Using cached company data: 262
5:27:20 PM [info] GET /api/companies/current 304 in 39ms :: {"id":262,"name":"DemoTest","category":"FinTech","is_demo":true,"revenue_tier...
5:27:20 PM [info] GET /api/tasks 304 in 33ms :: [{"id":716,"title":"New User Invitation: e@e.com","description":"Complete use...
5:27:23 PM [info] GET /api/companies/current 304 in 31ms :: {"id":262,"name":"DemoTest","category":"FinTech","is_demo":true,"revenue_tier...
5:27:26 PM [info] GET /api/companies/current 304 in 33ms :: {"id":262,"name":"DemoTest","category":"FinTech","is_demo":true,"revenue_tier...
5:27:29 PM [info] GET /api/companies/current 304 in 34ms :: {"id":262,"name":"DemoTest","category":"FinTech","is_demo":true,"revenue_tier...
5:27:32 PM [info] GET /api/companies/current 304 in 32ms :: {"id":262,"name":"DemoTest","category":"FinTech","is_demo":true,"revenue_tier...
5:27:35 PM [info] GET /api/companies/current 304 in 38ms :: {"id":262,"name":"DemoTest","category":"FinTech","is_demo":true,"revenue_tier...
[Tasks] ====== Starting task fetch =====
[Tasks] User details: { id: 304, company_id: 262, email: 'e@e.com' }
[2025-05-01T17:27:35.705Z] [INFO] [KYBRoutes] Performing dynamic task unlocking check for company {"companyId":262,"userId":304}
[2025-05-01T17:27:35.737Z] [INFO] [KYBRoutes] No completed KYB tasks found, skipping security task unlock check {"companyId":262}
[Tasks] Automatically unlocking all tasks for company { userId: 304, companyId: 262, requestedBy: 'automatic_task_unlock' }
[2025-05-01T17:27:35.738Z] [INFO] [TaskDependencies] [TaskDependencies] Unlocking ALL tasks for company {"companyId":262}
[2025-05-01T17:27:35.771Z] [INFO] [TaskDependencies] [TaskDependencies] Found tasks to unlock {"companyId":262,"count":2,"taskIds":[718,719],"taskTypes":["ky3p","open_banking"]}
[2025-05-01T17:27:35.807Z] [INFO] [TaskDependencies] [TaskDependencies] Unlocked task {"companyId":262,"taskId":718,"taskType":"ky3p"}
[2025-05-01T17:27:35.808Z] [DEBUG] [WebSocketService] Broadcasting task update with object format {"taskId":718,"status":"not_started"}
[2025-05-01T17:27:35.808Z] [INFO] [WebSocketService] Broadcasting task_update message to 3 clients
[2025-05-01T17:27:35.808Z] [INFO] [WebSocketService] Successfully broadcasted task_update message
[2025-05-01T17:27:35.840Z] [INFO] [TaskDependencies] [TaskDependencies] Unlocked task {"companyId":262,"taskId":719,"taskType":"open_banking"}
[2025-05-01T17:27:35.840Z] [DEBUG] [WebSocketService] Broadcasting task update with object format {"taskId":719,"status":"not_started"}
[2025-05-01T17:27:35.840Z] [INFO] [WebSocketService] Broadcasting task_update message to 3 clients
[2025-05-01T17:27:35.841Z] [INFO] [WebSocketService] Successfully broadcasted task_update message
[2025-05-01T17:27:35.841Z] [INFO] [TaskDependencies] [TaskDependencies] Successfully unlocked all tasks {"companyId":262,"count":2}
[Tasks] Successfully unlocked all tasks for company: 262
[Tasks] KYB tasks found: { count: 1 }
[Tasks] Query conditions: {
  conditions: {
    condition1: 'tasks.assigned_to = 304',
    condition2: 'tasks.created_by = 304',
    condition3: "tasks.company_id = 262 AND tasks.assigned_to IS NULL AND tasks.task_scope = 'company'",
    condition4: "tasks.task_type = 'user_onboarding' AND LOWER(tasks.user_email) = LOWER('e@e.com')"
  }
}
[Tasks] Tasks found: { count: 4 }
5:27:35 PM [info] GET /api/tasks 200 in 243ms :: [{"id":716,"title":"New User Invitation: e@e.com","description":"Complete use...
5:27:38 PM [info] GET /api/companies/current 304 in 40ms :: {"id":262,"name":"DemoTest","category":"FinTech","is_demo":true,"revenue_tier...
5:27:41 PM [info] GET /api/companies/current 304 in 32ms :: {"id":262,"name":"DemoTest","category":"FinTech","is_demo":true,"revenue_tier...
5:27:44 PM [info] GET /api/companies/current 304 in 31ms :: {"id":262,"name":"DemoTest","category":"FinTech","is_demo":true,"revenue_tier...
5:27:47 PM [info] GET /api/companies/current 304 in 32ms :: {"id":262,"name":"DemoTest","category":"FinTech","is_demo":true,"revenue_tier...
5:27:50 PM [info] GET /api/companies/current 304 in 37ms :: {"id":262,"name":"DemoTest","category":"FinTech","is_demo":true,"revenue_tier...
5:27:51 PM [info] GET /api/tasks 304 in 32ms :: [{"id":716,"title":"New User Invitation: e@e.com","description":"Complete use...
[2025-05-01T17:27:53.134Z] [INFO] [WebSocketService] WebSocket connection closed
[2025-05-01T17:27:53.134Z] [INFO] [WebSocketService] WebSocket connection closed
[2025-05-01T17:27:53.135Z] [INFO] [WebSocketService] WebSocket connection closed
[2025-05-01T17:27:53.804Z] [INFO] [WebSocketService] New WebSocket connection established {"path":"/ws","headers":{"host":"9606074c-a9ad-4fe1-8fe5-3d9c3eed0606-00-33ar2rv36ligj.picard.replit.dev","origin":"https://9606074c-a9ad-4fe1-8fe5-3d9c3eed0606-00-33ar2rv36ligj.picard.replit.dev"}}
[Auth] Unauthenticated user session
[2025-05-01T17:27:53.838Z] [INFO] [WebSocketService] New WebSocket connection established {"path":"/ws","headers":{"host":"9606074c-a9ad-4fe1-8fe5-3d9c3eed0606-00-33ar2rv36ligj.picard.replit.dev","origin":"https://9606074c-a9ad-4fe1-8fe5-3d9c3eed0606-00-33ar2rv36ligj.picard.replit.dev"}}
[2025-05-01T17:27:54.888Z] [INFO] [WebSocketService] WebSocket connection closed
[2025-05-01T17:27:54.888Z] [INFO] [WebSocketService] WebSocket connection closed
[Auth] Returning user session data
5:28:02 PM [info] GET /api/tasks 304 in 41ms :: [{"id":716,"title":"New User Invitation: e@e.com","description":"Complete use...
5:28:02 PM [info] GET /api/companies/current 304 in 54ms :: {"id":262,"name":"DemoTest","category":"FinTech","is_demo":true,"revenue_tier...
[2025-05-01T17:28:02.605Z] [INFO] [WebSocketService] New WebSocket connection established {"path":"/ws","headers":{"host":"9606074c-a9ad-4fe1-8fe5-3d9c3eed0606-00-33ar2rv36ligj.picard.replit.dev","origin":"https://9606074c-a9ad-4fe1-8fe5-3d9c3eed0606-00-33ar2rv36ligj.picard.replit.dev"}}
5:28:02 PM [info] GET /api/tasks 304 in 36ms :: [{"id":716,"title":"New User Invitation: e@e.com","description":"Complete use...
5:28:02 PM [info] GET /api/companies/current 304 in 32ms :: {"id":262,"name":"DemoTest","category":"FinTech","is_demo":true,"revenue_tier...
[2025-05-01T17:28:03.095Z] [INFO] [WebSocketService] New WebSocket connection established {"path":"/ws","headers":{"host":"9606074c-a9ad-4fe1-8fe5-3d9c3eed0606-00-33ar2rv36ligj.picard.replit.dev","origin":"https://9606074c-a9ad-4fe1-8fe5-3d9c3eed0606-00-33ar2rv36ligj.picard.replit.dev"}}
[2025-05-01T17:28:03.578Z] [INFO] [WebSocketService] New WebSocket connection established {"path":"/ws","headers":{"host":"9606074c-a9ad-4fe1-8fe5-3d9c3eed0606-00-33ar2rv36ligj.picard.replit.dev","origin":"https://9606074c-a9ad-4fe1-8fe5-3d9c3eed0606-00-33ar2rv36ligj.picard.replit.dev"}}
[Current Company] Fetching company for user: { userId: 304, companyId: 262 }
[Current Company] Found company: {
  id: 262,
  name: 'DemoTest',
  onboardingCompleted: false,
  riskScore: null,
  chosenScore: null,
  isDemo: true
}
5:28:05 PM [info] GET /api/companies/current 304 in 63ms :: {"id":262,"name":"DemoTest","category":"FinTech","is_demo":true,"revenue_tier...
5:28:08 PM [info] GET /api/companies/current 304 in 31ms :: {"id":262,"name":"DemoTest","category":"FinTech","is_demo":true,"revenue_tier...
5:28:11 PM [info] GET /api/companies/current 304 in 33ms :: {"id":262,"name":"DemoTest","category":"FinTech","is_demo":true,"revenue_tier...
5:28:14 PM [info] GET /api/companies/current 304 in 31ms :: {"id":262,"name":"DemoTest","category":"FinTech","is_demo":true,"revenue_tier...
[Tasks] ====== Starting task fetch =====
[Tasks] User details: { id: 304, company_id: 262, email: 'e@e.com' }
[2025-05-01T17:28:17.699Z] [INFO] [KYBRoutes] Performing dynamic task unlocking check for company {"companyId":262,"userId":304}
5:28:17 PM [info] GET /api/companies/current 304 in 31ms :: {"id":262,"name":"DemoTest","category":"FinTech","is_demo":true,"revenue_tier...
[2025-05-01T17:28:17.730Z] [INFO] [KYBRoutes] No completed KYB tasks found, skipping security task unlock check {"companyId":262}
[Tasks] Automatically unlocking all tasks for company { userId: 304, companyId: 262, requestedBy: 'automatic_task_unlock' }
[2025-05-01T17:28:17.731Z] [INFO] [TaskDependencies] [TaskDependencies] Unlocking ALL tasks for company {"companyId":262}
[2025-05-01T17:28:17.764Z] [INFO] [TaskDependencies] [TaskDependencies] Found tasks to unlock {"companyId":262,"count":2,"taskIds":[719,718],"taskTypes":["open_banking","ky3p"]}
[2025-05-01T17:28:17.803Z] [INFO] [TaskDependencies] [TaskDependencies] Unlocked task {"companyId":262,"taskId":719,"taskType":"open_banking"}
[2025-05-01T17:28:17.803Z] [DEBUG] [WebSocketService] Broadcasting task update with object format {"taskId":719,"status":"not_started"}
[2025-05-01T17:28:17.803Z] [INFO] [WebSocketService] Broadcasting task_update message to 3 clients
[2025-05-01T17:28:17.803Z] [INFO] [WebSocketService] Successfully broadcasted task_update message
[2025-05-01T17:28:17.837Z] [INFO] [TaskDependencies] [TaskDependencies] Unlocked task {"companyId":262,"taskId":718,"taskType":"ky3p"}
[2025-05-01T17:28:17.837Z] [DEBUG] [WebSocketService] Broadcasting task update with object format {"taskId":718,"status":"not_started"}
[2025-05-01T17:28:17.837Z] [INFO] [WebSocketService] Broadcasting task_update message to 3 clients
[2025-05-01T17:28:17.837Z] [INFO] [WebSocketService] Successfully broadcasted task_update message
[2025-05-01T17:28:17.837Z] [INFO] [TaskDependencies] [TaskDependencies] Successfully unlocked all tasks {"companyId":262,"count":2}
[Tasks] Successfully unlocked all tasks for company: 262
[Tasks] KYB tasks found: { count: 1 }
[Tasks] Query conditions: {
  conditions: {
    condition1: 'tasks.assigned_to = 304',
    condition2: 'tasks.created_by = 304',
    condition3: "tasks.company_id = 262 AND tasks.assigned_to IS NULL AND tasks.task_scope = 'company'",
    condition4: "tasks.task_type = 'user_onboarding' AND LOWER(tasks.user_email) = LOWER('e@e.com')"
  }
}
[Tasks] Tasks found: { count: 4 }
5:28:17 PM [info] GET /api/tasks 200 in 243ms :: [{"id":716,"title":"New User Invitation: e@e.com","description":"Complete use...
5:28:20 PM [info] GET /api/companies/current 304 in 50ms :: {"id":262,"name":"DemoTest","category":"FinTech","is_demo":true,"revenue_tier...
5:28:23 PM [info] GET /api/companies/current 304 in 32ms :: {"id":262,"name":"DemoTest","category":"FinTech","is_demo":true,"revenue_tier...
5:28:26 PM [info] GET /api/companies/current 304 in 31ms :: {"id":262,"name":"DemoTest","category":"FinTech","is_demo":true,"revenue_tier...
5:28:29 PM [info] GET /api/companies/current 304 in 33ms :: {"id":262,"name":"DemoTest","category":"FinTech","is_demo":true,"revenue_tier...
5:28:32 PM [info] GET /api/companies/current 304 in 32ms :: {"id":262,"name":"DemoTest","category":"FinTech","is_demo":true,"revenue_tier...
5:28:33 PM [info] GET /api/tasks 304 in 32ms :: [{"id":716,"title":"New User Invitation: e@e.com","description":"Complete use...
5:28:35 PM [info] GET /api/companies/current 304 in 34ms :: {"id":262,"name":"DemoTest","category":"FinTech","is_demo":true,"revenue_tier...
5:28:38 PM [info] GET /api/companies/current 304 in 32ms :: {"id":262,"name":"DemoTest","category":"FinTech","is_demo":true,"revenue_tier...
5:28:41 PM [info] GET /api/companies/current 304 in 32ms :: {"id":262,"name":"DemoTest","category":"FinTech","is_demo":true,"revenue_tier...
5:28:44 PM [info] GET /api/companies/current 304 in 36ms :: {"id":262,"name":"DemoTest","category":"FinTech","is_demo":true,"revenue_tier...
5:28:47 PM [info] GET /api/companies/current 304 in 31ms :: {"id":262,"name":"DemoTest","category":"FinTech","is_demo":true,"revenue_tier...
[Tasks] ====== Starting task fetch =====
[Tasks] User details: { id: 304, company_id: 262, email: 'e@e.com' }
[2025-05-01T17:28:48.294Z] [INFO] [KYBRoutes] Performing dynamic task unlocking check for company {"companyId":262,"userId":304}
[2025-05-01T17:28:48.327Z] [INFO] [KYBRoutes] No completed KYB tasks found, skipping security task unlock check {"companyId":262}
[Tasks] Automatically unlocking all tasks for company { userId: 304, companyId: 262, requestedBy: 'automatic_task_unlock' }
[2025-05-01T17:28:48.328Z] [INFO] [TaskDependencies] [TaskDependencies] Unlocking ALL tasks for company {"companyId":262}
[2025-05-01T17:28:48.364Z] [INFO] [TaskDependencies] [TaskDependencies] Found tasks to unlock {"companyId":262,"count":2,"taskIds":[719,718],"taskTypes":["open_banking","ky3p"]}
[2025-05-01T17:28:48.399Z] [INFO] [TaskDependencies] [TaskDependencies] Unlocked task {"companyId":262,"taskId":719,"taskType":"open_banking"}
[2025-05-01T17:28:48.399Z] [DEBUG] [WebSocketService] Broadcasting task update with object format {"taskId":719,"status":"not_started"}
[2025-05-01T17:28:48.399Z] [INFO] [WebSocketService] Broadcasting task_update message to 3 clients
[2025-05-01T17:28:48.399Z] [INFO] [WebSocketService] Successfully broadcasted task_update message
[2025-05-01T17:28:48.431Z] [INFO] [TaskDependencies] [TaskDependencies] Unlocked task {"companyId":262,"taskId":718,"taskType":"ky3p"}
[2025-05-01T17:28:48.431Z] [DEBUG] [WebSocketService] Broadcasting task update with object format {"taskId":718,"status":"not_started"}
[2025-05-01T17:28:48.431Z] [INFO] [WebSocketService] Broadcasting task_update message to 3 clients
[2025-05-01T17:28:48.431Z] [INFO] [WebSocketService] Successfully broadcasted task_update message
[2025-05-01T17:28:48.431Z] [INFO] [TaskDependencies] [TaskDependencies] Successfully unlocked all tasks {"companyId":262,"count":2}
[Tasks] Successfully unlocked all tasks for company: 262
[Tasks] KYB tasks found: { count: 1 }
[Tasks] Query conditions: {
  conditions: {
    condition1: 'tasks.assigned_to = 304',
    condition2: 'tasks.created_by = 304',
    condition3: "tasks.company_id = 262 AND tasks.assigned_to IS NULL AND tasks.task_scope = 'company'",
    condition4: "tasks.task_type = 'user_onboarding' AND LOWER(tasks.user_email) = LOWER('e@e.com')"
  }
}
[Tasks] Tasks found: { count: 4 }
5:28:48 PM [info] GET /api/tasks 200 in 233ms :: [{"id":716,"title":"New User Invitation: e@e.com","description":"Complete use...
5:28:50 PM [info] GET /api/companies/current 304 in 33ms :: {"id":262,"name":"DemoTest","category":"FinTech","is_demo":true,"revenue_tier...
5:28:53 PM [info] GET /api/companies/current 304 in 33ms :: {"id":262,"name":"DemoTest","category":"FinTech","is_demo":true,"revenue_tier...
5:28:56 PM [info] GET /api/companies/current 304 in 31ms :: {"id":262,"name":"DemoTest","category":"FinTech","is_demo":true,"revenue_tier...
5:28:59 PM [info] GET /api/companies/current 304 in 31ms :: {"id":262,"name":"DemoTest","category":"FinTech","is_demo":true,"revenue_tier...
5:29:02 PM [info] GET /api/companies/current 304 in 32ms :: {"id":262,"name":"DemoTest","category":"FinTech","is_demo":true,"revenue_tier...
5:29:03 PM [info] GET /api/tasks 304 in 36ms :: [{"id":716,"title":"New User Invitation: e@e.com","description":"Complete use...
5:29:05 PM [info] GET /api/companies/current 304 in 31ms :: {"id":262,"name":"DemoTest","category":"FinTech","is_demo":true,"revenue_tier...
[Current Company] Fetching company for user: { userId: 304, companyId: 262 }
[Current Company] Found company: {
  id: 262,
  name: 'DemoTest',
  onboardingCompleted: false,
  riskScore: null,
  chosenScore: null,
  isDemo: true
}
5:29:08 PM [info] GET /api/companies/current 304 in 68ms :: {"id":262,"name":"DemoTest","category":"FinTech","is_demo":true,"revenue_tier...
5:29:11 PM [info] GET /api/companies/current 304 in 33ms :: {"id":262,"name":"DemoTest","category":"FinTech","is_demo":true,"revenue_tier...
5:29:14 PM [info] GET /api/companies/current 304 in 33ms :: {"id":262,"name":"DemoTest","category":"FinTech","is_demo":true,"revenue_tier...
5:29:17 PM [info] GET /api/companies/current 304 in 34ms :: {"id":262,"name":"DemoTest","category":"FinTech","is_demo":true,"revenue_tier...
[Tasks] ====== Starting task fetch =====
[Tasks] User details: { id: 304, company_id: 262, email: 'e@e.com' }
[2025-05-01T17:29:18.902Z] [INFO] [KYBRoutes] Performing dynamic task unlocking check for company {"companyId":262,"userId":304}
[2025-05-01T17:29:18.936Z] [INFO] [KYBRoutes] No completed KYB tasks found, skipping security task unlock check {"companyId":262}
[Tasks] Automatically unlocking all tasks for company { userId: 304, companyId: 262, requestedBy: 'automatic_task_unlock' }
[2025-05-01T17:29:18.936Z] [INFO] [TaskDependencies] [TaskDependencies] Unlocking ALL tasks for company {"companyId":262}
[2025-05-01T17:29:18.973Z] [INFO] [TaskDependencies] [TaskDependencies] Found tasks to unlock {"companyId":262,"count":2,"taskIds":[719,718],"taskTypes":["open_banking","ky3p"]}
[2025-05-01T17:29:19.009Z] [INFO] [TaskDependencies] [TaskDependencies] Unlocked task {"companyId":262,"taskId":719,"taskType":"open_banking"}
[2025-05-01T17:29:19.010Z] [DEBUG] [WebSocketService] Broadcasting task update with object format {"taskId":719,"status":"not_started"}
[2025-05-01T17:29:19.010Z] [INFO] [WebSocketService] Broadcasting task_update message to 3 clients
[2025-05-01T17:29:19.010Z] [INFO] [WebSocketService] Successfully broadcasted task_update message
[2025-05-01T17:29:19.047Z] [INFO] [TaskDependencies] [TaskDependencies] Unlocked task {"companyId":262,"taskId":718,"taskType":"ky3p"}
[2025-05-01T17:29:19.047Z] [DEBUG] [WebSocketService] Broadcasting task update with object format {"taskId":718,"status":"not_started"}
[2025-05-01T17:29:19.047Z] [INFO] [WebSocketService] Broadcasting task_update message to 3 clients
[2025-05-01T17:29:19.047Z] [INFO] [WebSocketService] Successfully broadcasted task_update message
[2025-05-01T17:29:19.048Z] [INFO] [TaskDependencies] [TaskDependencies] Successfully unlocked all tasks {"companyId":262,"count":2}
[Tasks] Successfully unlocked all tasks for company: 262
[Tasks] KYB tasks found: { count: 1 }
[Tasks] Query conditions: {
  conditions: {
    condition1: 'tasks.assigned_to = 304',
    condition2: 'tasks.created_by = 304',
    condition3: "tasks.company_id = 262 AND tasks.assigned_to IS NULL AND tasks.task_scope = 'company'",
    condition4: "tasks.task_type = 'user_onboarding' AND LOWER(tasks.user_email) = LOWER('e@e.com')"
  }
}
[Tasks] Tasks found: { count: 4 }
5:29:19 PM [info] GET /api/tasks 200 in 245ms :: [{"id":716,"title":"New User Invitation: e@e.com","description":"Complete use...
5:29:20 PM [info] GET /api/companies/current 304 in 32ms :: {"id":262,"name":"DemoTest","category":"FinTech","is_demo":true,"revenue_tier...
5:29:23 PM [info] GET /api/companies/current 304 in 31ms :: {"id":262,"name":"DemoTest","category":"FinTech","is_demo":true,"revenue_tier...
5:29:26 PM [info] GET /api/companies/current 304 in 35ms :: {"id":262,"name":"DemoTest","category":"FinTech","is_demo":true,"revenue_tier...
5:29:28 PM [info] GET /api/tasks 304 in 38ms :: [{"id":716,"title":"New User Invitation: e@e.com","description":"Complete use...
Suppressing further connection logs. Pool size: 3
[Tasks Routes] Fetching task by ID: {
  taskId: 718,
  userCompanyId: 262,
  timestamp: '2025-05-01T17:29:28.284Z'
}
[Tasks Routes] Task found by ID: {
  taskId: 718,
  title: '2. S&P KY3P Security Assessment: DemoTest',
  type: 'ky3p',
  formDataFields: 0,
  timestamp: '2025-05-01T17:29:28.316Z'
}
5:29:28 PM [info] GET /api/companies/current 304 in 34ms :: {"id":262,"name":"DemoTest","category":"FinTech","is_demo":true,"revenue_tier...
5:29:28 PM [info] GET /api/tasks/718 200 in 63ms :: {"id":718,"title":"2. S&P KY3P Security Assessment: DemoTest","description":"...
[Auth] Returning user session data
[Task Templates API] Fetching template for task type: ky3p, user: 304
[Tasks Routes] Fetching task by ID: {
  taskId: 718,
  userCompanyId: 262,
  timestamp: '2025-05-01T17:29:28.516Z'
}
[Task Templates API] Found template: 48 (S&P KY3P Security Assessment) for task type: ky3p
[Tasks Routes] Task found by ID: {
  taskId: 718,
  title: '2. S&P KY3P Security Assessment: DemoTest',
  type: 'ky3p',
  formDataFields: 0,
  timestamp: '2025-05-01T17:29:28.557Z'
}
5:29:28 PM [info] GET /api/companies/current 304 in 48ms :: {"id":262,"name":"DemoTest","category":"FinTech","is_demo":true,"revenue_tier...
[Task Templates API] Retrieved 10 configuration items for template ID: 48
5:29:28 PM [info] GET /api/tasks/718 304 in 71ms :: {"id":718,"title":"2. S&P KY3P Security Assessment: DemoTest","description":"...
5:29:28 PM [info] GET /api/task-templates/by-type/ky3p 304 in 98ms :: {"id":48,"name":"S&P KY3P Security Assessment","description":"S&P KY3P Securi...
[2025-05-01T17:29:28.780Z] [INFO] [KY3PFieldsRoutes] Fetching all KY3P fields
[2025-05-01T17:29:28.870Z] [INFO] [KY3PFieldsRoutes] Successfully retrieved 120 KY3P fields
5:29:28 PM [info] GET /api/ky3p-fields 200 in 128ms :: [{"id":1,"order":1,"field_key":"externalSystems","display_name":"External Sys...
[Tasks Routes] Fetching task by ID: {
  taskId: 718,
  userCompanyId: 262,
  timestamp: '2025-05-01T17:29:29.469Z'
}
[Tasks Routes] Task found by ID: {
  taskId: 718,
  title: '2. S&P KY3P Security Assessment: DemoTest',
  type: 'ky3p',
  formDataFields: 0,
  timestamp: '2025-05-01T17:29:29.499Z'
}
5:29:29 PM [info] GET /api/tasks/718 304 in 63ms :: {"id":718,"title":"2. S&P KY3P Security Assessment: DemoTest","description":"...
[Tasks Routes] Fetching task by ID: {
  taskId: 718,
  userCompanyId: 262,
  timestamp: '2025-05-01T17:29:29.680Z'
}
[Tasks Routes] Task found by ID: {
  taskId: 718,
  title: '2. S&P KY3P Security Assessment: DemoTest',
  type: 'ky3p',
  formDataFields: 0,
  timestamp: '2025-05-01T17:29:29.711Z'
}
5:29:29 PM [info] GET /api/tasks/718/ky3p-responses 200 in 47ms
5:29:29 PM [info] GET /api/tasks/718 304 in 62ms :: {"id":718,"title":"2. S&P KY3P Security Assessment: DemoTest","description":"...
5:29:29 PM [info] GET /api/tasks/718/ky3p-responses 200 in 43ms
5:29:30 PM [info] GET /api/ky3p/progress/718 200 in 38ms
5:29:30 PM [info] GET /api/ky3p/progress/718 200 in 40ms
5:29:31 PM [info] GET /api/companies/current 304 in 31ms :: {"id":262,"name":"DemoTest","category":"FinTech","is_demo":true,"revenue_tier...
5:29:34 PM [info] GET /api/companies/current 304 in 31ms :: {"id":262,"name":"DemoTest","category":"FinTech","is_demo":true,"revenue_tier...
[Current Company] Using cached company data: 262
5:29:37 PM [info] GET /api/companies/current 304 in 31ms :: {"id":262,"name":"DemoTest","category":"FinTech","is_demo":true,"revenue_tier...
5:29:40 PM [info] GET /api/companies/current 304 in 31ms :: {"id":262,"name":"DemoTest","category":"FinTech","is_demo":true,"revenue_tier...
5:29:43 PM [info] GET /api/companies/current 304 in 34ms :: {"id":262,"name":"DemoTest","category":"FinTech","is_demo":true,"revenue_tier...
5:29:46 PM [info] GET /api/companies/current 304 in 35ms :: {"id":262,"name":"DemoTest","category":"FinTech","is_demo":true,"revenue_tier...
5:29:49 PM [info] GET /api/companies/current 304 in 33ms :: {"id":262,"na