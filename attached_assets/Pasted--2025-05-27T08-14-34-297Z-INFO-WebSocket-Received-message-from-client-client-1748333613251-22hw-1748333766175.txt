[2025-05-27T08:14:34.297Z] [INFO] [WebSocket] Received message from client client-1748333613251-22hwzj5 {"module":"WebSocket","type":"ping","timestamp":"2025-05-27T08:14:34.166Z","connectionId":"ws_1748333612203_rpbx5ize9"}
[2025-05-27T08:14:34.439Z] [INFO] [WebSocket] Received message from client client-1748333613823-1h4axp5 {"module":"WebSocket","type":"ping","timestamp":"2025-05-27T08:14:34.309Z","connectionId":"ws_1748333612247_dwsx8816d"}
[2025-05-27T08:14:54.968Z] [INFO] [WebSocket] Received message from client client-1748333613823-1h4axp5 {"module":"WebSocket","type":"ping","timestamp":"2025-05-27T08:14:54.838Z","connectionId":"ws_1748333612247_dwsx8816d"}
[2025-05-27T08:15:02.950Z] [INFO] [WebSocket] Received message from client client-1748333611713-snzycan {"module":"WebSocket","type":"ping"}
[2025-05-27T08:15:03.093Z] [INFO] [WebSocket] Received message from client client-1748333612737-glzt1k6 {"module":"WebSocket","type":"ping","timestamp":"2025-05-27T08:15:02.962Z","connectionId":"ws_1748333612750_tig7pfaii"}
[2025-05-27T08:15:03.461Z] [INFO] [WebSocket] Received message from client client-1748333613251-22hwzj5 {"module":"WebSocket","type":"ping","timestamp":"2025-05-27T08:15:03.330Z","connectionId":"ws_1748333612203_rpbx5ize9"}
[2025-05-27T08:15:09.671Z] [ERROR] [Database] Database client connection error {"module":"Database","message":"terminating connection due to administrator command","code":"57P01","timestamp":"2025-05-27T08:15:09.671Z"}
[2025-05-27T08:15:09.675Z] [ERROR] [Database] Database pool encountered an error {"module":"Database","message":"terminating connection due to administrator command","code":"57P01","stack":"error: terminating connection due to administrator command\n    at Parser.parseErrorMessage (/home/runner/workspace/node_modules/pg-protocol/src/parser.ts:369:69)\n    at Parser.handlePacket (/home/runner/workspace/node_modules/pg-protocol/src/parser.ts:187:21)\n    at Parser.parse (/home/runner/workspace/node_modules/pg-protocol/src/parser.ts:102:30)\n    at TLSSocket.<anonymous> (/home/runner/workspace/node_modules/pg-protocol/src/index.ts:7:48)\n    at TLSSocket.emit (node:events:518:28)\n    at addChunk (node:internal/streams/readable:561:12)\n    at readableAddChunkPushByteMode (node:internal/streams/readable:512:3)\n    at Readable.push (node:internal/streams/readable:392:5)\n    at TLSWrap.onStreamRead (node:internal/stream_base_commons:191:23)","timestamp":"2025-05-27T08:15:09.675Z"}
[2025-05-27T08:15:09.676Z] [ERROR] [NeonConnectionService] Pool error event: {"module":"NeonConnectionService","length":116,"name":"error","severity":"FATAL","code":"57P01","file":"postgres.c","line":"3318","routine":"ProcessInterrupts","client":{"_events":{},"_eventsCount":1,"connectionParameters":{"user":"neondb_owner","database":"neondb","port":5432,"host":"ep-wild-water-a4ulbqlb.us-east-1.aws.neon.tech","binary":false,"ssl":{},"client_encoding":"","isDomainSocket":false,"statement_timeout":false,"lock_timeout":false,"idle_in_transaction_session_timeout":false,"query_timeout":false,"connect_timeout":180},"user":"neondb_owner","database":"neondb","port":5432,"host":"ep-wild-water-a4ulbqlb.us-east-1.aws.neon.tech","_types":{"_types":{"arrayParser":{},"builtins":{"BOOL":16,"BYTEA":17,"CHAR":18,"INT8":20,"INT2":21,"INT4":23,"REGPROC":24,"TEXT":25,"OID":26,"TID":27,"XID":28,"CID":29,"JSON":114,"XML":142,"PG_NODE_TREE":194,"SMGR":210,"PATH":602,"POLYGON":604,"CIDR":650,"FLOAT4":700,"FLOAT8":701,"ABSTIME":702,"RELTIME":703,"TINTERVAL":704,"CIRCLE":718,"MACADDR8":774,"MONEY":790,"MACADDR":829,"INET":869,"ACLITEM":1033,"BPCHAR":1042,"VARCHAR":1043,"DATE":1082,"TIME":1083,"TIMESTAMP":1114,"TIMESTAMPTZ":1184,"INTERVAL":1186,"TIMETZ":1266,"BIT":1560,"VARBIT":1562,"NUMERIC":1700,"REFCURSOR":1790,"REGPROCEDURE":2202,"REGOPER":2203,"REGOPERATOR":2204,"REGCLASS":2205,"REGTYPE":2206,"UUID":2950,"TXID_SNAPSHOT":2970,"PG_LSN":3220,"PG_NDISTINCT":3361,"PG_DEPENDENCIES":3402,"TSVECTOR":3614,"TSQUERY":3615,"GTSVECTOR":3642,"REGCONFIG":3734,"REGDICTIONARY":3769,"JSONB":3802,"REGNAMESPACE":4089,"REGROLE":4096}},"text":{},"binary":{}},"_ending":true,"_ended":false,"_connecting":false,"_connected":true,"_connectionError":false,"_queryable":false,"enableChannelBinding":false,"connection":{"_events":{"end":[null,null]},"_eventsCount":23,"stream":{"_tlsOptions":{"pipe":false,"secureContext":{"context":{}},"isServer":false,"requestCert":true,"rejectUnauthorized":true},"_secureEstablished":true,"_securePending":false,"_newSessionPending":false,"_controlReleased":true,"secureConnecting":false,"_SNICallback":null,"servername":"ep-wild-water-a4ulbqlb.us-east-1.aws.neon.tech","alpnProtocol":false,"authorized":true,"authorizationError":null,"encrypted":true,"_events":{"end":[null,null],"newListener":[null,null]},"_eventsCount":6,"connecting":false,"_hadError":false,"_parent":{"connecting":false,"_hadError":false,"_parent":null,"_host":"ep-wild-water-a4ulbqlb.us-east-1.aws.neon.tech","_closeAfterHandlingError":false,"_events":{"close":[null,null,null],"error":[null,null]},"_readableState":{"highWaterMark":16384,"buffer":[],"bufferIndex":0,"length":0,"pipes":[],"awaitDrainWriters":null},"_writableState":{"highWaterMark":16384,"length":0,"corked":0,"writelen":0,"bufferedIndex":0,"pendingcb":0},"allowHalfOpen":false,"_eventsCount":4,"_sockname":null,"_pendingData":null,"_pendingEncoding":"","server":null,"_server":null,"autoSelectFamilyAttemptedAddresses":["52.20.107.131:5432"]},"_host":null,"_closeAfterHandlingError":false,"_readableState":{"highWaterMark":16384,"buffer":[],"bufferIndex":0,"length":0,"pipes":[],"awaitDrainWriters":null},"_writableState":{"highWaterMark":16384,"length":0,"corked":0,"writelen":0,"bufferedIndex":0,"pendingcb":0},"allowHalfOpen":false,"_sockname":null,"_pendingData":null,"_pendingEncoding":"","_server":null,"ssl":null,"_requestCert":true,"_rejectUnauthorized":true},"_keepAlive":false,"_keepAliveInitialDelayMillis":0,"lastBuffer":false,"parsedStatements":{},"ssl":{},"_ending":false,"_emitMessage":false,"_connecting":true},"queryQueue":[],"binary":false,"processID":-1635022880,"secretKey":1990743171,"ssl":{},"_connectionTimeoutMillis":180000,"_connectionCallback":null,"connectionTimeoutHandle":{"_idleTimeout":-1,"_idlePrev":null,"_idleNext":null,"_idleStart":12562,"_onTimeout":null,"_repeat":null,"_destroyed":true},"saslSession":null,"activeQuery":null,"readyForQuery":true,"hasExecuted":true,"_poolUseCount":2}}
[2025-05-27T08:15:09.677Z] [ERROR] [Database] Database client connection error {"module":"Database","message":"terminating connection due to administrator command","code":"57P01","timestamp":"2025-05-27T08:15:09.677Z"}
[2025-05-27T08:15:09.677Z] [ERROR] [Database] Database pool encountered an error {"module":"Database","message":"terminating connection due to administrator command","code":"57P01","stack":"error: terminating connection due to administrator command\n    at Parser.parseErrorMessage (/home/runner/workspace/node_modules/pg-protocol/src/parser.ts:369:69)\n    at Parser.handlePacket (/home/runner/workspace/node_modules/pg-protocol/src/parser.ts:187:21)\n    at Parser.parse (/home/runner/workspace/node_modules/pg-protocol/src/parser.ts:102:30)\n    at TLSSocket.<anonymous> (/home/runner/workspace/node_modules/pg-protocol/src/index.ts:7:48)\n    at TLSSocket.emit (node:events:518:28)\n    at addChunk (node:internal/streams/readable:561:12)\n    at readableAddChunkPushByteMode (node:internal/streams/readable:512:3)\n    at Readable.push (node:internal/streams/readable:392:5)\n    at TLSWrap.onStreamRead (node:internal/stream_base_commons:191:23)","timestamp":"2025-05-27T08:15:09.677Z"}
[2025-05-27T08:15:09.681Z] [ERROR] [Database] Database client connection error {"module":"Database","message":"terminating connection due to administrator command","code":"57P01","timestamp":"2025-05-27T08:15:09.681Z"}
[2025-05-27T08:15:09.681Z] [ERROR] [Database] Database pool encountered an error {"module":"Database","message":"terminating connection due to administrator command","code":"57P01","stack":"error: terminating connection due to administrator command\n    at Parser.parseErrorMessage (/home/runner/workspace/node_modules/pg-protocol/src/parser.ts:369:69)\n    at Parser.handlePacket (/home/runner/workspace/node_modules/pg-protocol/src/parser.ts:187:21)\n    at Parser.parse (/home/runner/workspace/node_modules/pg-protocol/src/parser.ts:102:30)\n    at TLSSocket.<anonymous> (/home/runner/workspace/node_modules/pg-protocol/src/index.ts:7:48)\n    at TLSSocket.emit (node:events:518:28)\n    at addChunk (node:internal/streams/readable:561:12)\n    at readableAddChunkPushByteMode (node:internal/streams/readable:512:3)\n    at Readable.push (node:internal/streams/readable:392:5)\n    at TLSWrap.onStreamRead (node:internal/stream_base_commons:191:23)","timestamp":"2025-05-27T08:15:09.681Z"}
[2025-05-27T08:15:13.984Z] [INFO] [WebSocket] Received message from client client-1748333613823-1h4axp5 {"module":"WebSocket","type":"ping","timestamp":"2025-05-27T08:15:13.834Z","connectionId":"ws_1748333612247_dwsx8816d"}
[2025-05-27T08:15:24.300Z] [INFO] [Database] Successfully established new database connection {"module":"Database"}
[DemoAPI] Company creation request received at: 2025-05-27T08:15:24.400Z
[DemoAPI] Request method: POST
[DemoAPI] Request headers: {
  'content-type': 'application/json',
  'content-length': '96',
  'user-agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) Ap...',
  origin: 'https://9606074c-a9ad-4fe1-8fe5-3d9c3eed0606-00-33ar2rv36ligj.picard.replit.dev:8080'
}
[DemoAPI] Full request body received: {
  "name": "MedSecure Systems",
  "type": "demo",
  "persona": "new-data-recipient",
  "companySize": "medium"
}
[DemoAPI] Creating demo session for tracking...
[DemoSessionService] Creating new demo session: {
  sessionId: 'demo_65b39b61-288d-4828-8265-87d24b80f12c',
  personaType: 'new-data-recipient',
  expiresAt: '2025-05-30T08:15:24.402Z',
  userAgent: 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.',
  ipAddress: '10.81.8.17'
}
[DemoSessionService] ‚úÖ Demo session created successfully: demo_65b39b61-288d-4828-8265-87d24b80f12c
[DemoAPI] ‚úÖ Demo session created: demo_65b39b61-288d-4828-8265-87d24b80f12c
[DemoAPI] Validating input parameters...
[DemoAPI] Input validation passed successfully
[DemoAPI] Extracted and validated fields: {
  name: 'MedSecure Systems',
  type: 'demo',
  persona: 'new-data-recipient',
  companySize: 'medium',
  riskProfile: undefined
}
[2025-05-27T08:15:24.451Z] [INFO] [App] Successfully retrieved unified WebSocket server for broadcast 
[WebSocket] Broadcast demo_action_start to 5 clients (0 errors) { messageId: 'msg_1748333724452_az6fpae8c' }
[2025-05-27T08:15:24.452Z] [INFO] [App] Successfully broadcasted demo_action_start message 
[DemoAPI] Generating company data for: { persona: 'new-data-recipient', companySize: 'medium' }
[DemoAPI] IMPLEMENTING DIRECT FIX for size: medium
[DemoAPI] Configuring persona: new-data-recipient
[DemoAPI] Configured non-accredited FinTech with basic access
[DemoAPI] Processing company size: medium
[DemoAPI] Generated medium company: $52M revenue, 907 employees
[DemoAPI] Generated company data: {
  category: 'FinTech',
  accreditation_status: 'PENDING',
  is_demo: true,
  available_tabs: [ 'task-center' ],
  revenue: '$22M',
  num_employees: 830,
  revenue_tier: 'medium'
}
[DemoAPI] ‚è≥ Skipping risk data for PENDING persona new-data-recipient - awaiting accreditation
[DemoAPI] Generating comprehensive business details...
[DemoAPI] Business Details - Persona: new-data-recipient, Mapped Type: fintech
[DemoAPI] Generated business details: {
  website: 'https://www.securepay.com',
  hasAddress: true,
  hasLeadership: true,
  hasClients: true,
  hasInvestors: true,
  hasCertifications: true
}
[DemoAPI] Assembled complete company data for insertion
[DemoAPI] Business details verification: {
  websiteIncluded: true,
  addressIncluded: true,
  productsIncluded: true,
  leadershipIncluded: true,
  clientsIncluded: true,
  investorsIncluded: true,
  certificationsIncluded: true,
  riskClustersIncluded: false
}
[DemoAPI] Final insert values: {
  "name": "MedSecure Systems",
  "description": "Professional fintech company specializing in secure data management and compliance",
  "category": "FinTech",
  "accreditation_status": "PENDING",
  "is_demo": true,
  "available_tabs": [
    "task-center"
  ],
  "revenue": "$22M",
  "num_employees": 830,
  "revenue_tier": "medium",
  "risk_score": null,
  "risk_clusters": null,
  "onboarding_company_completed": false,
  "demo_persona_type": "new-data-recipient",
  "demo_session_id": "demo_65b39b61-288d-4828-8265-87d24b80f12c",
  "demo_created_at": "2025-05-27T08:15:24.453Z",
  "demo_expires_at": "2025-05-30T08:15:24.453Z",
  "demo_cleanup_eligible": true,
  "website_url": "https://www.securepay.com",
  "hq_address": "1250 Broadway, Suite 2700, New York, NY 10001",
  "products_services": "API-driven financial services, secure data analytics, automated compliance workflows",
  "founders_and_leadership": "Amanda Foster (CEO, Former Morgan Stanley MD), James Liu (CTO, Ex-Amazon Senior Director), Maria Gonzalez (CFO, Former Wells Fargo VP)",
  "key_clients_partners": "Citigroup, Capital One, PayPal, Square, Stripe",
  "investors": "Matrix Partners, Redpoint Ventures, Foundation Capital, NEA",
  "certifications_compliance": "HIPAA Compliant, SOC 1 Type II, ISO 22301, COBIT 5, COSO Framework",
  "legal_structure": "Corporation",
  "market_position": "Established Player",
  "incorporation_year": 2006,
  "funding_stage": "Series C"
}
[DemoAPI] Company creation strategy: {
  persona: 'new-data-recipient',
  shouldCreateTasks: true,
  strategy: 'Use task-enabled service (like FinTech invites)'
}
[DemoAPI] Attempting company creation with name: "MedSecure Systems" (attempt 1)
[DemoAPI] üéØ Creating New Data Recipient company with standard tasks (KYB, KY3P, Open Banking)
[Company Service] Creating new company: MedSecure Systems {
  hasExistingTransaction: false,
  timestamp: '2025-05-27T08:15:24.500Z'
}
[Company Service] Creating new transaction for company creation
[Company Service] Creating new company record in database
[Company Service] Created company record: { id: 422, name: 'MedSecure Systems', duration: 99 }
[Company Service] Metadata received: {
  created_via: 'demo_new_data_recipient',
  created_by_id: 410,
  persona: 'new-data-recipient',
  demo_creation: true,
  task_assignment_enabled: true
}
[Company Service] Creator ID from metadata: 410
[Company Service] Creating tasks with creator ID: 410
[Company Service] Creating KYB task for company: 422
[Company Service] Created KYB task: { taskId: 1041, companyId: 422, duration: 146 }
[Company Service] Creating S&P KY3P Security Assessment task for company: 422
[Company Service] Created S&P KY3P Security Assessment task: { taskId: 1042, companyId: 422, duration: 190 }
[Company Service] Creating Open Banking Survey task for company: 422
[Company Service] Created Open Banking Survey task: { taskId: 1043, companyId: 422, duration: 223 }
[Company Service] Creating relationship with Invela for company: 422
[Company Service] Created relationship with Invela: { relationshipId: 442, newCompanyId: 422, duration: 261 }
[2025-05-27T08:15:24.760Z] [DEBUG] [App] Broadcasting task update with object format {"taskId":1041,"status":"not_started"}
[WebSocket] Broadcast task_update to 5 clients (0 errors) { messageId: 'msg_1748333724760_9viqjzf8g' }
[2025-05-27T08:15:24.761Z] [INFO] [App] Successfully broadcasted task_update message 
[2025-05-27T08:15:24.761Z] [DEBUG] [App] Broadcasting task update with object format {"taskId":1042,"status":"not_started"}
[WebSocket] Broadcast task_update to 5 clients (0 errors) { messageId: 'msg_1748333724761_4vsyhu4a2' }
[2025-05-27T08:15:24.762Z] [INFO] [App] Successfully broadcasted task_update message 
[2025-05-27T08:15:24.762Z] [DEBUG] [App] Broadcasting task update with object format {"taskId":1043,"status":"not_started"}
[WebSocket] Broadcast task_update to 5 clients (0 errors) { messageId: 'msg_1748333724762_360bc786a' }
[2025-05-27T08:15:24.762Z] [INFO] [App] Successfully broadcasted task_update message 
[Company Service] Checking if this is a demo company for file vault population
[2025-05-27T08:15:24.763Z] [INFO] [App] [Demo Hooks] Processing new company: MedSecure Systems (ID: 422) 
[2025-05-27T08:15:24.763Z] [INFO] [App] [Demo Hooks] Applying demo enhancements for company 422 (MedSecure Systems) 
[2025-05-27T08:15:24.763Z] [INFO] [App] [Demo Hooks] Populating file vault for company 422 (MedSecure Systems) 
[DemoAPI] ‚úÖ New Data Recipient company created with tasks: {
  companyId: 422,
  companyName: 'MedSecure Systems',
  kybTaskId: 1041,
  ky3pTaskId: 1042,
  openBankingTaskId: 1043,
  tasksCreated: true
}
[DemoAPI] ‚úÖ Company creation completed: "MedSecure Systems" with ID 422
[DemoAPI] üìä Company creation summary: {
  companyId: 422,
  companyName: 'MedSecure Systems',
  persona: 'new-data-recipient',
  tasksCreated: true,
  taskTypes: [ 'KYB', 'KY3P', 'Open Banking' ],
  accreditationStatus: 'PENDING',
  availableTabs: [ 'task-center' ],
  isDemo: true,
  creationMethod: 'createCompanyWithTasks service',
  timestamp: '2025-05-27T08:15:24.793Z'
}
[WebSocket] Broadcast demo_action_complete to 5 clients (0 errors) { messageId: 'msg_1748333724794_jfnv9kfkv' }
[2025-05-27T08:15:24.794Z] [INFO] [App] Successfully broadcasted demo_action_complete message 
[2025-05-27T08:15:24.841Z] [INFO] [App] POST /api/demo/company/create 200 in 442ms :: {"success":true,"companyId":422,"companyData":{"name":"MedSecure Systems","ty... 
[DemoAPI] Creating user: {
  fullName: 'Liam Morgan',
  email: 'lmorgan@medsecuresystems.com',
  role: 'New Data Recipient',
  companyId: 422
}
[DemoAPI] Parsed company ID: 422
[DemoAPI] [UserCreate] Setting onboarding status based on role: {
  userRole: 'New Data Recipient',
  onboardingUserCompleted: true,
  expectedBehavior: 'Skip onboarding modal',
  timestamp: '2025-05-27T08:15:25.840Z'
}
[DemoAPI] [UserCreate] User created successfully with persona-based onboarding status: {
  userId: 455,
  userEmail: 'lmorgan@medsecuresystems.com',
  companyId: 422,
  userRole: 'New Data Recipient',
  onboardingUserCompleted: true,
  expectedModalBehavior: '‚ùå Should NOT see onboarding modal',
  timestamp: '2025-05-27T08:15:25.885Z'
}
[2025-05-27T08:15:25.922Z] [INFO] [App] POST /api/demo/user/create 200 in 308ms :: {"success":true,"userId":455,"userData":{"fullName":"Liam Morgan","email":"lm... 
[DemoAPI] Setting up authentication: { userId: 455, email: 'lmorgan@medsecuresystems.com' }
[2025-05-27T08:15:26.711Z] [INFO] [App] POST /api/demo/auth/setup 200 in 32ms :: {"success":true,"credentials":{"loginUrl":"/login","email":"lmorgan@medsecure... 
[2025-05-27T08:15:26.964Z] [INFO] [Database] Successfully established new database connection {"module":"Database"}
[2025-05-27T08:15:27.014Z] [INFO] [App] [Demo File Vault] Reading file content from /home/runner/workspace/attached_assets/1_SOC_2_Questions.csv 
[2025-05-27T08:15:27.016Z] [ERROR] [App] [Demo File Vault] Error reading file ../../attached_assets/1_SOC_2_Questions.csv: {"error":"File not found: /home/runner/workspace/attached_assets/1_SOC_2_Questions.csv","stack":"Error: File not found: /home/runner/workspace/attached_assets/1_SOC_2_Questions.csv\n    at readFileContent (file:///home/runner/workspace/server/hooks/demo-company-hooks.js:98:13)\n    at addDemoFileToVault (file:///home/runner/workspace/server/hooks/demo-company-hooks.js:209:31)\n    at populateFileVault (file:///home/runner/workspace/server/hooks/demo-company-hooks.js:333:28)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async processNewCompany (file:///home/runner/workspace/server/hooks/demo-company-hooks.js:281:29)\n    at async Timeout._onTimeout (/home/runner/workspace/server/services/company.ts:322:30)","resolvedPath":"/home/runner/workspace/attached_assets/1_SOC_2_Questions.csv","currentDir":"/home/runner/workspace","exists":false}
[2025-05-27T08:15:27.016Z] [ERROR] [App] [Demo File Vault] Error adding demo file to vault: {"companyId":422,"filePath":"../../attached_assets/1_SOC_2_Questions.csv","error":"File not found: /home/runner/workspace/attached_assets/1_SOC_2_Questions.csv"}
[2025-05-27T08:15:27.016Z] [ERROR] [App] [Demo Hooks] Error populating file vault: {"companyId":422,"error":"File not found: /home/runner/workspace/attached_assets/1_SOC_2_Questions.csv","stack":"Error: File not found: /home/runner/workspace/attached_assets/1_SOC_2_Questions.csv\n    at readFileContent (file:///home/runner/workspace/server/hooks/demo-company-hooks.js:98:13)\n    at addDemoFileToVault (file:///home/runner/workspace/server/hooks/demo-company-hooks.js:209:31)\n    at populateFileVault (file:///home/runner/workspace/server/hooks/demo-company-hooks.js:333:28)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async processNewCompany (file:///home/runner/workspace/server/hooks/demo-company-hooks.js:281:29)\n    at async Timeout._onTimeout (/home/runner/workspace/server/services/company.ts:322:30)"}
[Company Service] Demo company processing result: { companyId: 422, success: true, fileCount: 0 }
[DemoAPI] [EmailInvite] Starting invitation process: {
  userEmail: 'lmorgan@medsecuresystems.com',
  userName: 'Liam Morgan',
  companyName: 'MedSecure Systems',
  hasLoginCredentials: true,
  timestamp: '2025-05-27T08:15:27.463Z'
}
[DemoAPI] [EmailInvite] Fetching user and company data...
[DemoAPI] [EmailInvite] User found: { userId: 455, companyId: 422, fullName: 'Liam Morgan', duration: 28 }
[DemoAPI] [EmailInvite] Company verified: {
  companyId: 422,
  companyName: 'MedSecure Systems',
  isDemo: true,
  accreditationStatus: 'PENDING',
  demoPersona: undefined,
  duration: 75
}
[DemoAPI] [EmailInvite] Company task assignment evaluation: {
  companyId: 422,
  companyName: 'MedSecure Systems',
  isDemo: true,
  accreditationStatus: 'PENDING',
  demoPersona: undefined,
  availableTabs: [ 'task-center' ],
  isNewDataRecipient: true,
  willCreateTasks: true
}
[DemoAPI] [EmailInvite] üéØ Creating company tasks for New Data Recipient directly
[DemoAPI] [EmailInvite] ‚úÖ Successfully created 3 company tasks for New Data Recipient: {
  companyId: 422,
  companyName: 'MedSecure Systems',
  kybTaskId: 1044,
  ky3pTaskId: 1045,
  openBankingTaskId: 1046,
  taskCreationMethod: 'direct_database_insert',
  taskChain: 'KYB (unlocked) ‚Üí KY3P (locked) ‚Üí Open Banking (locked)',
  duration: 194
}
[DemoAPI] [EmailInvite] Generated invitation code: { codeLength: 6, codeFormat: 'hex-uppercase', duration: 194 }
[DemoAPI] [EmailInvite] Creating invitation record...
[DemoAPI] [EmailInvite] Invitation record created: {
  invitationId: 439,
  code: 'B3B74C',
  expiresAt: 2025-06-03T08:15:27.658Z,
  duration: 235
}
[DemoAPI] [EmailInvite] Creating onboarding task...
[DemoAPI] [EmailInvite] Onboarding task created: {
  taskId: 1047,
  status: 'email_sent',
  assignedTo: 455,
  dueDate: 2025-06-10T08:15:27.699Z,
  duration: 266
}
[DemoAPI] [EmailInvite] Preparing email content using emailService...
[DemoAPI] [EmailInvite] Built invitation URL: https://9606074c-a9ad-4fe1-8fe5-3d9c3eed0606-00-33ar2rv36ligj.picard.replit.dev/login?code=B3B74C&email=lmorgan%40medsecuresystems.com
[EmailService] Starting to send template email
[EmailService] Template type: demo_invite
[EmailService] Recipient: lmorgan@medsecuresystems.com
[EmailService] Template data (raw): {
  "recipientName": "Liam Morgan",
  "recipientEmail": "lmorgan@medsecuresystems.com",
  "senderName": "Invela Demo System",
  "senderCompany": "Invela",
  "targetCompany": "MedSecure Systems",
  "inviteUrl": "https://9606074c-a9ad-4fe1-8fe5-3d9c3eed0606-00-33ar2rv36ligj.picard.replit.dev/login?code=B3B74C&email=lmorgan%40medsecuresystems.com",
  "code": "B3B74C"
}
[EmailService] Starting email validation for: lmorgan@medsecuresystems.com
[EmailService] Checking MX records for domain: medsecuresystems.com
[EmailService] MX record check failed: Error: queryMx ENOTFOUND medsecuresystems.com
    at QueryReqWrap.onresolve [as oncomplete] (node:internal/dns/callback_resolver:45:19) {
  errno: undefined,
  code: 'ENOTFOUND',
  syscall: 'queryMx',
  hostname: 'medsecuresystems.com'
}
[EmailService] Continuing despite MX check failure
[EmailService] Email validation successful for: lmorgan@medsecuresystems.com
[EmailService] Transforming template data
[EmailService] Starting template data transformation
[EmailService] Input template data: {
  "recipientName": "Liam Morgan",
  "recipientEmail": "lmorgan@medsecuresystems.com",
  "senderName": "Invela Demo System",
  "senderCompany": "Invela",
  "targetCompany": "MedSecure Systems",
  "inviteUrl": "https://9606074c-a9ad-4fe1-8fe5-3d9c3eed0606-00-33ar2rv36ligj.picard.replit.dev/login?code=B3B74C&email=lmorgan%40medsecuresystems.com",
  "code": "B3B74C"
}
[EmailService] Built invite URL: https://9606074c-a9ad-4fe1-8fe5-3d9c3eed0606-00-33ar2rv36ligj.picard.replit.dev/login?code=B3B74C&email=lmorgan%40medsecuresystems.com
[EmailService] Transformed template data: {
  "recipientName": "Liam Morgan",
  "recipientEmail": "lmorgan@medsecuresystems.com",
  "senderName": "Invela Demo System",
  "senderCompany": "Invela",
  "targetCompany": "MedSecure Systems",
  "inviteUrl": "https://9606074c-a9ad-4fe1-8fe5-3d9c3eed0606-00-33ar2rv36ligj.picard.replit.dev/login?code=B3B74C&email=lmorgan%40medsecuresystems.com",
  "code": "B3B74C"
}
[EmailService] Getting email template: demo_invite
[EmailTemplate] Getting template: demo_invite
[EmailTemplate] Template data: {
  "recipientName": "Liam Morgan",
  "recipientEmail": "lmorgan@medsecuresystems.com",
  "senderName": "Invela Demo System",
  "senderCompany": "Invela",
  "targetCompany": "MedSecure Systems",
  "inviteUrl": "https://9606074c-a9ad-4fe1-8fe5-3d9c3eed0606-00-33ar2rv36ligj.picard.replit.dev/login?code=B3B74C&email=lmorgan%40medsecuresystems.com",
  "code": "B3B74C"
}
[Template:invitation] Received template data: {
  "recipientName": "Liam Morgan",
  "recipientEmail": "lmorgan@medsecuresystems.com",
  "senderName": "Invela Demo System",
  "senderCompany": "Invela",
  "targetCompany": "MedSecure Systems",
  "inviteUrl": "https://9606074c-a9ad-4fe1-8fe5-3d9c3eed0606-00-33ar2rv36ligj.picard.replit.dev/login?code=B3B74C&email=lmorgan%40medsecuresystems.com",
  "code": "B3B74C",
  "inviteType": "demo"
}
[EmailService] Template generated successfully
[EmailService] Preparing to send email with configuration: {
  from: 'EvanCNavarro@gmail.com',
  to: 'lmorgan@medsecuresystems.com',
  subject: 'Invitation to join Invela',
  textLength: 710,
  htmlLength: 1792
}
[EmailService] Email sent successfully to: lmorgan@medsecuresystems.com
[DemoAPI] [EmailInvite] Demo invitation email sent successfully
[DemoAPI] [EmailInvite] Email process completed: {
  recipientEmail: 'lmorgan@medsecuresystems.com',
  invitationCode: 'B3B74C',
  messageId: 'demo_invite_1748333728677_439',
  emailSent: true,
  duration: 1214
}
[DemoAPI] [EmailInvite] Process completed successfully: {
  userId: 455,
  companyId: 422,
  invitationId: 439,
  taskId: 1047,
  invitationCode: 'B3B74C',
  totalDuration: 1214
}
[WebSocket] Broadcast demo_email_sent to 5 clients (0 errors) { messageId: 'msg_1748333728677_1c9u2u91s' }
[2025-05-27T08:15:28.678Z] [INFO] [App] Successfully broadcasted demo_email_sent message 
[2025-05-27T08:15:28.708Z] [INFO] [App] POST /api/demo/email/send-invitation 200 in 1246ms :: {"success":true,"emailSent":true,"messageId":"demo_invite_1748333728677_439",... 
[DemoAPI] [Finalize] Starting demo environment finalization: {
  userId: 455,
  companyId: 422,
  demoType: 'new-data-recipient',
  timestamp: '2025-05-27T08:15:29.462Z'
}
[DemoAPI] [Finalize] Verifying user and company data...
[DemoAPI] [Finalize] Company validation check: {
  userId: 455,
  userCompanyId: 422,
  requestedCompanyId: 422,
  expectedCompanyId: 422,
  demoType: 'new-data-recipient',
  isInvelaAdmin: false
}
[DemoAPI] [Finalize] User verification successful: {
  userId: 455,
  email: 'lmorgan@medsecuresystems.com',
  companyId: 422,
  fullName: 'Liam Morgan',
  duration: 29
}
[DemoAPI] [Finalize] Setting up demo environment...
[DemoAPI] [Finalize] Environment configuration prepared: {
  environmentId: 'env_demo_1748333729492_455',
  config: {
    type: 'new-data-recipient',
    features: {
      demoDataAccess: true,
      tutorialMode: true,
      limitedFunctionality: false
    },
    permissions: {
      canInviteUsers: true,
      canModifySettings: true,
      canAccessAllTabs: true
    }
  },
  duration: 30
}
[DemoAPI] [Finalize] Initiating automatic user authentication...
[DemoAPI] [Finalize] Demo finalization completed successfully: {
  userId: 455,
  email: 'lmorgan@medsecuresystems.com',
  companyId: 422,
  environmentId: 'env_demo_1748333729492_455',
  authenticated: true,
  totalDuration: 97,
  timestamp: '2025-05-27T08:15:29.559Z'
}
[WebSocket] Broadcast demo_completed to 5 clients (0 errors) { messageId: 'msg_1748333729560_37zu9qtli' }
[2025-05-27T08:15:29.560Z] [INFO] [App] Successfully broadcasted demo_completed message 
[2025-05-27T08:15:29.590Z] [INFO] [App] POST /api/demo/environment/finalize 200 in 128ms :: {"success":true,"demoReady":true,"authenticated":true,"loginRequired":false,"... 
[2025-05-27T08:15:31.831Z] [INFO] [WebSocket] Received message from client client-1748333611713-snzycan {"module":"WebSocket","type":"ping"}
[2025-05-27T08:15:32.902Z] [INFO] [WebSocket] Received message from client client-1748333612737-glzt1k6 {"module":"WebSocket","type":"ping","timestamp":"2025-05-27T08:15:32.770Z","connectionId":"ws_1748333612750_tig7pfaii"}
[Current Company] Fetching company for user: { userId: 455, companyId: 422 }
[Tasks] ====== Starting task fetch =====
[Tasks] User details: { id: 455, company_id: 422, email: 'lmorgan@medsecuresystems.com' }
[2025-05-27T08:15:32.965Z] [INFO] [App] Performing dynamic task unlocking check for company {"companyId":422,"userId":455}
[Current Company] Found company: {
  id: 422,
  name: 'MedSecure Systems',
  onboardingCompleted: false,
  riskScore: null,
  chosenScore: null,
  isDemo: true
}
[Current Company] Onboarding status check: {
  userId: 455,
  companyId: 422,
  userOnboardingStatus: true,
  companyOnboardingStatus: false,
  timestamp: '2025-05-27T08:15:32.977Z'
}
[2025-05-27T08:15:33.006Z] [INFO] [App] GET /api/companies/current 200 in 58ms :: {"id":422,"name":"MedSecure Systems","category":"FinTech","is_demo":true,"rev... 
[2025-05-27T08:15:33.027Z] [INFO] [App] No completed KYB tasks found, skipping security task unlock check {"companyId":422}
[Tasks] Automatically unlocking all tasks for company { userId: 455, companyId: 422, requestedBy: 'automatic_task_unlock' }
[2025-05-27T08:15:33.028Z] [INFO] [App] [TaskDependencies] Unlocking ALL tasks for company {"companyId":422}
[2025-05-27T08:15:33.064Z] [INFO] [App] [TaskDependencies] Found user onboarding task that needs completion {"taskId":1047,"userEmail":"lmorgan@medsecuresystems.com","currentStatus":"email_sent","currentProgress":25}
[2025-05-27T08:15:33.065Z] [INFO] [App] [TaskDependencies] Found tasks to unlock {"companyId":422,"count":7,"taskIds":[1041,1042,1043,1044,1045,1046,1047],"taskTypes":["company_kyb","ky3p","open_banking","company_kyb","ky3p","open_banking","user_onboarding"],"ky3pTaskCount":2,"ky3pTaskIds":[1042,1045]}
[UnifiedProgress] Starting progress update for task 1041 (company_kyb) {
  taskId: 1041,
  taskType: 'company_kyb',
  diagnosticId: 'prog-1748333733066-143',
  metadata: [
    'locked',
    'prerequisite_completed',
    'prerequisite_completed_at',
    'dependencyUnlockOperation',
    'previousProgress',
    'previousStatus',
    'isKy3pTask',
    'isUserOnboardingTask'
  ]
}
[UnifiedProgressCalc] Calculating progress for task 1041 (company_kyb)
[UnifiedProgressCalc] Task 1041 (company_kyb) progress: 0/30 = 0%
[2025-05-27T08:15:33.263Z] [INFO] [WebSocket] Broadcast message of type 'task_updated' sent to 5 clients {"module":"WebSocket","messageType":"task_updated","recipients":5,"totalClients":5,"filtered":false}
[2025-05-27T08:15:33.263Z] [INFO] [WebSocket] Broadcast message of type 'task_update' sent to 5 clients {"module":"WebSocket","messageType":"task_update","recipients":5,"totalClients":5,"filtered":false}
[2025-05-27T08:15:33.263Z] [DEBUG] [App] [UnifiedProgressCalc] Successfully broadcast task update using unified implementation {"taskId":1041,"messageId":"msg_1748333733262_cwnsmz5m"}
[2025-05-27T08:15:33.263Z] [INFO] [App] [UnifiedProgressCalc] Successfully broadcast task update for task 1041 {"progress":0,"status":"not_started","messageId":"msg_1748333733262_cwnsmz5m"}
[2025-05-27T08:15:33.263Z] [INFO] [App] [TaskDependencies] Unlocked task using unified progress calculator {"companyId":422,"taskId":1041,"taskType":"company_kyb","isKy3pTask":false,"calculatedProgress":0,"previousProgress":0,"wasPreserved":false}
[2025-05-27T08:15:33.263Z] [INFO] [App] [TaskDependencies] Processing KY3P task {"taskId":1042,"taskType":"ky3p","currentProgress":0,"currentStatus":"not_started","timestamp":"2025-05-27T08:15:33.263Z"}
[UnifiedProgress] Starting progress update for task 1042 (ky3p) {
  taskId: 1042,
  taskType: 'ky3p',
  diagnosticId: 'prog-1748333733264-463',
  metadata: [
    'locked',
    'prerequisite_completed',
    'prerequisite_completed_at',
    'dependencyUnlockOperation',
    'previousProgress',
    'previousStatus',
    'isKy3pTask',
    'isUserOnboardingTask'
  ]
}
[2025-05-27T08:15:33.283Z] [INFO] [WebSocket] Client connected {"module":"WebSocket","clientId":"client-1748333733283-e116hcy","clients":6}
[UnifiedProgressCalc] Calculating progress for task 1042 (ky3p)
[2025-05-27T08:15:33.324Z] [INFO] [Database] Successfully established new database connection {"module":"Database"}
[2025-05-27T08:15:33.383Z] [INFO] [App] [TabTutorials] Status request for tab "dashboard" from authenticated user ID: 455 
[2025-05-27T08:15:33.384Z] [INFO] [App] [TabTutorials] Normalizing tab name from 'dashboard' to canonical form 
[2025-05-27T08:15:33.384Z] [INFO] [App] [TabTutorials] Tab name already in canonical form: 'dashboard' 
[2025-05-27T08:15:33.384Z] [INFO] [App] [TabTutorials] Checking tutorial status for tab: dashboard (raw: dashboard), user: 455 
[2025-05-27T08:15:33.400Z] [INFO] [WebSocket] Received message from client client-1748333613251-22hwzj5 {"module":"WebSocket","type":"ping","timestamp":"2025-05-27T08:15:33.271Z","connectionId":"ws_1748333612203_rpbx5ize9"}
[2025-05-27T08:15:33.402Z] [INFO] [WebSocket] Received message from client client-1748333733283-e116hcy {"module":"WebSocket","type":"authenticate","userId":null,"companyId":null,"clientId":"ws_1748333610962_6tp1vlrde","timestamp":"2025-05-27T08:15:33.271Z"}
[2025-05-27T08:15:33.402Z] [INFO] [WebSocket] Authentication from client client-1748333733283-e116hcy {"module":"WebSocket","userId":null,"companyId":null,"hasToken":true}
[KY3P Progress] Calculated progress for task 1042: {
  taskId: 1042,
  taskType: 'ky3p',
  normalizedTaskType: 'ky3p',
  totalFields: 120,
  completedFields: 0,
  progress: 0,
  timeStamp: '2025-05-27T08:15:33.410Z'
}
[UnifiedProgressCalc] Task 1042 (ky3p) progress: 0/120 = 0%
[2025-05-27T08:15:33.422Z] [INFO] [App] [TabTutorials] No tutorial status found for dashboard for user 455 
[2025-05-27T08:15:33.440Z] [INFO] [WebSocket] Broadcast message of type 'task_updated' sent to 6 clients {"module":"WebSocket","messageType":"task_updated","recipients":6,"totalClients":6,"filtered":false}
[2025-05-27T08:15:33.441Z] [INFO] [WebSocket] Broadcast message of type 'task_update' sent to 6 clients {"module":"WebSocket","messageType":"task_update","recipients":6,"totalClients":6,"filtered":false}
[2025-05-27T08:15:33.441Z] [DEBUG] [App] [UnifiedProgressCalc] Successfully broadcast task update using unified implementation {"taskId":1042,"messageId":"msg_1748333733440_3r6q7vp1"}
[2025-05-27T08:15:33.441Z] [INFO] [App] [UnifiedProgressCalc] Successfully broadcast task update for task 1042 {"progress":0,"status":"not_started","messageId":"msg_1748333733440_3r6q7vp1"}
[2025-05-27T08:15:33.441Z] [INFO] [App] [TaskDependencies] Unlocked task using unified progress calculator {"companyId":422,"taskId":1042,"taskType":"ky3p","isKy3pTask":true,"calculatedProgress":0,"previousProgress":0,"wasPreserved":false}
[UnifiedProgress] Starting progress update for task 1043 (open_banking) {
  taskId: 1043,
  taskType: 'open_banking',
  diagnosticId: 'prog-1748333733442-257',
  metadata: [
    'locked',
    'prerequisite_completed',
    'prerequisite_completed_at',
    'dependencyUnlockOperation',
    'previousProgress',
    'previousStatus',
    'isKy3pTask',
    'isUserOnboardingTask'
  ]
}
[2025-05-27T08:15:33.452Z] [INFO] [App] GET /api/user-tab-tutorials/dashboard/status 304 in 70ms :: {"exists":false,"completed":false,"currentStep":0,"tabName":"dashboard"} 
[UnifiedProgressCalc] Calculating progress for task 1043 (open_banking)
[UnifiedProgressCalc] Task 1043 (open_banking) progress: 0/44 = 0%
[2025-05-27T08:15:33.621Z] [INFO] [WebSocket] Broadcast message of type 'task_updated' sent to 6 clients {"module":"WebSocket","messageType":"task_updated","recipients":6,"totalClients":6,"filtered":false}
[2025-05-27T08:15:33.622Z] [INFO] [WebSocket] Broadcast message of type 'task_update' sent to 6 clients {"module":"WebSocket","messageType":"task_update","recipients":6,"totalClients":6,"filtered":false}
[2025-05-27T08:15:33.622Z] [DEBUG] [App] [UnifiedProgressCalc] Successfully broadcast task update using unified implementation {"taskId":1043,"messageId":"msg_1748333733620_e0j1q8s7"}
[2025-05-27T08:15:33.622Z] [INFO] [App] [UnifiedProgressCalc] Successfully broadcast task update for task 1043 {"progress":0,"status":"not_started","messageId":"msg_1748333733620_e0j1q8s7"}
[2025-05-27T08:15:33.622Z] [INFO] [App] [TaskDependencies] Unlocked task using unified progress calculator {"companyId":422,"taskId":1043,"taskType":"open_banking","isKy3pTask":false,"calculatedProgress":0,"previousProgress":0,"wasPreserved":false}
[UnifiedProgress] Starting progress update for task 1044 (company_kyb) {
  taskId: 1044,
  taskType: 'company_kyb',
  diagnosticId: 'prog-1748333733623-408',
  metadata: [
    'locked',
    'prerequisite_completed',
    'prerequisite_completed_at',
    'dependencyUnlockOperation',
    'previousProgress',
    'previousStatus',
    'isKy3pTask',
    'isUserOnboardingTask'
  ]
}
[UnifiedProgressCalc] Calculating progress for task 1044 (company_kyb)
[UnifiedProgressCalc] Task 1044 (company_kyb) progress: 0/30 = 0%
[2025-05-27T08:15:33.771Z] [INFO] [WebSocket] Broadcast message of type 'task_updated' sent to 6 clients {"module":"WebSocket","messageType":"task_updated","recipients":6,"totalClients":6,"filtered":false}
[2025-05-27T08:15:33.771Z] [INFO] [WebSocket] Broadcast message of type 'task_update' sent to 6 clients {"module":"WebSocket","messageType":"task_update","recipients":6,"totalClients":6,"filtered":false}
[2025-05-27T08:15:33.771Z] [DEBUG] [App] [UnifiedProgressCalc] Successfully broadcast task update using unified implementation {"taskId":1044,"messageId":"msg_1748333733770_p4zczem6"}
[2025-05-27T08:15:33.771Z] [INFO] [App] [UnifiedProgressCalc] Successfully broadcast task update for task 1044 {"progress":0,"status":"not_started","messageId":"msg_1748333733770_p4zczem6"}
[2025-05-27T08:15:33.771Z] [INFO] [App] [TaskDependencies] Unlocked task using unified progress calculator {"companyId":422,"taskId":1044,"taskType":"company_kyb","isKy3pTask":false,"calculatedProgress":0,"previousProgress":0,"wasPreserved":false}
[2025-05-27T08:15:33.771Z] [INFO] [App] [TaskDependencies] Processing KY3P task {"taskId":1045,"taskType":"ky3p","currentProgress":0,"currentStatus":"not_started","timestamp":"2025-05-27T08:15:33.771Z"}
[UnifiedProgress] Starting progress update for task 1045 (ky3p) {
  taskId: 1045,
  taskType: 'ky3p',
  diagnosticId: 'prog-1748333733772-551',
  metadata: [
    'locked',
    'prerequisite_completed',
    'prerequisite_completed_at',
    'dependencyUnlockOperation',
    'previousProgress',
    'previousStatus',
    'isKy3pTask',
    'isUserOnboardingTask'
  ]
}
[UnifiedProgressCalc] Calculating progress for task 1045 (ky3p)
[KY3P Progress] Calculated progress for task 1045: {
  taskId: 1045,
  taskType: 'ky3p',
  normalizedTaskType: 'ky3p',
  totalFields: 120,
  completedFields: 0,
  progress: 0,
  timeStamp: '2025-05-27T08:15:33.895Z'
}
[UnifiedProgressCalc] Task 1045 (ky3p) progress: 0/120 = 0%
[2025-05-27T08:15:33.924Z] [INFO] [WebSocket] Broadcast message of type 'task_updated' sent to 6 clients {"module":"WebSocket","messageType":"task_updated","recipients":6,"totalClients":6,"filtered":false}
[2025-05-27T08:15:33.925Z] [INFO] [WebSocket] Broadcast message of type 'task_update' sent to 6 clients {"module":"WebSocket","messageType":"task_update","recipients":6,"totalClients":6,"filtered":false}
[2025-05-27T08:15:33.925Z] [DEBUG] [App] [UnifiedProgressCalc] Successfully broadcast task update using unified implementation {"taskId":1045,"messageId":"msg_1748333733924_rgurmty0"}
[2025-05-27T08:15:33.925Z] [INFO] [App] [UnifiedProgressCalc] Successfully broadcast task update for task 1045 {"progress":0,"status":"not_started","messageId":"msg_1748333733924_rgurmty0"}
[2025-05-27T08:15:33.925Z] [INFO] [App] [TaskDependencies] Unlocked task using unified progress calculator {"companyId":422,"taskId":1045,"taskType":"ky3p","isKy3pTask":true,"calculatedProgress":0,"previousProgress":0,"wasPreserved":false}
[UnifiedProgress] Starting progress update for task 1046 (open_banking) {
  taskId: 1046,
  taskType: 'open_banking',
  diagnosticId: 'prog-1748333733925-796',
  metadata: [
    'locked',
    'prerequisite_completed',
    'prerequisite_completed_at',
    'dependencyUnlockOperation',
    'previousProgress',
    'previousStatus',
    'isKy3pTask',
    'isUserOnboardingTask'
  ]
}
[2025-05-27T08:15:33.964Z] [INFO] [WebSocket] Received message from client client-1748333613823-1h4axp5 {"module":"WebSocket","type":"ping","timestamp":"2025-05-27T08:15:33.834Z","connectionId":"ws_1748333612247_dwsx8816d"}
[UnifiedProgressCalc] Calculating progress for task 1046 (open_banking)
[UnifiedProgressCalc] Task 1046 (open_banking) progress: 0/44 = 0%
[2025-05-27T08:15:34.078Z] [INFO] [WebSocket] Broadcast message of type 'task_updated' sent to 6 clients {"module":"WebSocket","messageType":"task_updated","recipients":6,"totalClients":6,"filtered":false}
[2025-05-27T08:15:34.078Z] [INFO] [WebSocket] Broadcast message of type 'task_update' sent to 6 clients {"module":"WebSocket","messageType":"task_update","recipients":6,"totalClients":6,"filtered":false}
[2025-05-27T08:15:34.078Z] [DEBUG] [App] [UnifiedProgressCalc] Successfully broadcast task update using unified implementation {"taskId":1046,"messageId":"msg_1748333734077_qe7nhqcy"}
[2025-05-27T08:15:34.078Z] [INFO] [App] [UnifiedProgressCalc] Successfully broadcast task update for task 1046 {"progress":0,"status":"not_started","messageId":"msg_1748333734077_qe7nhqcy"}
[2025-05-27T08:15:34.078Z] [INFO] [App] [TaskDependencies] Unlocked task using unified progress calculator {"companyId":422,"taskId":1046,"taskType":"open_banking","isKy3pTask":false,"calculatedProgress":0,"previousProgress":0,"wasPreserved":false}
[2025-05-27T08:15:34.078Z] [INFO] [App] [TaskDependencies] Setting User Onboarding task as completed {"taskId":1047,"userEmail":"lmorgan@medsecuresystems.com","timestamp":"2025-05-27T08:15:34.078Z"}
[2025-05-27T08:15:34.118Z] [DEBUG] [App] Broadcasting task update with object format {"taskId":1047,"status":"completed"}
[WebSocket] Broadcast task_update to 6 clients (0 errors) { messageId: 'msg_1748333734118_c04g2qopz' }
[2025-05-27T08:15:34.118Z] [INFO] [App] Successfully broadcasted task_update message 
[2025-05-27T08:15:34.118Z] [INFO] [App] [TaskDependencies] Successfully unlocked all tasks {"companyId":422,"count":7}
[Tasks] Successfully unlocked all tasks for company: 422
[Tasks] KYB tasks found: { count: 2 }
[Tasks] Query conditions: {
  conditions: {
    condition1: 'tasks.assigned_to = 455',
    condition2: 'tasks.created_by = 455',
    condition3: "tasks.company_id = 422 AND tasks.assigned_to IS NULL AND tasks.task_scope = 'company'",
    condition4: "tasks.task_type = 'user_onboarding' AND LOWER(tasks.user_email) = LOWER('lmorgan@medsecuresystems.com')"
  }
}
[Tasks] Tasks found: { count: 7 }
[2025-05-27T08:15:34.221Z] [INFO] [App] GET /api/tasks 200 in 1257ms :: [{"id":1047,"title":"Demo Invitation: lmorgan@medsecuresystems.com","descript... 
[2025-05-27T08:15:49.443Z] [INFO] [App] GET /api/tasks 304 in 33ms :: [{"id":1047,"title":"Demo Invitation: lmorgan@medsecuresystems.com","descript... 
[2025-05-27T08:15:53.972Z] [INFO] [WebSocket] Received message from client client-1748333613823-1h4axp5 {"module":"WebSocket","type":"ping","timestamp":"2025-05-27T08:15:53.835Z","connectionId":"ws_1748333612247_dwsx8816d"}