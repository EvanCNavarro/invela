> rest-express@1.0.0 dev
> tsx server/index.ts

Database migrations disabled - schema already applied
[EmailService] Initializing email service
[EmailService] Email service initialized successfully
[Auth] Setting up authentication...
[Auth] Authentication setup completed
[Routes] Routes setup completed
[WebSocket] Server initialized on path: /ws
1:11:18 PM [info] Setting up Vite development server
1:11:18 PM [express] Server running on port 5000
[2025-04-16T13:11:20.202Z] New client connected to the pool (1/3)
[Auth] Deserializing user: 210
[Auth] Deserializing user: 210
[Auth] Deserializing user: 210
[2025-04-16T13:11:23.173Z] New client connected to the pool (2/3)
[Auth] Deserializing user: 210
[2025-04-16T13:11:23.438Z] New client connected to the pool (3/3)
[Auth] Using cached user data: 210
[Auth] Unauthenticated user session
[Auth] Using cached user data: 210
[Auth] Using cached user data: 210
[Auth] Using cached user data: 210
[Auth] Using cached user data: 210
[Auth] Using cached user data: 210
[Auth] Using cached user data: 210
[Auth] Using cached user data: 210
[Auth] Using cached user data: 210
[Auth] Using cached user data: 210
[Auth] Using cached user data: 210
[Auth] Returning user session data
[Tasks] ====== Starting task fetch =====
[Tasks] User details: { id: 210, company_id: 169, email: 'e.vancnavarr.o@gmail.com' }
[Current Company] Fetching company for user: { userId: 210, companyId: 169 }
[Current Company] Found company: {
  id: 169,
  name: 'DevelopmentTesting',
  onboardingCompleted: false,
  riskScore: null
}
[Tasks] KYB tasks found: { count: 1 }
[Tasks] Query conditions: {
  conditions: {
    condition1: 'tasks.assigned_to = 210',
    condition2: 'tasks.created_by = 210',
    condition3: "tasks.company_id = 169 AND tasks.assigned_to IS NULL AND tasks.task_scope = 'company'",
    condition4: "tasks.task_type = 'user_onboarding' AND LOWER(tasks.user_email) = LOWER('e.vancnavarr.o@gmail.com')"
  }
}
1:11:34 PM [info] GET /api/companies/current 304 in 87ms :: {"id":169,"name":"DevelopmentTesting","description":"FinTech partner company ...
[Tasks] Tasks found: { count: 4 }
1:11:34 PM [info] GET /api/tasks 304 in 140ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
New WebSocket client connected
1:11:34 PM [info] GET /api/tasks 304 in 44ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
New WebSocket client connected
1:11:39 PM [info] GET /api/tasks 304 in 45ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
1:11:44 PM [info] GET /api/tasks 304 in 44ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
1:11:50 PM [info] GET /api/tasks 304 in 44ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
1:11:55 PM [info] GET /api/tasks 304 in 44ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
1:12:00 PM [info] GET /api/tasks 304 in 44ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
1:12:05 PM [vite] hmr update /src/index.css?v=Cwxr-RvBS1lAP7sq5WIoE, /src/App.tsx?v=Cwxr-RvBS1lAP7sq5WIoE, /src/pages/diagnostic-page.tsx, /src/components/diagnostic/DiagnosticFormView.tsx
[Tasks] ====== Starting task fetch =====
[Tasks] User details: { id: 210, company_id: 169, email: 'e.vancnavarr.o@gmail.com' }
[Tasks] KYB tasks found: { count: 1 }
[Tasks] Query conditions: {
  conditions: {
    condition1: 'tasks.assigned_to = 210',
    condition2: 'tasks.created_by = 210',
    condition3: "tasks.company_id = 169 AND tasks.assigned_to IS NULL AND tasks.task_scope = 'company'",
    condition4: "tasks.task_type = 'user_onboarding' AND LOWER(tasks.user_email) = LOWER('e.vancnavarr.o@gmail.com')"
  }
}
[Tasks] Tasks found: { count: 4 }
1:12:05 PM [info] GET /api/tasks 304 in 131ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
1:12:06 PM [info] GET /api/tasks 304 in 58ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
1:12:11 PM [info] GET /api/tasks 304 in 57ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
1:12:17 PM [info] GET /api/tasks 304 in 57ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[WebSocket] Received pong
[WebSocket] Received pong
[WebSocket] Received message: {
  type: 'pong',
  payload: { timestamp: '2025-04-16T13:12:20.158Z' },
  connectionId: 'ws-1'
}
1:12:22 PM [info] GET /api/tasks 304 in 57ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
1:12:27 PM [info] GET /api/tasks 304 in 58ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
1:12:32 PM [info] GET /api/tasks 304 in 58ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[Tasks] ====== Starting task fetch =====
[Tasks] User details: { id: 210, company_id: 169, email: 'e.vancnavarr.o@gmail.com' }
[Tasks] KYB tasks found: { count: 1 }
[Tasks] Query conditions: {
  conditions: {
    condition1: 'tasks.assigned_to = 210',
    condition2: 'tasks.created_by = 210',
    condition3: "tasks.company_id = 169 AND tasks.assigned_to IS NULL AND tasks.task_scope = 'company'",
    condition4: "tasks.task_type = 'user_onboarding' AND LOWER(tasks.user_email) = LOWER('e.vancnavarr.o@gmail.com')"
  }
}
[Tasks] Tasks found: { count: 4 }
1:12:38 PM [info] GET /api/tasks 304 in 175ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
1:12:43 PM [info] GET /api/tasks 304 in 59ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
1:12:48 PM [info] GET /api/tasks 304 in 58ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[Auth] Using cached user data: 210
1:12:53 PM [info] GET /api/tasks 304 in 58ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
1:12:59 PM [info] GET /api/tasks 304 in 58ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[Tasks] Using cached task data for user: 210
1:13:04 PM [info] GET /api/tasks 304 in 58ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[WebSocket] Received pong
[WebSocket] Received pong
[WebSocket] Received message: {
  type: 'pong',
  payload: { timestamp: '2025-04-16T13:13:05.115Z' },
  connectionId: 'ws-1'
}
[Tasks] ====== Starting task fetch =====
[Tasks] User details: { id: 210, company_id: 169, email: 'e.vancnavarr.o@gmail.com' }
[Tasks] KYB tasks found: { count: 1 }
[Tasks] Query conditions: {
  conditions: {
    condition1: 'tasks.assigned_to = 210',
    condition2: 'tasks.created_by = 210',
    condition3: "tasks.company_id = 169 AND tasks.assigned_to IS NULL AND tasks.task_scope = 'company'",
    condition4: "tasks.task_type = 'user_onboarding' AND LOWER(tasks.user_email) = LOWER('e.vancnavarr.o@gmail.com')"
  }
}
[Tasks] Tasks found: { count: 4 }
1:13:09 PM [info] GET /api/tasks 304 in 173ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
1:13:15 PM [info] GET /api/tasks 304 in 58ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
1:13:20 PM [info] GET /api/tasks 304 in 59ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[Auth] Using cached user data: 210
1:13:25 PM [info] GET /api/tasks 304 in 58ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
1:13:30 PM [info] GET /api/tasks 304 in 58ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
1:13:33 PM [vite] hmr update /src/index.css?v=Cwxr-RvBS1lAP7sq5WIoE, /src/App.tsx?v=Cwxr-RvBS1lAP7sq5WIoE, /src/pages/diagnostic-page.tsx, /src/components/diagnostic/DiagnosticFormView.tsx (x2)
Suppressing further connection logs. Pool size: 3
1:13:34 PM [info] GET /api/tasks 304 in 44ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[Auth] Using cached user data: 210
1:13:34 PM [info] GET /api/tasks 304 in 44ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
1:13:39 PM [info] GET /api/tasks 304 in 44ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[Auth] Unauthenticated user session
[Auth] Using cached user data: 210
[Auth] Using cached user data: 210
[Auth] Using cached user data: 210
[Tasks] ====== Starting task fetch =====
[Tasks] User details: { id: 210, company_id: 169, email: 'e.vancnavarr.o@gmail.com' }
[Tasks] KYB tasks found: { count: 1 }
[Tasks] Query conditions: {
  conditions: {
    condition1: 'tasks.assigned_to = 210',
    condition2: 'tasks.created_by = 210',
    condition3: "tasks.company_id = 169 AND tasks.assigned_to IS NULL AND tasks.task_scope = 'company'",
    condition4: "tasks.task_type = 'user_onboarding' AND LOWER(tasks.user_email) = LOWER('e.vancnavarr.o@gmail.com')"
  }
}
[Tasks] Tasks found: { count: 4 }
1:13:47 PM [info] GET /api/tasks 304 in 194ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[Auth] Using cached user data: 210
[Auth] Using cached user data: 210
[Auth] Returning user session data
[Auth] Using cached user data: 210
[WebSocket] Received pong
[Network Visualization] Fetching network data for company: 169
1:13:49 PM [info] GET /api/tasks 304 in 77ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
1:13:49 PM [info] GET /api/companies/current 304 in 94ms :: {"id":169,"name":"DevelopmentTesting","description":"FinTech partner company ...
[Network Visualization] Found network relationships: { count: 2 }
[Network Visualization] Returning visualization data: { centerNode: 'DevelopmentTesting', nodeCount: 2 }
1:13:49 PM [info] GET /api/network/visualization 304 in 180ms :: {"center":{"id":169,"name":"DevelopmentTesting","riskScore":0,"riskBucket":"l...
[Auth] Using cached user data: 210
1:13:49 PM [info] GET /api/tasks 304 in 59ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
New WebSocket client connected
[WebSocket] Received pong
[WebSocket] Received message: {
  type: 'pong',
  payload: { timestamp: '2025-04-16T13:13:50.074Z' },
  connectionId: 'ws-1'
}
New WebSocket client connected
1:13:52 PM [info] GET /api/tasks 304 in 58ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
1:13:55 PM [info] GET /api/tasks 304 in 58ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[Auth] Using cached user data: 210
1:13:58 PM [info] GET /api/tasks 304 in 58ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
1:14:00 PM [info] GET /api/tasks 304 in 59ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
1:14:03 PM [info] GET /api/tasks 304 in 57ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
1:14:05 PM [info] GET /api/tasks 304 in 57ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[Task Templates API] Fetching template for task type: company_kyb, user: 210
[Task Templates API] Found template: 1 (KYB Form) for task type: company_kyb
[Task Templates API] Retrieved 9 configuration items for template ID: 1
1:14:08 PM [info] GET /api/task-templates/by-type/company_kyb 304 in 193ms :: {"id":1,"name":"KYB Form","description":"Know Your Business form for company ...
1:14:08 PM [info] GET /api/tasks 304 in 58ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[KYB API DIAGNOSTIC] Schema check passed: kyb_fields table exists
[KYB API DIAGNOSTIC] Field count: 30
[KYB API DIAGNOSTIC] Fields fetched successfully: {
  count: 30,
  fieldKeys: [
    'legalEntityName',
    'registrationNumber',
    'incorporationDate',
    'businessType',
    'jurisdiction',
    'registeredAddress',
    'companyPhone',
    'contactEmail',
    'directorsAndOfficers',
    'ultimateBeneficialOwners',
    'authorizedSigners',
    'governmentOwnership',
    'priorNames',
    'externalAudit',
    'controlEnvironment',
    'corporateRegistration',
    'goodStanding',
    'licenses',
    'annualRecurringRevenue',
    'monthlyRecurringRevenue',
    'marketCapitalization',
    'lifetimeCustomerValue',
    'financialStatements',
    'operationalPolicies',
    'dataVolume',
    'dataTypes',
    'sanctionsCheck',
    'dueDiligence',
    'investigationsIncidents',
    'regulatoryActions'
  ],
  groups: [
    'companyProfile',
    'governanceLeadership',
    'financialProfile',
    'operationsCompliance'
  ],
  sampleField: {
    id: 1,
    field_key: 'legalEntityName',
    display_name: 'Legal Entity Name',
    field_type: 'TEXT',
    question: 'What is the registered business name?',
    group: 'companyProfile',
    required: true,
    order: 1,
    step_index: 0,
    validation_rules: null,
    help_text: 'The official name under which your business is registered with government authorities.',
    created_at: 2025-03-05T07:32:29.195Z,
    updated_at: 2025-03-05T07:32:29.195Z
  }
}
1:14:09 PM [info] GET /api/kyb/fields 304 in 210ms :: {"fields":[{"id":1,"field_key":"legalEntityName","display_name":"Legal Entity...
[KYB API Debug] Loading progress for task: 348
[KYB Debug] Retrieved task: {
  id: 348,
  status: 'ready_for_submission',
  progress: 100,
  metadata: [
    'company_id',
    'created_at',
    'statusFlow',
    'created_via',
    'formVersion',
    'kybFormFile',
    'lastUpdated',
    'status_flow',
    'company_name',
    'created_by_id',
    'submissionDate',
    'prerequisite_for'
  ],
  timestamp: '2025-04-16T13:14:09.273Z'
}
[KYB Debug] Retrieved responses: {
  responseCount: 30,
  fields: [
    { field: 'externalAudit', status: 'complete', hasValue: true },
    {
      field: 'lifetimeCustomerValue',
      status: 'complete',
      hasValue: true
    },
    {
      field: 'financialStatements',
      status: 'complete',
      hasValue: true
    },
    {
      field: 'operationalPolicies',
      status: 'complete',
      hasValue: true
    },
    { field: 'dataVolume', status: 'complete', hasValue: true }
  ],
  timestamp: '2025-04-16T13:14:09.342Z'
}
[KYB API Debug] Retrieved task data: {
  id: 348,
  responseCount: 30,
  progress: 100,
  status: 'ready_for_submission',
  formDataKeys: [
    'externalAudit',
    'lifetimeCustomerValue',
    'financialStatements',
    'operationalPolicies',
    'dataVolume',
    'dataTypes',
    'sanctionsCheck',
    'dueDiligence',
    'investigationsIncidents',
    'regulatoryActions',
    'legalEntityName',
    'registrationNumber',
    'incorporationDate',
    'businessType',
    'jurisdiction',
    'registeredAddress',
    'companyPhone',
    'contactEmail',
    'directorsAndOfficers',
    'ultimateBeneficialOwners',
    'authorizedSigners',
    'governmentOwnership',
    'priorNames',
    'controlEnvironment',
    'corporateRegistration',
    'goodStanding',
    'licenses',
    'annualRecurringRevenue',
    'monthlyRecurringRevenue',
    'marketCapitalization'
  ],
  formData: {
    externalAudit: 'asdf',
    lifetimeCustomerValue: 'asdf',
    financialStatements: 'ffff',
    operationalPolicies: 'asdf',
    dataVolume: 'asdf',
    dataTypes: 'asdf',
    sanctionsCheck: 'asdf',
    dueDiligence: 'asdf',
    investigationsIncidents: 'asdf',
    regulatoryActions: 'asdf',
    legalEntityName: 'asdfasdf',
    registrationNumber: 'bcdefghijk',
    incorporationDate: 'ab',
    businessType: 'ff',
    jurisdiction: 'asd',
    registeredAddress: 'dd',
    companyPhone: 'ff',
    contactEmail: 'AASFD',
    directorsAndOfficers: 'asdf',
    ultimateBeneficialOwners: 'asdf',
    authorizedSigners: 'asdf',
    governmentOwnership: 'asdf',
    priorNames: 'r',
    controlEnvironment: 'asdf',
    corporateRegistration: 'asdf',
    goodStanding: 'asdf',
    licenses: 'asdf',
    annualRecurringRevenue: 'pppp',
    monthlyRecurringRevenue: 'asdf',
    marketCapitalization: 'asdf'
  }
}
1:14:09 PM [info] GET /api/kyb/progress/348 304 in 186ms :: {"formData":{"externalAudit":"asdf","lifetimeCustomerValue":"asdf","financial...
[Auth] Using cached user data: 210
[KYB API Debug] Loading progress for task: 348
[KYB Debug] Retrieved task: {
  id: 348,
  status: 'ready_for_submission',
  progress: 100,
  metadata: [
    'company_id',
    'created_at',
    'statusFlow',
    'created_via',
    'formVersion',
    'kybFormFile',
    'lastUpdated',
    'status_flow',
    'company_name',
    'created_by_id',
    'submissionDate',
    'prerequisite_for'
  ],
  timestamp: '2025-04-16T13:14:09.653Z'
}
[KYB Debug] Retrieved responses: {
  responseCount: 30,
  fields: [
    { field: 'externalAudit', status: 'complete', hasValue: true },
    {
      field: 'lifetimeCustomerValue',
      status: 'complete',
      hasValue: true
    },
    {
      field: 'financialStatements',
      status: 'complete',
      hasValue: true
    },
    {
      field: 'operationalPolicies',
      status: 'complete',
      hasValue: true
    },
    { field: 'dataVolume', status: 'complete', hasValue: true }
  ],
  timestamp: '2025-04-16T13:14:09.710Z'
}
[KYB API Debug] Retrieved task data: {
  id: 348,
  responseCount: 30,
  progress: 100,
  status: 'ready_for_submission',
  formDataKeys: [
    'externalAudit',
    'lifetimeCustomerValue',
    'financialStatements',
    'operationalPolicies',
    'dataVolume',
    'dataTypes',
    'sanctionsCheck',
    'dueDiligence',
    'investigationsIncidents',
    'regulatoryActions',
    'legalEntityName',
    'registrationNumber',
    'incorporationDate',
    'businessType',
    'jurisdiction',
    'registeredAddress',
    'companyPhone',
    'contactEmail',
    'directorsAndOfficers',
    'ultimateBeneficialOwners',
    'authorizedSigners',
    'governmentOwnership',
    'priorNames',
    'controlEnvironment',
    'corporateRegistration',
    'goodStanding',
    'licenses',
    'annualRecurringRevenue',
    'monthlyRecurringRevenue',
    'marketCapitalization'
  ],
  formData: {
    externalAudit: 'asdf',
    lifetimeCustomerValue: 'asdf',
    financialStatements: 'ffff',
    operationalPolicies: 'asdf',
    dataVolume: 'asdf',
    dataTypes: 'asdf',
    sanctionsCheck: 'asdf',
    dueDiligence: 'asdf',
    investigationsIncidents: 'asdf',
    regulatoryActions: 'asdf',
    legalEntityName: 'asdfasdf',
    registrationNumber: 'bcdefghijk',
    incorporationDate: 'ab',
    businessType: 'ff',
    jurisdiction: 'asd',
    registeredAddress: 'dd',
    companyPhone: 'ff',
    contactEmail: 'AASFD',
    directorsAndOfficers: 'asdf',
    ultimateBeneficialOwners: 'asdf',
    authorizedSigners: 'asdf',
    governmentOwnership: 'asdf',
    priorNames: 'r',
    controlEnvironment: 'asdf',
    corporateRegistration: 'asdf',
    goodStanding: 'asdf',
    licenses: 'asdf',
    annualRecurringRevenue: 'pppp',
    monthlyRecurringRevenue: 'asdf',
    marketCapitalization: 'asdf'
  }
}
1:14:09 PM [info] GET /api/kyb/progress/348 304 in 173ms :: {"formData":{"externalAudit":"asdf","lifetimeCustomerValue":"asdf","financial...
[KYB API Debug] Loading progress for task: 348
[KYB Debug] Retrieved task: {
  id: 348,
  status: 'ready_for_submission',
  progress: 100,
  metadata: [
    'company_id',
    'created_at',
    'statusFlow',
    'created_via',
    'formVersion',
    'kybFormFile',
    'lastUpdated',
    'status_flow',
    'company_name',
    'created_by_id',
    'submissionDate',
    'prerequisite_for'
  ],
  timestamp: '2025-04-16T13:14:10.021Z'
}
[KYB Debug] Retrieved responses: {
  responseCount: 30,
  fields: [
    { field: 'externalAudit', status: 'complete', hasValue: true },
    {
      field: 'lifetimeCustomerValue',
      status: 'complete',
      hasValue: true
    },
    {
      field: 'financialStatements',
      status: 'complete',
      hasValue: true
    },
    {
      field: 'operationalPolicies',
      status: 'complete',
      hasValue: true
    },
    { field: 'dataVolume', status: 'complete', hasValue: true }
  ],
  timestamp: '2025-04-16T13:14:10.077Z'
}
[KYB API Debug] Retrieved task data: {
  id: 348,
  responseCount: 30,
  progress: 100,
  status: 'ready_for_submission',
  formDataKeys: [
    'externalAudit',
    'lifetimeCustomerValue',
    'financialStatements',
    'operationalPolicies',
    'dataVolume',
    'dataTypes',
    'sanctionsCheck',
    'dueDiligence',
    'investigationsIncidents',
    'regulatoryActions',
    'legalEntityName',
    'registrationNumber',
    'incorporationDate',
    'businessType',
    'jurisdiction',
    'registeredAddress',
    'companyPhone',
    'contactEmail',
    'directorsAndOfficers',
    'ultimateBeneficialOwners',
    'authorizedSigners',
    'governmentOwnership',
    'priorNames',
    'controlEnvironment',
    'corporateRegistration',
    'goodStanding',
    'licenses',
    'annualRecurringRevenue',
    'monthlyRecurringRevenue',
    'marketCapitalization'
  ],
  formData: {
    externalAudit: 'asdf',
    lifetimeCustomerValue: 'asdf',
    financialStatements: 'ffff',
    operationalPolicies: 'asdf',
    dataVolume: 'asdf',
    dataTypes: 'asdf',
    sanctionsCheck: 'asdf',
    dueDiligence: 'asdf',
    investigationsIncidents: 'asdf',
    regulatoryActions: 'asdf',
    legalEntityName: 'asdfasdf',
    registrationNumber: 'bcdefghijk',
    incorporationDate: 'ab',
    businessType: 'ff',
    jurisdiction: 'asd',
    registeredAddress: 'dd',
    companyPhone: 'ff',
    contactEmail: 'AASFD',
    directorsAndOfficers: 'asdf',
    ultimateBeneficialOwners: 'asdf',
    authorizedSigners: 'asdf',
    governmentOwnership: 'asdf',
    priorNames: 'r',
    controlEnvironment: 'asdf',
    corporateRegistration: 'asdf',
    goodStanding: 'asdf',
    licenses: 'asdf',
    annualRecurringRevenue: 'pppp',
    monthlyRecurringRevenue: 'asdf',
    marketCapitalization: 'asdf'
  }
}
1:14:10 PM [info] GET /api/kyb/progress/348 304 in 173ms :: {"formData":{"externalAudit":"asdf","lifetimeCustomerValue":"asdf","financial...
1:14:13 PM [info] GET /api/tasks 304 in 58ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[Tasks] ====== Starting task fetch =====
[Tasks] User details: { id: 210, company_id: 169, email: 'e.vancnavarr.o@gmail.com' }
[Tasks] KYB tasks found: { count: 1 }
[Tasks] Query conditions: {
  conditions: {
    condition1: 'tasks.assigned_to = 210',
    condition2: 'tasks.created_by = 210',
    condition3: "tasks.company_id = 169 AND tasks.assigned_to IS NULL AND tasks.task_scope = 'company'",
    condition4: "tasks.task_type = 'user_onboarding' AND LOWER(tasks.user_email) = LOWER('e.vancnavarr.o@gmail.com')"
  }
}
[Tasks] Tasks found: { count: 4 }
1:14:19 PM [info] GET /api/tasks 304 in 175ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
1:14:24 PM [info] GET /api/tasks 304 in 58ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
1:14:29 PM [info] POST /api/kyb/progress 200 in 70ms
1:14:29 PM [info] GET /api/tasks 304 in 57ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[Auth] Using cached user data: 210
1:14:30 PM [info] POST /api/kyb/progress 200 in 61ms
1:14:33 PM [info] POST /api/kyb/progress 200 in 62ms
1:14:33 PM [info] POST /api/kyb/progress 200 in 59ms
[WebSocket] Received pong
1:14:35 PM [info] GET /api/tasks 304 in 59ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[WebSocket] Received pong
[WebSocket] Received pong
[WebSocket] Received message: {
  type: 'pong',
  payload: { timestamp: '2025-04-16T13:14:35.074Z' },
  connectionId: 'ws-1'
}
[WebSocket] Received pong
[WebSocket] Received message: {
  type: 'pong',
  payload: { timestamp: '2025-04-16T13:14:35.576Z' },
  connectionId: 'ws-1'
}
1:14:35 PM [info] POST /api/kyb/progress 200 in 68ms
1:14:36 PM [info] POST /api/kyb/progress 200 in 62ms
1:14:39 PM [info] POST /api/kyb/progress 200 in 59ms
1:14:40 PM [info] GET /api/tasks 304 in 58ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
1:14:43 PM [info] POST /api/kyb/progress 200 in 63ms
1:14:45 PM [info] GET /api/tasks 304 in 58ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[Tasks] ====== Starting task fetch =====
[Tasks] User details: { id: 210, company_id: 169, email: 'e.vancnavarr.o@gmail.com' }
[Tasks] KYB tasks found: { count: 1 }
[Tasks] Query conditions: {
  conditions: {
    condition1: 'tasks.assigned_to = 210',
    condition2: 'tasks.created_by = 210',
    condition3: "tasks.company_id = 169 AND tasks.assigned_to IS NULL AND tasks.task_scope = 'company'",
    condition4: "tasks.task_type = 'user_onboarding' AND LOWER(tasks.user_email) = LOWER('e.vancnavarr.o@gmail.com')"
  }
}
[Tasks] Tasks found: { count: 4 }
1:14:50 PM [info] GET /api/tasks 304 in 175ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
1:14:56 PM [info] GET /api/tasks 304 in 58ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
1:15:00 PM [info] GET /api/tasks 304 in 58ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
1:15:00 PM [info] GET /api/tasks 304 in 57ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
1:15:01 PM [info] GET /api/tasks 304 in 62ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[Auth] Returning user session data
[Task Templates API] Fetching template for task type: company_kyb, user: 210
1:15:02 PM [info] GET /api/companies/current 304 in 57ms :: {"id":169,"name":"DevelopmentTesting","description":"FinTech partner company ...
[Task Templates API] Found template: 1 (KYB Form) for task type: company_kyb
[Task Templates API] Retrieved 9 configuration items for template ID: 1
1:15:02 PM [info] GET /api/task-templates/by-type/company_kyb 304 in 171ms :: {"id":1,"name":"KYB Form","description":"Know Your Business form for company ...
[KYB API Debug] Loading progress for task: 348
[KYB Debug] Retrieved task: {
  id: 348,
  status: 'ready_for_submission',
  progress: 100,
  metadata: [
    'company_id',
    'created_at',
    'statusFlow',
    'created_via',
    'formVersion',
    'kybFormFile',
    'lastUpdated',
    'status_flow',
    'company_name',
    'created_by_id',
    'submissionDate',
    'prerequisite_for'
  ],
  timestamp: '2025-04-16T13:15:02.555Z'
}
[KYB Debug] Retrieved responses: {
  responseCount: 30,
  fields: [
    { field: 'externalAudit', status: 'complete', hasValue: true },
    {
      field: 'lifetimeCustomerValue',
      status: 'complete',
      hasValue: true
    },
    {
      field: 'financialStatements',
      status: 'complete',
      hasValue: true
    },
    {
      field: 'operationalPolicies',
      status: 'complete',
      hasValue: true
    },
    { field: 'dataVolume', status: 'complete', hasValue: true }
  ],
  timestamp: '2025-04-16T13:15:02.613Z'
}
[KYB API Debug] Retrieved task data: {
  id: 348,
  responseCount: 30,
  progress: 100,
  status: 'ready_for_submission',
  formDataKeys: [
    'externalAudit',
    'lifetimeCustomerValue',
    'financialStatements',
    'operationalPolicies',
    'dataVolume',
    'dataTypes',
    'sanctionsCheck',
    'dueDiligence',
    'investigationsIncidents',
    'regulatoryActions',
    'legalEntityName',
    'registrationNumber',
    'incorporationDate',
    'businessType',
    'jurisdiction',
    'registeredAddress',
    'companyPhone',
    'contactEmail',
    'directorsAndOfficers',
    'ultimateBeneficialOwners',
    'authorizedSigners',
    'governmentOwnership',
    'priorNames',
    'controlEnvironment',
    'corporateRegistration',
    'goodStanding',
    'licenses',
    'annualRecurringRevenue',
    'monthlyRecurringRevenue',
    'marketCapitalization'
  ],
  formData: {
    externalAudit: 'asdf',
    lifetimeCustomerValue: 'asdf',
    financialStatements: 'ffff',
    operationalPolicies: 'asdf',
    dataVolume: 'asdf',
    dataTypes: 'asdf',
    sanctionsCheck: 'asdf',
    dueDiligence: 'asdf',
    investigationsIncidents: 'asdf',
    regulatoryActions: 'asdf',
    legalEntityName: 'asdfasdf',
    registrationNumber: 'bcdefghijk',
    incorporationDate: 'ab',
    businessType: 'ff',
    jurisdiction: 'asd',
    registeredAddress: 'dd',
    companyPhone: 'ff',
    contactEmail: 'AASFD',
    directorsAndOfficers: 'asdf',
    ultimateBeneficialOwners: 'asdf',
    authorizedSigners: 'asdf',
    governmentOwnership: 'asdf',
    priorNames: 'r',
    controlEnvironment: 'asdf',
    corporateRegistration: 'asdf',
    goodStanding: 'asdf',
    licenses: 'asdf',
    annualRecurringRevenue: 'pppp',
    monthlyRecurringRevenue: 'asdf',
    marketCapitalization: 'asdf'
  }
}
1:15:02 PM [info] GET /api/kyb/progress/348 304 in 173ms :: {"formData":{"externalAudit":"asdf","lifetimeCustomerValue":"asdf","financial...
[KYB API Debug] Loading progress for task: 348
[KYB Debug] Retrieved task: {
  id: 348,
  status: 'ready_for_submission',
  progress: 100,
  metadata: [
    'company_id',
    'created_at',
    'statusFlow',
    'created_via',
    'formVersion',
    'kybFormFile',
    'lastUpdated',
    'status_flow',
    'company_name',
    'created_by_id',
    'submissionDate',
    'prerequisite_for'
  ],
  timestamp: '2025-04-16T13:15:02.920Z'
}
[KYB Debug] Retrieved responses: {
  responseCount: 30,
  fields: [
    { field: 'externalAudit', status: 'complete', hasValue: true },
    {
      field: 'lifetimeCustomerValue',
      status: 'complete',
      hasValue: true
    },
    {
      field: 'financialStatements',
      status: 'complete',
      hasValue: true
    },
    {
      field: 'operationalPolicies',
      status: 'complete',
      hasValue: true
    },
    { field: 'dataVolume', status: 'complete', hasValue: true }
  ],
  timestamp: '2025-04-16T13:15:02.977Z'
}
[KYB API Debug] Retrieved task data: {
  id: 348,
  responseCount: 30,
  progress: 100,
  status: 'ready_for_submission',
  formDataKeys: [
    'externalAudit',
    'lifetimeCustomerValue',
    'financialStatements',
    'operationalPolicies',
    'dataVolume',
    'dataTypes',
    'sanctionsCheck',
    'dueDiligence',
    'investigationsIncidents',
    'regulatoryActions',
    'legalEntityName',
    'registrationNumber',
    'incorporationDate',
    'businessType',
    'jurisdiction',
    'registeredAddress',
    'companyPhone',
    'contactEmail',
    'directorsAndOfficers',
    'ultimateBeneficialOwners',
    'authorizedSigners',
    'governmentOwnership',
    'priorNames',
    'controlEnvironment',
    'corporateRegistration',
    'goodStanding',
    'licenses',
    'annualRecurringRevenue',
    'monthlyRecurringRevenue',
    'marketCapitalization'
  ],
  formData: {
    externalAudit: 'asdf',
    lifetimeCustomerValue: 'asdf',
    financialStatements: 'ffff',
    operationalPolicies: 'asdf',
    dataVolume: 'asdf',
    dataTypes: 'asdf',
    sanctionsCheck: 'asdf',
    dueDiligence: 'asdf',
    investigationsIncidents: 'asdf',
    regulatoryActions: 'asdf',
    legalEntityName: 'asdfasdf',
    registrationNumber: 'bcdefghijk',
    incorporationDate: 'ab',
    businessType: 'ff',
    jurisdiction: 'asd',
    registeredAddress: 'dd',
    companyPhone: 'ff',
    contactEmail: 'AASFD',
    directorsAndOfficers: 'asdf',
    ultimateBeneficialOwners: 'asdf',
    authorizedSigners: 'asdf',
    governmentOwnership: 'asdf',
    priorNames: 'r',
    controlEnvironment: 'asdf',
    corporateRegistration: 'asdf',
    goodStanding: 'asdf',
    licenses: 'asdf',
    annualRecurringRevenue: 'pppp',
    monthlyRecurringRevenue: 'asdf',
    marketCapitalization: 'asdf'
  }
}
1:15:03 PM [info] GET /api/kyb/progress/348 304 in 172ms :: {"formData":{"externalAudit":"asdf","lifetimeCustomerValue":"asdf","financial...
[KYB API Debug] Loading progress for task: 348
[KYB Debug] Retrieved task: {
  id: 348,
  status: 'ready_for_submission',
  progress: 100,
  metadata: [
    'company_id',
    'created_at',
    'statusFlow',
    'created_via',
    'formVersion',
    'kybFormFile',
    'lastUpdated',
    'status_flow',
    'company_name',
    'created_by_id',
    'submissionDate',
    'prerequisite_for'
  ],
  timestamp: '2025-04-16T13:15:03.281Z'
}
[KYB Debug] Retrieved responses: {
  responseCount: 30,
  fields: [
    { field: 'externalAudit', status: 'complete', hasValue: true },
    {
      field: 'lifetimeCustomerValue',
      status: 'complete',
      hasValue: true
    },
    {
      field: 'financialStatements',
      status: 'complete',
      hasValue: true
    },
    {
      field: 'operationalPolicies',
      status: 'complete',
      hasValue: true
    },
    { field: 'dataVolume', status: 'complete', hasValue: true }
  ],
  timestamp: '2025-04-16T13:15:03.338Z'
}
[KYB API Debug] Retrieved task data: {
  id: 348,
  responseCount: 30,
  progress: 100,
  status: 'ready_for_submission',
  formDataKeys: [
    'externalAudit',
    'lifetimeCustomerValue',
    'financialStatements',
    'operationalPolicies',
    'dataVolume',
    'dataTypes',
    'sanctionsCheck',
    'dueDiligence',
    'investigationsIncidents',
    'regulatoryActions',
    'legalEntityName',
    'registrationNumber',
    'incorporationDate',
    'businessType',
    'jurisdiction',
    'registeredAddress',
    'companyPhone',
    'contactEmail',
    'directorsAndOfficers',
    'ultimateBeneficialOwners',
    'authorizedSigners',
    'governmentOwnership',
    'priorNames',
    'controlEnvironment',
    'corporateRegistration',
    'goodStanding',
    'licenses',
    'annualRecurringRevenue',
    'monthlyRecurringRevenue',
    'marketCapitalization'
  ],
  formData: {
    externalAudit: 'asdf',
    lifetimeCustomerValue: 'asdf',
    financialStatements: 'ffff',
    operationalPolicies: 'asdf',
    dataVolume: 'asdf',
    dataTypes: 'asdf',
    sanctionsCheck: 'asdf',
    dueDiligence: 'asdf',
    investigationsIncidents: 'asdf',
    regulatoryActions: 'asdf',
    legalEntityName: 'asdfasdf',
    registrationNumber: 'bcdefghijk',
    incorporationDate: 'ab',
    businessType: 'ff',
    jurisdiction: 'asd',
    registeredAddress: 'dd',
    companyPhone: 'ff',
    contactEmail: 'AASFD',
    directorsAndOfficers: 'asdf',
    ultimateBeneficialOwners: 'asdf',
    authorizedSigners: 'asdf',
    governmentOwnership: 'asdf',
    priorNames: 'r',
    controlEnvironment: 'asdf',
    corporateRegistration: 'asdf',
    goodStanding: 'asdf',
    licenses: 'asdf',
    annualRecurringRevenue: 'pppp',
    monthlyRecurringRevenue: 'asdf',
    marketCapitalization: 'asdf'
  }
}
1:15:03 PM [info] GET /api/kyb/progress/348 304 in 172ms :: {"formData":{"externalAudit":"asdf","lifetimeCustomerValue":"asdf","financial...
1:15:06 PM [info] GET /api/tasks 304 in 58ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
1:15:11 PM [info] GET /api/tasks 304 in 59ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
1:15:17 PM [info] GET /api/tasks 304 in 58ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[WebSocket] Received pong
[WebSocket] Received pong
[WebSocket] Received pong
[WebSocket] Received message: {
  type: 'pong',
  payload: { timestamp: '2025-04-16T13:15:20.070Z' },
  connectionId: 'ws-1'
}
[WebSocket] Received pong
[WebSocket] Received message: {
  type: 'pong',
  payload: { timestamp: '2025-04-16T13:15:20.583Z' },
  connectionId: 'ws-1'
}