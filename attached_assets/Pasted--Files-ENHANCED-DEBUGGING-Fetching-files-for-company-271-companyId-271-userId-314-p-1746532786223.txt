[Files] ⚠️ ENHANCED DEBUGGING: Fetching files for company 271 {
  companyId: 271,
  userId: 314,
  pagination: { page: 1, pageSize: 5, offset: 0 },
  totalFilesCount: 0,
  timestamp: '2025-05-06T11:55:19.785Z',
  userCompanyId: 271,
  userName: undefined,
  userEmail: '16@e.com'
}
[Files] SQL: SELECT * FROM files WHERE company_id = 271 ORDER BY created_at DESC LIMIT 5 OFFSET 0
[Files] Count SQL: SELECT COUNT(*) FROM files WHERE company_id = 271
[Auth] Processing /api/auth/user request
[Auth] Request authentication state: {
  isAuthenticated: true,
  hasUser: true,
  sessionID: 'gjkh2iNS0Ppv7ocbJugoE_dqlbdhe9_G'
}
[Auth] Returning user session data: { id: 314, email: '16@e.com', company_id: 271 }
[Files] ✅ Query returned 0 files {
  recordCount: 0,
  totalFiles: 0,
  page: 1,
  pageSize: 5,
  fileIds: [],
  company: { id: 271, name: undefined },
  firstRecord: null,
  timestamp: '2025-05-06T11:55:19.816Z'
}
[UnifiedProgressCalc] Calculating progress for task 754 (company_kyb)
[2025-05-06T11:55:19.849Z] [INFO] GET /api/files 304 in 96ms :: {"data":[],"pagination":{"page":1,"pageSize":5,"totalItems":0,"totalPages":0}}
[UnifiedProgressCalc] Task 754 (company_kyb) progress: 0/30 = 0%
[STATUS DETERMINATION] Calculating status for task with: {
  progress: 0,
  currentStatus: 'ready_for_submission',
  hasSubmissionDate: false,
  hasFileId: false,
  hasSubmittedFlag: false,
  hasValidResponses: false,
  timestamp: '2025-05-06T11:55:19.892Z'
}
[STATUS DETERMINATION] Task has 0% progress, setting to NOT_STARTED
[2025-05-06T11:55:19.892Z] [INFO] [Progress Validation] Task 754 progress value normalized: {"taskId":754,"taskType":"company_kyb","source":"unified-task-progress","originalValue":0,"originalType":"number","validatedValue":0,"numericValue":0,"wasChanged":false,"biasAvoidance":true,"previousProgress":100,"isForceUpdate":false}
[UnifiedProgress] Updating task 754 progress with explicit SQL casting: { progress: 0, status: 'not_started', taskType: 'company_kyb' }
[UnifiedProgress] Updating task 754 with values: {
  progress: 0,
  status: 'not_started',
  taskType: 'company_kyb',
  timestamp: '2025-05-06T11:55:19.892Z'
}
[UnifiedProgress] Error updating task 754 progress: {
  taskId: 754,
  taskType: 'company_kyb',
  error: 'could not determine polymorphic type because input has type unknown',
  stack: 'error: could not determine polymorphic type because input has type unknown\n' +
    '    at cn.parseErrorMessage (file:///home/runner/workspace/node_modules/@neondatabase/serverless/index.mjs:1182:6)\n' +
    '    at cn.handlePacket (file:///home/runner/workspace/node_modules/@neondatabase/serverless/index.mjs:1143:13)\n' +
    '    at cn.parse (file:///home/runner/workspace/node_modules/@neondatabase/serverless/index.mjs:1127:36)\n' +
    '    at v.<anonymous> (file:///home/runner/workspace/node_modules/@neondatabase/serverless/index.mjs:1190:16)\n' +
    '    at v.emit (file:///home/runner/workspace/node_modules/@neondatabase/serverless/index.mjs:397:12)\n' +
    '    at WebSocket.<anonymous> (file:///home/runner/workspace/node_modules/@neondatabase/serverless/index.mjs:987:80)\n' +
    '    at callListener (/home/runner/workspace/node_modules/ws/lib/event-target.js:290:14)\n' +
    '    at WebSocket.onMessage (/home/runner/workspace/node_modules/ws/lib/event-target.js:209:9)\n' +
    '    at WebSocket.emit (node:events:518:28)\n' +
    '    at Receiver.receiverOnMessage (/home/runner/workspace/node_modules/ws/lib/websocket.js:1220:20)\n' +
    '    at Receiver.emit (node:events:518:28)\n' +
    '    at Receiver.dataMessage (/home/runner/workspace/node_modules/ws/lib/receiver.js:569:14)\n' +
    '    at Receiver.getData (/home/runner/workspace/node_modules/ws/lib/receiver.js:496:10)\n' +
    '    at Receiver.startLoop (/home/runner/workspace/node_modules/ws/lib/receiver.js:167:16)\n' +
    '    at Receiver._write (/home/runner/workspace/node_modules/ws/lib/receiver.js:94:10)\n' +
    '    at writeOrBuffer (node:internal/streams/writable:572:12)\n' +
    '    at _write (node:internal/streams/writable:501:10)\n' +
    '    at Writable.write (node:internal/streams/writable:510:10)\n' +
    '    at TLSSocket.socketOnData (/home/runner/workspace/node_modules/ws/lib/websocket.js:1355:35)\n' +
    '    at TLSSocket.emit (node:events:518:28)\n' +
    '    at addChunk (node:internal/streams/readable:561:12)\n' +
    '    at readableAddChunkPushByteMode (node:internal/streams/readable:512:3)\n' +
    '    at Readable.push (node:internal/streams/readable:392:5)\n' +
    '    at TLSWrap.onStreamRead (node:internal/stream_base_commons:191:23)',
  diagnosticId: 'prog-1746532519772-425'
}
[2025-05-06T11:55:19.952Z] [INFO] [TaskDependencies] Unlocked task using unified progress calculator {"companyId":271,"taskId":754,"taskType":"company_kyb","isKy3pTask":false,"calculatedProgress":{"success":false,"message":"Error updating task progress: could not determine polymorphic type because input has type unknown"},"previousProgress":100,"wasPreserved":false}
[2025-05-06T11:55:19.952Z] [INFO] [TaskDependencies] Processing KY3P task {"taskId":755,"taskType":"ky3p","currentProgress":0,"currentStatus":"not_started","timestamp":"2025-05-06T11:55:19.952Z"}
[UnifiedProgress] Starting progress update for task 755 (ky3p) {
  taskId: 755,
  taskType: 'ky3p',
  diagnosticId: 'prog-1746532519952-223',
  metadata: [
    'locked',
    'prerequisite_completed',
    'prerequisite_completed_at',
    'dependencyUnlockOperation',
    'previousProgress',
    'previousStatus',
    'isKy3pTask'
  ]
}
[Files] Starting file fetch request
[Files] Request parameters: {
  companyId: '271',
  userId: 314,
  query: { company_id: '271', page: '1', pageSize: '5' },
  user: {
    id: 314,
    email: '16@e.com',
    full_name: 'John Doe',
    first_name: 'John',
    last_name: 'Doe',
    password: '$2b$10$LjGYefmj.3zUkm0.X51AoeFre31APP8s1ohOcRrn/n1DsKmXfMRrC',
    company_id: 271,
    onboarding_user_completed: true,
    created_at: 2025-05-06T07:05:43.947Z,
    updated_at: 2025-05-06T07:07:47.898Z
  }
}
[Files] Executing database query for company: 271
[UnifiedProgressCalc] Calculating progress for task 755 (ky3p)
[Files] ⚠️ ENHANCED DEBUGGING: Fetching files for company 271 {
  companyId: 271,
  userId: 314,
  pagination: { page: 1, pageSize: 5, offset: 0 },
  totalFilesCount: 0,
  timestamp: '2025-05-06T11:55:20.032Z',
  userCompanyId: 271,
  userName: undefined,
  userEmail: '16@e.com'
}
[Files] SQL: SELECT * FROM files WHERE company_id = 271 ORDER BY created_at DESC LIMIT 5 OFFSET 0
[Files] Count SQL: SELECT COUNT(*) FROM files WHERE company_id = 271
[Files] ✅ Query returned 0 files {
  recordCount: 0,
  totalFiles: 0,
  page: 1,
  pageSize: 5,
  fileIds: [],
  company: { id: 271, name: undefined },
  firstRecord: null,
  timestamp: '2025-05-06T11:55:20.064Z'
}
[KY3P Progress] Calculated progress for task 755: {
  taskId: 755,
  taskType: 'ky3p',
  normalizedTaskType: 'ky3p',
  totalFields: 120,
  completedFields: 0,
  progress: 0,
  timeStamp: '2025-05-06T11:55:20.071Z'
}
[UnifiedProgressCalc] Task 755 (ky3p) progress: 0/120 = 0%
[2025-05-06T11:55:20.095Z] [INFO] GET /api/files 304 in 93ms :: {"data":[],"pagination":{"page":1,"pageSize":5,"totalItems":0,"totalPages":0}}
[INFO] [WebSocket] Broadcast task_updated to 3 clients
[2025-05-06T11:55:20.101Z] [INFO] [TaskDependencies] Unlocked task using unified progress calculator {"companyId":271,"taskId":755,"taskType":"ky3p","isKy3pTask":true,"calculatedProgress":{"success":true,"taskId":755,"message":"Progress unchanged","progress":0,"status":"not_started"},"previousProgress":0,"wasPreserved":false}
[UnifiedProgress] Starting progress update for task 756 (open_banking) {
  taskId: 756,
  taskType: 'open_banking',
  diagnosticId: 'prog-1746532520101-841',
  metadata: [
    'locked',
    'prerequisite_completed',
    'prerequisite_completed_at',
    'dependencyUnlockOperation',
    'previousProgress',
    'previousStatus',
    'isKy3pTask'
  ]
}
[UnifiedProgressCalc] Calculating progress for task 756 (open_banking)