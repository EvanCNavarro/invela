 tsx server/index.ts

Database migrations disabled - schema already applied
[EmailService] Initializing email service
[EmailService] Email service initialized successfully
[Auth] Setting up authentication...
[Auth] Authentication setup completed
[Routes] Routes setup completed
[WebSocket] Server initialized on path: /ws
8:11:23 PM [info] Setting up Vite development server
8:11:23 PM [express] Server running on port 5000
[Auth] Unauthenticated user session
8:11:42 PM [vite] hmr update /src/components/forms/UniversalForm.tsx, /src/index.css?v=nQ0u9wdt5QKGwnIzYPLK9
8:12:08 PM [vite] hmr update /src/components/forms/UniversalForm.tsx, /src/index.css?v=nQ0u9wdt5QKGwnIzYPLK9 (x2)
[2025-04-15T20:12:15.874Z] New client connected to the pool (1/3)
[Auth] Unauthenticated user session
[Auth] Deserializing user: 210
[2025-04-15T20:12:17.759Z] New client connected to the pool (2/3)
[2025-04-15T20:12:18.505Z] New client connected to the pool (3/3)
[Auth] Using cached user data: 210
[Auth] Using cached user data: 210
[Auth] Using cached user data: 210
[Auth] Using cached user data: 210
[Auth] Using cached user data: 210
[Auth] Using cached user data: 210
[Auth] Using cached user data: 210
[Auth] Using cached user data: 210
[Auth] Returning user session data
[Auth] Using cached user data: 210
New WebSocket client connected
[Auth] Using cached user data: 210
[Tasks] ====== Starting task fetch =====
[Tasks] User details: { id: 210, company_id: 169, email: 'e.vancnavarr.o@gmail.com' }
[Network Visualization] Fetching network data for company: 169
[Tasks] KYB tasks found: { count: 1 }
[Tasks] Query conditions: {
  conditions: {
    condition1: 'tasks.assigned_to = 210',
    condition2: 'tasks.created_by = 210',
    condition3: "tasks.company_id = 169 AND tasks.assigned_to IS NULL AND tasks.task_scope = 'company'",
    condition4: "tasks.task_type = 'user_onboarding' AND LOWER(tasks.user_email) = LOWER('e.vancnavarr.o@gmail.com')"
  }
}
[Tasks] Tasks found: { count: 4 }
[Network Visualization] Found network relationships: { count: 2 }
[Network Visualization] Returning visualization data: { centerNode: 'DevelopmentTesting', nodeCount: 2 }
[Current Company] Fetching company for user: { userId: 210, companyId: 169 }
8:12:25 PM [info] GET /api/tasks 200 in 125ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:12:25 PM [info] GET /api/network/visualization 304 in 130ms :: {"center":{"id":169,"name":"DevelopmentTesting","riskScore":0,"riskBucket":"l...
New WebSocket client connected
[Current Company] Found company: {
  id: 169,
  name: 'DevelopmentTesting',
  onboardingCompleted: false,
  riskScore: null
}
8:12:25 PM [info] GET /api/companies/current 304 in 90ms :: {"id":169,"name":"DevelopmentTesting","description":"FinTech partner company ...
8:12:28 PM [info] GET /api/tasks 304 in 30ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[Auth] Using cached user data: 210
[Auth] Using cached user data: 210
[Auth] Returning user session data
[Tasks Routes] Fetching task by ID (special .json endpoint): { taskId: 348, timestamp: '2025-04-15T20:12:30.187Z' }
8:12:30 PM [info] GET /api/tasks 304 in 35ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[Tasks Routes] Task found by ID (special .json endpoint): {
  taskId: 348,
  title: '1. KYB Form: DevelopmentTesting',
  type: 'company_kyb',
  timestamp: '2025-04-15T20:12:30.240Z'
}
8:12:30 PM [info] GET /api/companies/current 304 in 33ms :: {"id":169,"name":"DevelopmentTesting","description":"FinTech partner company ...
8:12:30 PM [info] GET /api/tasks.json/348 200 in 84ms :: {"id":348,"title":"1. KYB Form: DevelopmentTesting","description":"Complete K...
8:12:30 PM [info] GET /api/tasks 304 in 34ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[Task Templates API] Fetching template for task type: company_kyb, user: 210
[Task Templates API] Found template: 1 (KYB Form) for task type: company_kyb
[Task Templates API] Retrieved 9 configuration items for template ID: 1
New WebSocket client connected
8:12:30 PM [info] GET /api/task-templates/by-type/company_kyb 304 in 113ms :: {"id":1,"name":"KYB Form","description":"Know Your Business form for company ...
[KYB API DIAGNOSTIC] Schema check passed: kyb_fields table exists
[KYB API DIAGNOSTIC] Field count: 30
[KYB API DIAGNOSTIC] Fields fetched successfully: {
  count: 30,
  fieldKeys: [
    'legalEntityName',
    'registrationNumber',
    'incorporationDate',
    'businessType',
    'jurisdiction',
    'registeredAddress',
    'companyPhone',
    'contactEmail',
    'directorsAndOfficers',
    'ultimateBeneficialOwners',
    'authorizedSigners',
    'governmentOwnership',
    'priorNames',
    'externalAudit',
    'controlEnvironment',
    'corporateRegistration',
    'goodStanding',
    'licenses',
    'annualRecurringRevenue',
    'monthlyRecurringRevenue',
    'marketCapitalization',
    'lifetimeCustomerValue',
    'financialStatements',
    'operationalPolicies',
    'dataVolume',
    'dataTypes',
    'sanctionsCheck',
    'dueDiligence',
    'investigationsIncidents',
    'regulatoryActions'
  ],
  groups: [
    'companyProfile',
    'governanceLeadership',
    'financialProfile',
    'operationsCompliance'
  ],
  sampleField: {
    id: 1,
    field_key: 'legalEntityName',
    display_name: 'Legal Entity Name',
    field_type: 'TEXT',
    question: 'What is the registered business name?',
    group: 'companyProfile',
    required: true,
    order: 1,
    step_index: 0,
    validation_rules: null,
    help_text: 'The official name under which your business is registered with government authorities.',
    created_at: 2025-03-05T07:32:29.195Z,
    updated_at: 2025-03-05T07:32:29.195Z
  }
}
8:12:30 PM [info] GET /api/kyb/fields 304 in 110ms :: {"fields":[{"id":1,"field_key":"legalEntityName","display_name":"Legal Entity...
[KYB API Debug] Loading progress for task: 348
[KYB Debug] Retrieved task: {
  id: 348,
  status: 'submitted',
  progress: 100,
  metadata: [
    'company_id',
    'created_at',
    'statusFlow',
    'created_via',
    'formVersion',
    'kybFormFile',
    'lastUpdated',
    'status_flow',
    'company_name',
    'created_by_id',
    'submissionDate',
    'prerequisite_for'
  ],
  timestamp: '2025-04-15T20:12:31.004Z'
}
New WebSocket client connected
[KYB Debug] Retrieved responses: {
  responseCount: 30,
  fields: [
    { field: 'externalAudit', status: 'complete', hasValue: true },
    {
      field: 'lifetimeCustomerValue',
      status: 'complete',
      hasValue: true
    },
    {
      field: 'financialStatements',
      status: 'complete',
      hasValue: true
    },
    {
      field: 'operationalPolicies',
      status: 'complete',
      hasValue: true
    },
    { field: 'dataVolume', status: 'complete', hasValue: true }
  ],
  timestamp: '2025-04-15T20:12:31.046Z'
}
[KYB API Debug] Retrieved task data: {
  id: 348,
  responseCount: 30,
  progress: 100,
  status: 'submitted',
  formDataKeys: [
    'externalAudit',
    'lifetimeCustomerValue',
    'financialStatements',
    'operationalPolicies',
    'dataVolume',
    'dataTypes',
    'sanctionsCheck',
    'dueDiligence',
    'investigationsIncidents',
    'regulatoryActions',
    'legalEntityName',
    'registrationNumber',
    'incorporationDate',
    'businessType',
    'jurisdiction',
    'registeredAddress',
    'companyPhone',
    'contactEmail',
    'directorsAndOfficers',
    'ultimateBeneficialOwners',
    'authorizedSigners',
    'governmentOwnership',
    'priorNames',
    'controlEnvironment',
    'corporateRegistration',
    'goodStanding',
    'licenses',
    'annualRecurringRevenue',
    'monthlyRecurringRevenue',
    'marketCapitalization'
  ],
  formData: {
    externalAudit: 'asdf',
    lifetimeCustomerValue: 'asdf',
    financialStatements: 'asdf',
    operationalPolicies: 'asdf',
    dataVolume: 'asdf',
    dataTypes: 'asdf',
    sanctionsCheck: 'asdf',
    dueDiligence: 'asdf',
    investigationsIncidents: 'asdf',
    regulatoryActions: 'asdf',
    legalEntityName: 'asdfasdf',
    registrationNumber: 'bcdefghijk',
    incorporationDate: 'ab',
    businessType: 'ff',
    jurisdiction: 'asd',
    registeredAddress: 'dd',
    companyPhone: 'ff',
    contactEmail: 'AASFD',
    directorsAndOfficers: 'asdf',
    ultimateBeneficialOwners: 'asdf',
    authorizedSigners: 'asdf',
    governmentOwnership: 'asdf',
    priorNames: 'r',
    controlEnvironment: 'asdf',
    corporateRegistration: 'asdf',
    goodStanding: 'asdf',
    licenses: 'asdf',
    annualRecurringRevenue: 'asdf',
    monthlyRecurringRevenue: 'asdf',
    marketCapitalization: 'asdf'
  }
}
8:12:31 PM [info] GET /api/kyb/progress/348 200 in 104ms :: {"formData":{"externalAudit":"asdf","lifetimeCustomerValue":"asdf","financial...
8:12:31 PM [info] GET /api/tasks 304 in 33ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[KYB API Debug] Loading progress for task: 348
[KYB Debug] Retrieved task: {
  id: 348,
  status: 'submitted',
  progress: 100,
  metadata: [
    'company_id',
    'created_at',
    'statusFlow',
    'created_via',
    'formVersion',
    'kybFormFile',
    'lastUpdated',
    'status_flow',
    'company_name',
    'created_by_id',
    'submissionDate',
    'prerequisite_for'
  ],
  timestamp: '2025-04-15T20:12:31.252Z'
}
[KYB Debug] Retrieved responses: {
  responseCount: 30,
  fields: [
    { field: 'externalAudit', status: 'complete', hasValue: true },
    {
      field: 'lifetimeCustomerValue',
      status: 'complete',
      hasValue: true
    },
    {
      field: 'financialStatements',
      status: 'complete',
      hasValue: true
    },
    {
      field: 'operationalPolicies',
      status: 'complete',
      hasValue: true
    },
    { field: 'dataVolume', status: 'complete', hasValue: true }
  ],
  timestamp: '2025-04-15T20:12:31.281Z'
}
[KYB API Debug] Retrieved task data: {
  id: 348,
  responseCount: 30,
  progress: 100,
  status: 'submitted',
  formDataKeys: [
    'externalAudit',
    'lifetimeCustomerValue',
    'financialStatements',
    'operationalPolicies',
    'dataVolume',
    'dataTypes',
    'sanctionsCheck',
    'dueDiligence',
    'investigationsIncidents',
    'regulatoryActions',
    'legalEntityName',
    'registrationNumber',
    'incorporationDate',
    'businessType',
    'jurisdiction',
    'registeredAddress',
    'companyPhone',
    'contactEmail',
    'directorsAndOfficers',
    'ultimateBeneficialOwners',
    'authorizedSigners',
    'governmentOwnership',
    'priorNames',
    'controlEnvironment',
    'corporateRegistration',
    'goodStanding',
    'licenses',
    'annualRecurringRevenue',
    'monthlyRecurringRevenue',
    'marketCapitalization'
  ],
  formData: {
    externalAudit: 'asdf',
    lifetimeCustomerValue: 'asdf',
    financialStatements: 'asdf',
    operationalPolicies: 'asdf',
    dataVolume: 'asdf',
    dataTypes: 'asdf',
    sanctionsCheck: 'asdf',
    dueDiligence: 'asdf',
    investigationsIncidents: 'asdf',
    regulatoryActions: 'asdf',
    legalEntityName: 'asdfasdf',
    registrationNumber: 'bcdefghijk',
    incorporationDate: 'ab',
    businessType: 'ff',
    jurisdiction: 'asd',
    registeredAddress: 'dd',
    companyPhone: 'ff',
    contactEmail: 'AASFD',
    directorsAndOfficers: 'asdf',
    ultimateBeneficialOwners: 'asdf',
    authorizedSigners: 'asdf',
    governmentOwnership: 'asdf',
    priorNames: 'r',
    controlEnvironment: 'asdf',
    corporateRegistration: 'asdf',
    goodStanding: 'asdf',
    licenses: 'asdf',
    annualRecurringRevenue: 'asdf',
    monthlyRecurringRevenue: 'asdf',
    marketCapitalization: 'asdf'
  }
}
8:12:31 PM [info] GET /api/kyb/progress/348 304 in 94ms :: {"formData":{"externalAudit":"asdf","lifetimeCustomerValue":"asdf","financial...
8:12:36 PM [info] GET /api/tasks 304 in 30ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:12:41 PM [info] GET /api/tasks 304 in 30ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:12:46 PM [info] GET /api/tasks 304 in 33ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:12:51 PM [info] GET /api/tasks 304 in 32ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[Tasks] ====== Starting task fetch =====
[Tasks] User details: { id: 210, company_id: 169, email: 'e.vancnavarr.o@gmail.com' }
[Tasks] KYB tasks found: { count: 1 }
[Tasks] Query conditions: {
  conditions: {
    condition1: 'tasks.assigned_to = 210',
    condition2: 'tasks.created_by = 210',
    condition3: "tasks.company_id = 169 AND tasks.assigned_to IS NULL AND tasks.task_scope = 'company'",
    condition4: "tasks.task_type = 'user_onboarding' AND LOWER(tasks.user_email) = LOWER('e.vancnavarr.o@gmail.com')"
  }
}
[Tasks] Tasks found: { count: 4 }
8:12:57 PM [info] GET /api/tasks 304 in 91ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:13:02 PM [info] GET /api/tasks 304 in 31ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[Tasks] Using cached task data for user: 210
8:13:07 PM [info] GET /api/tasks 304 in 30ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[WebSocket] Received pong
[WebSocket] Received pong
[WebSocket] Received message: {
  type: 'pong',
  payload: { timestamp: '2025-04-15T20:13:10.871Z' },
  connectionId: 'ws-1'
}
8:13:12 PM [info] GET /api/tasks 304 in 31ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[WebSocket] Received pong
[WebSocket] Received pong
[WebSocket] Received message: {
  type: 'pong',
  payload: { timestamp: '2025-04-15T20:13:15.953Z' },
  connectionId: 'ws-1'
}
[Tasks] Using cached task data for user: 210
8:13:18 PM [info] GET /api/tasks 304 in 36ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:13:23 PM [info] GET /api/tasks 304 in 32ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[Tasks] ====== Starting task fetch =====
[Tasks] User details: { id: 210, company_id: 169, email: 'e.vancnavarr.o@gmail.com' }
[Tasks] KYB tasks found: { count: 1 }
[Tasks] Query conditions: {
  conditions: {
    condition1: 'tasks.assigned_to = 210',
    condition2: 'tasks.created_by = 210',
    condition3: "tasks.company_id = 169 AND tasks.assigned_to IS NULL AND tasks.task_scope = 'company'",
    condition4: "tasks.task_type = 'user_onboarding' AND LOWER(tasks.user_email) = LOWER('e.vancnavarr.o@gmail.com')"
  }
}
[Tasks] Tasks found: { count: 4 }
8:13:28 PM [info] GET /api/tasks 304 in 92ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:13:33 PM [info] GET /api/tasks 304 in 32ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:13:38 PM [info] GET /api/tasks 304 in 31ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:13:44 PM [info] GET /api/tasks 304 in 31ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:13:49 PM [info] GET /api/tasks 304 in 32ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:13:54 PM [info] GET /api/tasks 304 in 31ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[WebSocket] Received pong
[WebSocket] Received pong
[WebSocket] Received message: {
  type: 'pong',
  payload: { timestamp: '2025-04-15T20:13:55.884Z' },
  connectionId: 'ws-1'
}
[Tasks] ====== Starting task fetch =====
[Tasks] User details: { id: 210, company_id: 169, email: 'e.vancnavarr.o@gmail.com' }
[Tasks] KYB tasks found: { count: 1 }
[Tasks] Query conditions: {
  conditions: {
    condition1: 'tasks.assigned_to = 210',
    condition2: 'tasks.created_by = 210',
    condition3: "tasks.company_id = 169 AND tasks.assigned_to IS NULL AND tasks.task_scope = 'company'",
    condition4: "tasks.task_type = 'user_onboarding' AND LOWER(tasks.user_email) = LOWER('e.vancnavarr.o@gmail.com')"
  }
}
[Tasks] Tasks found: { count: 4 }
8:13:59 PM [info] GET /api/tasks 304 in 90ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[WebSocket] Received pong
[WebSocket] Received pong
[WebSocket] Received message: {
  type: 'pong',
  payload: { timestamp: '2025-04-15T20:14:00.957Z' },
  connectionId: 'ws-1'
}
8:14:04 PM [info] GET /api/tasks 304 in 31ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:14:10 PM [info] GET /api/tasks 304 in 40ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:14:15 PM [info] GET /api/tasks 304 in 31ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:14:20 PM [info] GET /api/tasks 304 in 31ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[Auth] Using cached user data: 210
[Tasks] Using cached task data for user: 210
8:14:25 PM [info] GET /api/tasks 304 in 31ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[Tasks] ====== Starting task fetch =====
[Tasks] User details: { id: 210, company_id: 169, email: 'e.vancnavarr.o@gmail.com' }
[Tasks] KYB tasks found: { count: 1 }
[Tasks] Query conditions: {
  conditions: {
    condition1: 'tasks.assigned_to = 210',
    condition2: 'tasks.created_by = 210',
    condition3: "tasks.company_id = 169 AND tasks.assigned_to IS NULL AND tasks.task_scope = 'company'",
    condition4: "tasks.task_type = 'user_onboarding' AND LOWER(tasks.user_email) = LOWER('e.vancnavarr.o@gmail.com')"
  }
}
[Tasks] Tasks found: { count: 4 }
8:14:30 PM [info] GET /api/tasks 304 in 98ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:14:36 PM [info] GET /api/tasks 304 in 36ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[WebSocket] Received pong
[WebSocket] Received pong
[WebSocket] Received message: {
  type: 'pong',
  payload: { timestamp: '2025-04-15T20:14:40.872Z' },
  connectionId: 'ws-1'
}
8:14:41 PM [info] GET /api/tasks 304 in 32ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[WebSocket] Received pong
[WebSocket] Received pong
[WebSocket] Received message: {
  type: 'pong',
  payload: { timestamp: '2025-04-15T20:14:45.960Z' },
  connectionId: 'ws-1'
}
8:14:46 PM [info] GET /api/tasks 304 in 30ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:14:51 PM [info] GET /api/tasks 304 in 31ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[Tasks] Using cached task data for user: 210
8:14:56 PM [info] GET /api/tasks 304 in 31ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[Tasks] ====== Starting task fetch =====
[Tasks] User details: { id: 210, company_id: 169, email: 'e.vancnavarr.o@gmail.com' }
[Tasks] KYB tasks found: { count: 1 }
[Tasks] Query conditions: {
  conditions: {
    condition1: 'tasks.assigned_to = 210',
    condition2: 'tasks.created_by = 210',
    condition3: "tasks.company_id = 169 AND tasks.assigned_to IS NULL AND tasks.task_scope = 'company'",
    condition4: "tasks.task_type = 'user_onboarding' AND LOWER(tasks.user_email) = LOWER('e.vancnavarr.o@gmail.com')"
  }
}
[Tasks] Tasks found: { count: 4 }
8:15:02 PM [info] GET /api/tasks 304 in 90ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:15:07 PM [info] GET /api/tasks 304 in 32ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[Tasks] Using cached task data for user: 210
8:15:12 PM [info] GET /api/tasks 304 in 31ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[Tasks] Using cached task data for user: 210
8:15:17 PM [info] GET /api/tasks 304 in 31ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:15:22 PM [info] GET /api/tasks 304 in 31ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[WebSocket] Received pong
[WebSocket] Received pong
[WebSocket] Received message: {
  type: 'pong',
  payload: { timestamp: '2025-04-15T20:15:25.875Z' },
  connectionId: 'ws-1'
}
8:15:28 PM [info] GET /api/tasks 304 in 31ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[WebSocket] Received pong
[WebSocket] Received pong
[WebSocket] Received message: {
  type: 'pong',
  payload: { timestamp: '2025-04-15T20:15:31.018Z' },
  connectionId: 'ws-1'
}
[Tasks] ====== Starting task fetch =====
[Tasks] User details: { id: 210, company_id: 169, email: 'e.vancnavarr.o@gmail.com' }
[Tasks] KYB tasks found: { count: 1 }
[Tasks] Query conditions: {
  conditions: {
    condition1: 'tasks.assigned_to = 210',
    condition2: 'tasks.created_by = 210',
    condition3: "tasks.company_id = 169 AND tasks.assigned_to IS NULL AND tasks.task_scope = 'company'",
    condition4: "tasks.task_type = 'user_onboarding' AND LOWER(tasks.user_email) = LOWER('e.vancnavarr.o@gmail.com')"
  }
}
[Tasks] Tasks found: { count: 4 }
8:15:33 PM [info] GET /api/tasks 304 in 96ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:15:38 PM [info] GET /api/tasks 304 in 31ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:15:43 PM [info] GET /api/tasks 304 in 31ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:15:48 PM [info] GET /api/tasks 304 in 36ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[Tasks] Using cached task data for user: 210
8:15:54 PM [info] GET /api/tasks 304 in 34ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[Auth] Using cached user data: 210
8:15:59 PM [info] GET /api/tasks 304 in 31ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[Tasks] ====== Starting task fetch =====
[Tasks] User details: { id: 210, company_id: 169, email: 'e.vancnavarr.o@gmail.com' }
[Tasks] KYB tasks found: { count: 1 }
[Tasks] Query conditions: {
  conditions: {
    condition1: 'tasks.assigned_to = 210',
    condition2: 'tasks.created_by = 210',
    condition3: "tasks.company_id = 169 AND tasks.assigned_to IS NULL AND tasks.task_scope = 'company'",
    condition4: "tasks.task_type = 'user_onboarding' AND LOWER(tasks.user_email) = LOWER('e.vancnavarr.o@gmail.com')"
  }
}
[Tasks] Tasks found: { count: 4 }
8:16:04 PM [info] GET /api/tasks 304 in 90ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:16:09 PM [info] GET /api/tasks 304 in 30ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[WebSocket] Received pong
[WebSocket] Received pong
[WebSocket] Received message: {
  type: 'pong',
  payload: { timestamp: '2025-04-15T20:16:10.876Z' },
  connectionId: 'ws-1'
}
8:16:14 PM [info] GET /api/tasks 304 in 30ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[WebSocket] Received pong
[WebSocket] Received pong
[WebSocket] Received message: {
  type: 'pong',
  payload: { timestamp: '2025-04-15T20:16:15.969Z' },
  connectionId: 'ws-1'
}
8:16:20 PM [info] GET /api/tasks 304 in 32ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:16:25 PM [info] GET /api/tasks 304 in 31ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[Tasks] Using cached task data for user: 210
8:16:30 PM [info] GET /api/tasks 304 in 34ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[Tasks] ====== Starting task fetch =====
[Tasks] User details: { id: 210, company_id: 169, email: 'e.vancnavarr.o@gmail.com' }
[Tasks] KYB tasks found: { count: 1 }
[Tasks] Query conditions: {
  conditions: {
    condition1: 'tasks.assigned_to = 210',
    condition2: 'tasks.created_by = 210',
    condition3: "tasks.company_id = 169 AND tasks.assigned_to IS NULL AND tasks.task_scope = 'company'",
    condition4: "tasks.task_type = 'user_onboarding' AND LOWER(tasks.user_email) = LOWER('e.vancnavarr.o@gmail.com')"
  }
}
[Tasks] Tasks found: { count: 4 }
8:16:35 PM [info] GET /api/tasks 304 in 96ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:16:40 PM [info] GET /api/tasks 304 in 36ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:16:46 PM [info] GET /api/tasks 304 in 31ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:16:51 PM [info] GET /api/tasks 304 in 31ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[WebSocket] Received pong
[WebSocket] Received pong
[WebSocket] Received message: {
  type: 'pong',
  payload: { timestamp: '2025-04-15T20:16:55.905Z' },
  connectionId: 'ws-1'
}
8:16:56 PM [info] GET /api/tasks 304 in 30ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[WebSocket] Received pong
[WebSocket] Received pong
[WebSocket] Received message: {
  type: 'pong',
  payload: { timestamp: '2025-04-15T20:17:01.025Z' },
  connectionId: 'ws-1'
}
8:17:01 PM [info] GET /api/tasks 304 in 31ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[Tasks] ====== Starting task fetch =====
[Tasks] User details: { id: 210, company_id: 169, email: 'e.vancnavarr.o@gmail.com' }
[Tasks] KYB tasks found: { count: 1 }
[Tasks] Query conditions: {
  conditions: {
    condition1: 'tasks.assigned_to = 210',
    condition2: 'tasks.created_by = 210',
    condition3: "tasks.company_id = 169 AND tasks.assigned_to IS NULL AND tasks.task_scope = 'company'",
    condition4: "tasks.task_type = 'user_onboarding' AND LOWER(tasks.user_email) = LOWER('e.vancnavarr.o@gmail.com')"
  }
}
[Tasks] Tasks found: { count: 4 }
8:17:07 PM [info] GET /api/tasks 304 in 88ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[Tasks] Using cached task data for user: 210
8:17:12 PM [info] GET /api/tasks 304 in 31ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:17:17 PM [info] GET /api/tasks 304 in 31ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[Auth] Deserializing user: 210
8:17:22 PM [info] GET /api/tasks 304 in 37ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[Current Company] Fetching company for user: { userId: 210, companyId: 169 }
[Current Company] Found company: {
  id: 169,
  name: 'DevelopmentTesting',
  onboardingCompleted: false,
  riskScore: null
}
8:17:26 PM [info] GET /api/companies/current 304 in 60ms :: {"id":169,"name":"DevelopmentTesting","description":"FinTech partner company ...
8:17:27 PM [info] GET /api/tasks 304 in 30ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:17:30 PM [info] GET /api/companies/current 304 in 31ms :: {"id":169,"name":"DevelopmentTesting","description":"FinTech partner company ...
8:17:33 PM [info] GET /api/tasks 304 in 31ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[Tasks] ====== Starting task fetch =====
[Tasks] User details: { id: 210, company_id: 169, email: 'e.vancnavarr.o@gmail.com' }
[Tasks] KYB tasks found: { count: 1 }
[Tasks] Query conditions: {
  conditions: {
    condition1: 'tasks.assigned_to = 210',
    condition2: 'tasks.created_by = 210',
    condition3: "tasks.company_id = 169 AND tasks.assigned_to IS NULL AND tasks.task_scope = 'company'",
    condition4: "tasks.task_type = 'user_onboarding' AND LOWER(tasks.user_email) = LOWER('e.vancnavarr.o@gmail.com')"
  }
}
[Tasks] Tasks found: { count: 4 }
8:17:38 PM [info] GET /api/tasks 304 in 89ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[WebSocket] Received pong
[WebSocket] Received pong
[WebSocket] Received message: {
  type: 'pong',
  payload: { timestamp: '2025-04-15T20:17:40.878Z' },
  connectionId: 'ws-1'
}
8:17:43 PM [info] GET /api/tasks 304 in 31ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[WebSocket] Received pong
[WebSocket] Received pong
[WebSocket] Received message: {
  type: 'pong',
  payload: { timestamp: '2025-04-15T20:17:45.977Z' },
  connectionId: 'ws-1'
}
8:17:48 PM [info] GET /api/tasks 304 in 31ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[Auth] Using cached user data: 210
8:17:53 PM [info] GET /api/tasks 304 in 31ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:17:59 PM [info] GET /api/tasks 304 in 31ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:18:04 PM [info] GET /api/tasks 304 in 31ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[Tasks] ====== Starting task fetch =====
[Tasks] User details: { id: 210, company_id: 169, email: 'e.vancnavarr.o@gmail.com' }
[Tasks] KYB tasks found: { count: 1 }
[Tasks] Query conditions: {
  conditions: {
    condition1: 'tasks.assigned_to = 210',
    condition2: 'tasks.created_by = 210',
    condition3: "tasks.company_id = 169 AND tasks.assigned_to IS NULL AND tasks.task_scope = 'company'",
    condition4: "tasks.task_type = 'user_onboarding' AND LOWER(tasks.user_email) = LOWER('e.vancnavarr.o@gmail.com')"
  }
}
[Tasks] Tasks found: { count: 4 }
8:18:09 PM [info] GET /api/tasks 304 in 93ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[Tasks] Using cached task data for user: 210
8:18:14 PM [info] GET /api/tasks 304 in 31ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:18:19 PM [info] GET /api/tasks 304 in 30ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:18:25 PM [info] GET /api/tasks 304 in 31ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[WebSocket] Received pong
[WebSocket] Received pong
[WebSocket] Received message: {
  type: 'pong',
  payload: { timestamp: '2025-04-15T20:18:25.879Z' },
  connectionId: 'ws-1'
}
8:18:30 PM [info] GET /api/tasks 304 in 46ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[WebSocket] Received pong
[WebSocket] Received pong
[WebSocket] Received message: {
  type: 'pong',
  payload: { timestamp: '2025-04-15T20:18:30.956Z' },
  connectionId: 'ws-1'
}
8:18:35 PM [info] GET /api/tasks 304 in 31ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[Tasks] ====== Starting task fetch =====
[Tasks] User details: { id: 210, company_id: 169, email: 'e.vancnavarr.o@gmail.com' }
[Tasks] KYB tasks found: { count: 1 }
[Tasks] Query conditions: {
  conditions: {
    condition1: 'tasks.assigned_to = 210',
    condition2: 'tasks.created_by = 210',
    condition3: "tasks.company_id = 169 AND tasks.assigned_to IS NULL AND tasks.task_scope = 'company'",
    condition4: "tasks.task_type = 'user_onboarding' AND LOWER(tasks.user_email) = LOWER('e.vancnavarr.o@gmail.com')"
  }
}
[Tasks] Tasks found: { count: 4 }
8:18:40 PM [info] GET /api/tasks 304 in 92ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:18:45 PM [info] GET /api/tasks 304 in 31ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:18:51 PM [info] GET /api/tasks 304 in 31ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:18:56 PM [info] GET /api/tasks 304 in 30ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:19:01 PM [info] GET /api/tasks 304 in 31ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[Tasks] Using cached task data for user: 210
8:19:06 PM [info] GET /api/tasks 304 in 31ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[WebSocket] Received pong
[WebSocket] Received pong
[WebSocket] Received message: {
  type: 'pong',
  payload: { timestamp: '2025-04-15T20:19:10.875Z' },
  connectionId: 'ws-1'
}
[Tasks] ====== Starting task fetch =====
[Tasks] User details: { id: 210, company_id: 169, email: 'e.vancnavarr.o@gmail.com' }
[Tasks] KYB tasks found: { count: 1 }
[Tasks] Query conditions: {
  conditions: {
    condition1: 'tasks.assigned_to = 210',
    condition2: 'tasks.created_by = 210',
    condition3: "tasks.company_id = 169 AND tasks.assigned_to IS NULL AND tasks.task_scope = 'company'",
    condition4: "tasks.task_type = 'user_onboarding' AND LOWER(tasks.user_email) = LOWER('e.vancnavarr.o@gmail.com')"
  }
}
[Tasks] Tasks found: { count: 4 }
8:19:12 PM [info] GET /api/tasks 304 in 93ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[WebSocket] Received pong
[WebSocket] Received pong
[WebSocket] Received message: {
  type: 'pong',
  payload: { timestamp: '2025-04-15T20:19:15.958Z' },
  connectionId: 'ws-1'
}
8:19:17 PM [info] GET /api/tasks 304 in 31ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:19:22 PM [info] GET /api/tasks 304 in 40ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:19:27 PM [info] GET /api/tasks 304 in 31ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:19:32 PM [info] GET /api/tasks 304 in 34ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:19:38 PM [info] GET /api/tasks 304 in 32ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[Tasks] ====== Starting task fetch =====
[Tasks] User details: { id: 210, company_id: 169, email: 'e.vancnavarr.o@gmail.com' }
[Tasks] KYB tasks found: { count: 1 }
[Tasks] Query conditions: {
  conditions: {
    condition1: 'tasks.assigned_to = 210',
    condition2: 'tasks.created_by = 210',
    condition3: "tasks.company_id = 169 AND tasks.assigned_to IS NULL AND tasks.task_scope = 'company'",
    condition4: "tasks.task_type = 'user_onboarding' AND LOWER(tasks.user_email) = LOWER('e.vancnavarr.o@gmail.com')"
  }
}
[Tasks] Tasks found: { count: 4 }
8:19:43 PM [info] GET /api/tasks 304 in 117ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:19:48 PM [info] GET /api/tasks 304 in 32ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:19:53 PM [info] GET /api/tasks 304 in 30ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[WebSocket] Received pong
[WebSocket] Received pong
[WebSocket] Received message: {
  type: 'pong',
  payload: { timestamp: '2025-04-15T20:19:55.905Z' },
  connectionId: 'ws-1'
}
8:19:59 PM [info] GET /api/tasks 304 in 33ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[WebSocket] Received pong
[WebSocket] Received pong
[WebSocket] Received message: {
  type: 'pong',
  payload: { timestamp: '2025-04-15T20:20:00.957Z' },
  connectionId: 'ws-1'
}
8:20:04 PM [info] GET /api/tasks 304 in 33ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:20:09 PM [info] GET /api/tasks 304 in 31ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[Tasks] ====== Starting task fetch =====
[Tasks] User details: { id: 210, company_id: 169, email: 'e.vancnavarr.o@gmail.com' }
[Tasks] KYB tasks found: { count: 1 }
[Tasks] Query conditions: {
  conditions: {
    condition1: 'tasks.assigned_to = 210',
    condition2: 'tasks.created_by = 210',
    condition3: "tasks.company_id = 169 AND tasks.assigned_to IS NULL AND tasks.task_scope = 'company'",
    condition4: "tasks.task_type = 'user_onboarding' AND LOWER(tasks.user_email) = LOWER('e.vancnavarr.o@gmail.com')"
  }
}
[Tasks] Tasks found: { count: 4 }
8:20:14 PM [info] GET /api/tasks 304 in 98ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:20:19 PM [info] GET /api/tasks 304 in 32ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:20:25 PM [info] GET /api/tasks 304 in 32ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:20:30 PM [info] GET /api/tasks 304 in 31ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:20:35 PM [info] GET /api/tasks 304 in 32ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[WebSocket] Received pong
[Auth] Using cached user data: 210
8:20:40 PM [info] GET /api/tasks 304 in 29ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[WebSocket] Received pong
[WebSocket] Received message: {
  type: 'pong',
  payload: { timestamp: '2025-04-15T20:20:40.973Z' },
  connectionId: 'ws-1'
}
[WebSocket] Received pong
[Tasks] ====== Starting task fetch =====
[Tasks] User details: { id: 210, company_id: 169, email: 'e.vancnavarr.o@gmail.com' }
[Tasks] KYB tasks found: { count: 1 }
[Tasks] Query conditions: {
  conditions: {
    condition1: 'tasks.assigned_to = 210',
    condition2: 'tasks.created_by = 210',
    condition3: "tasks.company_id = 169 AND tasks.assigned_to IS NULL AND tasks.task_scope = 'company'",
    condition4: "tasks.task_type = 'user_onboarding' AND LOWER(tasks.user_email) = LOWER('e.vancnavarr.o@gmail.com')"
  }
}
[Tasks] Tasks found: { count: 4 }
8:20:45 PM [info] GET /api/tasks 304 in 90ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[WebSocket] Received pong
[WebSocket] Received message: {
  type: 'pong',
  payload: { timestamp: '2025-04-15T20:20:45.956Z' },
  connectionId: 'ws-1'
}
[Tasks] Using cached task data for user: 210
8:20:51 PM [info] GET /api/tasks 304 in 33ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:20:56 PM [info] GET /api/tasks 304 in 31ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:21:01 PM [info] GET /api/tasks 304 in 32ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:21:06 PM [info] GET /api/tasks 304 in 30ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:21:11 PM [info] GET /api/tasks 304 in 31ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[Tasks] ====== Starting task fetch =====
[Tasks] User details: { id: 210, company_id: 169, email: 'e.vancnavarr.o@gmail.com' }
[Tasks] KYB tasks found: { count: 1 }
[Tasks] Query conditions: {
  conditions: {
    condition1: 'tasks.assigned_to = 210',
    condition2: 'tasks.created_by = 210',
    condition3: "tasks.company_id = 169 AND tasks.assigned_to IS NULL AND tasks.task_scope = 'company'",
    condition4: "tasks.task_type = 'user_onboarding' AND LOWER(tasks.user_email) = LOWER('e.vancnavarr.o@gmail.com')"
  }
}
[Tasks] Tasks found: { count: 4 }
8:21:17 PM [info] GET /api/tasks 304 in 96ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:21:22 PM [info] GET /api/tasks 304 in 31ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[WebSocket] Received pong
[WebSocket] Received pong
[WebSocket] Received message: {
  type: 'pong',
  payload: { timestamp: '2025-04-15T20:21:25.880Z' },
  connectionId: 'ws-1'
}
8:21:27 PM [info] GET /api/tasks 304 in 34ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[WebSocket] Received pong
[WebSocket] Received pong
[WebSocket] Received message: {
  type: 'pong',
  payload: { timestamp: '2025-04-15T20:21:31.055Z' },
  connectionId: 'ws-1'
}
8:21:32 PM [info] GET /api/tasks 304 in 30ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[Auth] Using cached user data: 210
8:21:37 PM [info] GET /api/tasks 304 in 32ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:21:43 PM [info] GET /api/tasks 304 in 31ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[Tasks] ====== Starting task fetch =====
[Tasks] User details: { id: 210, company_id: 169, email: 'e.vancnavarr.o@gmail.com' }
[Tasks] KYB tasks found: { count: 1 }
[Tasks] Query conditions: {
  conditions: {
    condition1: 'tasks.assigned_to = 210',
    condition2: 'tasks.created_by = 210',
    condition3: "tasks.company_id = 169 AND tasks.assigned_to IS NULL AND tasks.task_scope = 'company'",
    condition4: "tasks.task_type = 'user_onboarding' AND LOWER(tasks.user_email) = LOWER('e.vancnavarr.o@gmail.com')"
  }
}
[Tasks] Tasks found: { count: 4 }
8:21:48 PM [info] GET /api/tasks 304 in 89ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:21:53 PM [info] GET /api/tasks 304 in 31ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:21:58 PM [info] GET /api/tasks 304 in 30ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:22:04 PM [info] GET /api/tasks 304 in 31ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:22:09 PM [info] GET /api/tasks 304 in 31ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[WebSocket] Received pong
[WebSocket] Received pong
[WebSocket] Received message: {
  type: 'pong',
  payload: { timestamp: '2025-04-15T20:22:10.889Z' },
  connectionId: 'ws-1'
}
8:22:14 PM [info] GET /api/tasks 304 in 31ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[WebSocket] Received pong
[WebSocket] Received pong
[WebSocket] Received message: {
  type: 'pong',
  payload: { timestamp: '2025-04-15T20:22:16.009Z' },
  connectionId: 'ws-1'
}
[Tasks] ====== Starting task fetch =====
[Tasks] User details: { id: 210, company_id: 169, email: 'e.vancnavarr.o@gmail.com' }
[Tasks] KYB tasks found: { count: 1 }
[Tasks] Query conditions: {
  conditions: {
    condition1: 'tasks.assigned_to = 210',
    condition2: 'tasks.created_by = 210',
    condition3: "tasks.company_id = 169 AND tasks.assigned_to IS NULL AND tasks.task_scope = 'company'",
    condition4: "tasks.task_type = 'user_onboarding' AND LOWER(tasks.user_email) = LOWER('e.vancnavarr.o@gmail.com')"
  }
}
[Tasks] Tasks found: { count: 4 }
8:22:19 PM [info] GET /api/tasks 304 in 97ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[Auth] Deserializing user: 210
8:22:24 PM [info] GET /api/tasks 304 in 31ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[Current Company] Fetching company for user: { userId: 210, companyId: 169 }
[Current Company] Found company: {
  id: 169,
  name: 'DevelopmentTesting',
  onboardingCompleted: false,
  riskScore: null
}
8:22:26 PM [info] GET /api/companies/current 304 in 60ms :: {"id":169,"name":"DevelopmentTesting","description":"FinTech partner company ...
8:22:30 PM [info] GET /api/tasks 304 in 31ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[Tasks] Using cached task data for user: 210
8:22:30 PM [info] GET /api/tasks 304 in 32ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:22:30 PM [info] GET /api/companies/current 304 in 31ms :: {"id":169,"name":"DevelopmentTesting","description":"FinTech partner company ...
8:22:35 PM [info] GET /api/tasks 304 in 31ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:22:40 PM [info] GET /api/tasks 304 in 31ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:22:45 PM [info] GET /api/tasks 304 in 31ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[Tasks] ====== Starting task fetch =====
[Tasks] User details: { id: 210, company_id: 169, email: 'e.vancnavarr.o@gmail.com' }
[Tasks] KYB tasks found: { count: 1 }
[Tasks] Query conditions: {
  conditions: {
    condition1: 'tasks.assigned_to = 210',
    condition2: 'tasks.created_by = 210',
    condition3: "tasks.company_id = 169 AND tasks.assigned_to IS NULL AND tasks.task_scope = 'company'",
    condition4: "tasks.task_type = 'user_onboarding' AND LOWER(tasks.user_email) = LOWER('e.vancnavarr.o@gmail.com')"
  }
}
[Tasks] Tasks found: { count: 4 }
8:22:50 PM [info] GET /api/tasks 304 in 90ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[WebSocket] Received pong
[WebSocket] Received pong
[WebSocket] Received message: {
  type: 'pong',
  payload: { timestamp: '2025-04-15T20:22:55.903Z' },
  connectionId: 'ws-1'
}
8:22:56 PM [info] GET /api/tasks 304 in 31ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[WebSocket] Received pong
[WebSocket] Received pong
[WebSocket] Received message: {
  type: 'pong',
  payload: { timestamp: '2025-04-15T20:23:01.065Z' },
  connectionId: 'ws-1'
}
8:23:01 PM [info] GET /api/tasks 304 in 31ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[Tasks] Using cached task data for user: 210
8:23:06 PM [info] GET /api/tasks 304 in 31ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:23:11 PM [info] GET /api/tasks 304 in 31ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:23:17 PM [info] GET /api/tasks 304 in 30ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[Tasks] ====== Starting task fetch =====
[Tasks] User details: { id: 210, company_id: 169, email: 'e.vancnavarr.o@gmail.com' }
[Tasks] KYB tasks found: { count: 1 }
[Tasks] Query conditions: {
  conditions: {
    condition1: 'tasks.assigned_to = 210',
    condition2: 'tasks.created_by = 210',
    condition3: "tasks.company_id = 169 AND tasks.assigned_to IS NULL AND tasks.task_scope = 'company'",
    condition4: "tasks.task_type = 'user_onboarding' AND LOWER(tasks.user_email) = LOWER('e.vancnavarr.o@gmail.com')"
  }
}
[Tasks] Tasks found: { count: 4 }
8:23:22 PM [info] GET /api/tasks 304 in 90ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:23:27 PM [info] GET /api/tasks 304 in 31ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:23:32 PM [info] GET /api/tasks 304 in 30ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:23:38 PM [info] GET /api/tasks 304 in 38ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[WebSocket] Received pong
[WebSocket] Received pong
[WebSocket] Received message: {
  type: 'pong',
  payload: { timestamp: '2025-04-15T20:23:40.876Z' },
  connectionId: 'ws-1'
}
[Auth] Using cached user data: 210
8:23:43 PM [info] GET /api/tasks 304 in 31ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[WebSocket] Received pong
[WebSocket] Received pong
[WebSocket] Received message: {
  type: 'pong',
  payload: { timestamp: '2025-04-15T20:23:45.956Z' },
  connectionId: 'ws-1'
}
8:23:48 PM [info] GET /api/tasks 304 in 31ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[Tasks] ====== Starting task fetch =====
[Tasks] User details: { id: 210, company_id: 169, email: 'e.vancnavarr.o@gmail.com' }
[Tasks] KYB tasks found: { count: 1 }
[Tasks] Query conditions: {
  conditions: {
    condition1: 'tasks.assigned_to = 210',
    condition2: 'tasks.created_by = 210',
    condition3: "tasks.company_id = 169 AND tasks.assigned_to IS NULL AND tasks.task_scope = 'company'",
    condition4: "tasks.task_type = 'user_onboarding' AND LOWER(tasks.user_email) = LOWER('e.vancnavarr.o@gmail.com')"
  }
}
[Tasks] Tasks found: { count: 4 }
8:23:53 PM [info] GET /api/tasks 304 in 99ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[Auth] Using cached user data: 210
8:23:58 PM [info] GET /api/tasks 304 in 34ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:24:04 PM [info] GET /api/tasks 304 in 31ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[Tasks] Using cached task data for user: 210
8:24:09 PM [info] GET /api/tasks 304 in 35ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:24:14 PM [info] GET /api/tasks 304 in 31ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:24:19 PM [info] GET /api/tasks 304 in 30ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[Tasks] ====== Starting task fetch =====
[Tasks] User details: { id: 210, company_id: 169, email: 'e.vancnavarr.o@gmail.com' }
[Tasks] KYB tasks found: { count: 1 }
[Tasks] Query conditions: {
  conditions: {
    condition1: 'tasks.assigned_to = 210',
    condition2: 'tasks.created_by = 210',
    condition3: "tasks.company_id = 169 AND tasks.assigned_to IS NULL AND tasks.task_scope = 'company'",
    condition4: "tasks.task_type = 'user_onboarding' AND LOWER(tasks.user_email) = LOWER('e.vancnavarr.o@gmail.com')"
  }
}
[Tasks] Tasks found: { count: 4 }
8:24:24 PM [info] GET /api/tasks 304 in 90ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[WebSocket] Received pong
[WebSocket] Received pong
[WebSocket] Received message: {
  type: 'pong',
  payload: { timestamp: '2025-04-15T20:24:25.879Z' },
  connectionId: 'ws-1'
}
8:24:30 PM [info] GET /api/tasks 304 in 35ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[WebSocket] Received pong
[WebSocket] Received pong
[WebSocket] Received message: {
  type: 'pong',
  payload: { timestamp: '2025-04-15T20:24:30.973Z' },
  connectionId: 'ws-1'
}
8:24:35 PM [info] GET /api/tasks 304 in 31ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:24:40 PM [info] GET /api/tasks 304 in 30ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:24:45 PM [info] GET /api/tasks 304 in 32ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:24:50 PM [info] GET /api/tasks 304 in 31ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[Tasks] ====== Starting task fetch =====
[Tasks] User details: { id: 210, company_id: 169, email: 'e.vancnavarr.o@gmail.com' }
[Tasks] KYB tasks found: { count: 1 }
[Tasks] Query conditions: {
  conditions: {
    condition1: 'tasks.assigned_to = 210',
    condition2: 'tasks.created_by = 210',
    condition3: "tasks.company_id = 169 AND tasks.assigned_to IS NULL AND tasks.task_scope = 'company'",
    condition4: "tasks.task_type = 'user_onboarding' AND LOWER(tasks.user_email) = LOWER('e.vancnavarr.o@gmail.com')"
  }
}
[Tasks] Tasks found: { count: 4 }
8:24:56 PM [info] GET /api/tasks 304 in 94ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:25:01 PM [info] GET /api/tasks 304 in 31ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:25:06 PM [info] GET /api/tasks 304 in 30ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[WebSocket] Received pong
[WebSocket] Received pong
[WebSocket] Received message: {
  type: 'pong',
  payload: { timestamp: '2025-04-15T20:25:10.880Z' },
  connectionId: 'ws-1'
}
[Tasks] Using cached task data for user: 210
8:25:11 PM [info] GET /api/tasks 304 in 31ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[WebSocket] Received pong
[WebSocket] Received pong
[WebSocket] Received message: {
  type: 'pong',
  payload: { timestamp: '2025-04-15T20:25:16.030Z' },
  connectionId: 'ws-1'
}
8:25:16 PM [info] GET /api/tasks 304 in 31ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:25:22 PM [info] GET /api/tasks 304 in 30ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[Tasks] ====== Starting task fetch =====
[Tasks] User details: { id: 210, company_id: 169, email: 'e.vancnavarr.o@gmail.com' }
[Tasks] KYB tasks found: { count: 1 }
[Tasks] Query conditions: {
  conditions: {
    condition1: 'tasks.assigned_to = 210',
    condition2: 'tasks.created_by = 210',
    condition3: "tasks.company_id = 169 AND tasks.assigned_to IS NULL AND tasks.task_scope = 'company'",
    condition4: "tasks.task_type = 'user_onboarding' AND LOWER(tasks.user_email) = LOWER('e.vancnavarr.o@gmail.com')"
  }
}
[Tasks] Tasks found: { count: 4 }
8:25:27 PM [info] GET /api/tasks 304 in 91ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:25:32 PM [info] GET /api/tasks 304 in 32ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:25:37 PM [info] GET /api/tasks 304 in 31ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:25:43 PM [info] GET /api/tasks 304 in 31ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
8:25:48 PM [info] GET /api/tasks 304 in 30ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[Auth] Using cached user data: 210
8:25:49 PM [info] GET /api/tasks 304 in 31ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[Auth] Processing /api/auth/user request
[Auth] Request authentication state: {
  isAuthenticated: true,
  hasUser: true,
  sessionID: 'OhfH_cP-qDZlt8kxQNrOJEJfml-zZ3fl'
}
[Auth] Returning user session data: { id: 210, email: 'e.vancnavarr.o@gmail.com', company_id: 169 }
[Files] Starting file fetch request
[Files] Request parameters: {
  companyId: '169',
  userId: 210,
  query: { company_id: '169', page: '1', pageSize: '5' },
  user: {
    id: 210,
    email: 'e.vancnavarr.o@gmail.com',
    full_name: 'John Doe',
    first_name: 'John',
    last_name: 'Doe',
    password: '$2b$10$1WfQz57HicQ4mh2szQyfZev.mMO8BtK24MMvCrxZNZL9c0jlb/RHy',
    company_id: 169,
    onboarding_user_completed: true,
    created_at: 2025-04-13T14:38:35.821Z,
    updated_at: 2025-04-13T14:45:22.913Z
  }
}
[Files] Executing database query for company: 169
[Files] Query results: {
  recordCount: 5,
  totalFiles: 9,
  page: 1,
  pageSize: 5,
  firstRecord: {
    id: 682,
    name: 'kyb_form_348_2025-04-15T200727.csv',
    size: 3120,
    type: 'text/csv',
    path: '/uploads/kyb_348_1744747647654.csv',
    status: 'active',
    user_id: 8,
    company_id: 169,
    document_category: 'other',
    classification_status: 'processed',
    classification_confidence: 1,
    created_at: 2025-04-15T20:07:27.654Z,
    updated_at: 2025-04-15T20:07:27.654Z,
    upload_time: 2025-04-15T20:07:27.654Z,
    download_count: 0,
    version: 1,
    metadata: {
      fields: [Array],
      taskId: 348,
      taskType: 'kyb',
      formVersion: '1.0',
      submissionDate: '2025-04-15T20:07:27.654Z'
    }
  },
  lastRecord: {
    id: 667,
    name: 'kyb_form_348_2025-04-15T154901.csv',
    size: 2940,
    type: 'text/csv',
    path: '/uploads/kyb_348_1744732141632.csv',
    status: 'active',
    user_id: 210,
    company_id: 169,
    document_category: null,
    classification_status: 'pending',
    classification_confidence: null,
    created_at: 2025-04-15T15:49:01.632Z,
    updated_at: 2025-04-15T15:49:01.632Z,
    upload_time: 2025-04-15T15:49:01.649Z,
    download_count: 1,
    version: 1,
    metadata: {
      fields: [Array],
      taskId: 348,
      taskType: 'kyb',
      formVersion: '1.0',
      submissionDate: '2025-04-15T15:49:01.632Z'
    }
  }
}
8:25:50 PM [info] GET /api/files 200 in 132ms :: {"data":[{"id":682,"name":"kyb_form_348_2025-04-15T200727.csv","size":3120,"t...
8:25:50 PM [info] GET /api/tasks 304 in 30ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[WebSocket] Received pong
8:25:55 PM [info] GET /api/tasks 304 in 30ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[WebSocket] Received pong
[WebSocket] Received message: {
  type: 'pong',
  payload: { timestamp: '2025-04-15T20:25:55.965Z' },
  connectionId: 'ws-1'
}
[Files] Starting file fetch request
[Files] Request parameters: {
  companyId: '169',
  userId: 210,
  query: { company_id: '169', page: '1', pageSize: '5' },
  user: {
    id: 210,
    email: 'e.vancnavarr.o@gmail.com',
    full_name: 'John Doe',
    first_name: 'John',
    last_name: 'Doe',
    password: '$2b$10$1WfQz57HicQ4mh2szQyfZev.mMO8BtK24MMvCrxZNZL9c0jlb/RHy',
    company_id: 169,
    onboarding_user_completed: true,
    created_at: 2025-04-13T14:38:35.821Z,
    updated_at: 2025-04-13T14:45:22.913Z
  }
}
[Files] Executing database query for company: 169
[Files] Query results: {
  recordCount: 5,
  totalFiles: 9,
  page: 1,
  pageSize: 5,
  firstRecord: {
    id: 682,
    name: 'kyb_form_348_2025-04-15T200727.csv',
    size: 3120,
    type: 'text/csv',
    path: '/uploads/kyb_348_1744747647654.csv',
    status: 'active',
    user_id: 8,
    company_id: 169,
    document_category: 'other',
    classification_status: 'processed',
    classification_confidence: 1,
    created_at: 2025-04-15T20:07:27.654Z,
    updated_at: 2025-04-15T20:07:27.654Z,
    upload_time: 2025-04-15T20:07:27.654Z,
    download_count: 0,
    version: 1,
    metadata: {
      fields: [Array],
      taskId: 348,
      taskType: 'kyb',
      formVersion: '1.0',
      submissionDate: '2025-04-15T20:07:27.654Z'
    }
  },
  lastRecord: {
    id: 667,
    name: 'kyb_form_348_2025-04-15T154901.csv',
    size: 2940,
    type: 'text/csv',
    path: '/uploads/kyb_348_1744732141632.csv',
    status: 'active',
    user_id: 210,
    company_id: 169,
    document_category: null,
    classification_status: 'pending',
    classification_confidence: null,
    created_at: 2025-04-15T15:49:01.632Z,
    updated_at: 2025-04-15T15:49:01.632Z,
    upload_time: 2025-04-15T15:49:01.649Z,
    download_count: 1,
    version: 1,
    metadata: {
      fields: [Array],
      taskId: 348,
      taskType: 'kyb',
      formVersion: '1.0',
      submissionDate: '2025-04-15T15:49:01.632Z'
    }
  }
}
8:25:59 PM [info] GET /api/files 304 in 94ms :: {"data":[{"id":682,"name":"kyb_form_348_2025-04-15T200727.csv","size":3120,"t...
[Tasks] ====== Starting task fetch =====
[Tasks] User details: { id: 210, company_id: 169, email: 'e.vancnavarr.o@gmail.com' }
[Tasks] KYB tasks found: { count: 1 }
[Tasks] Query conditions: {
  conditions: {
    condition1: 'tasks.assigned_to = 210',
    condition2: 'tasks.created_by = 210',
    condition3: "tasks.company_id = 169 AND tasks.assigned_to IS NULL AND tasks.task_scope = 'company'",
    condition4: "tasks.task_type = 'user_onboarding' AND LOWER(tasks.user_email) = LOWER('e.vancnavarr.o@gmail.com')"
  }
}
[Tasks] Tasks found: { count: 4 }
8:25:59 PM [info] GET /api/tasks 200 in 126ms :: [{"id":347,"title":"New User Invitation: e.vancnavarr.o@gmail.com","descripti...
[WebSocket] Received pong
[Tasks Routes] Fetching task by ID (special .json endpoint): { taskId: 348, timestamp: '2025-04-15T20:26:00.922Z' }
[Tasks Routes] Task found by ID (special .json endpoint): {
  taskId: 348,
  title: '1. KYB Form: DevelopmentTesting',
  type: 'company_kyb',
  timestamp: '2025-04-15T20:26:00.951Z'
}
8:26:00 PM [info] GET /api/tasks.json/348 200 in 60ms :: {"id":348,"title":"1. KYB Form: DevelopmentTesting","description":"Complete K...
[WebSocket] Received pong
[WebSocket] Received message: {
  type: 'pong',
  payload: { timestamp: '2025-04-15T20:26:00.959Z' },
  connectionId: 'ws-1'
}
8:26:01 PM [info] GET /api/companies/current 304 in 30ms :: {"id":169,"name":"DevelopmentTesting","description":"FinTech partner company ...
Suppressing further connection logs. Pool size: 3
[Auth] Returning user session data
[Task Templates API] Fetching template for task type: company_kyb, user: 210
[Task Templates API] Found template: 1 (KYB Form) for task type: company_kyb
[Task Templates API] Retrieved 9 configuration items for template ID: 1
8:26:01 PM [info] GET /api/task-templates/by-type/company_kyb 304 in 91ms :: {"id":1,"name":"KYB Form","description":"Know Your Business form for company ...
[KYB API DIAGNOSTIC] Schema check passed: kyb_fields table exists
[KYB API DIAGNOSTIC] Field count: 30
[KYB API DIAGNOSTIC] Fields fetched successfully: {
  count: 30,
  fieldKeys: [
    'legalEntityName',
    'registrationNumber',
    'incorporationDate',
    'businessType',
    'jurisdiction',
    'registeredAddress',
    'companyPhone',
    'contactEmail',
    'directorsAndOfficers',
    'ultimateBeneficialOwners',
    'authorizedSigners',
    'governmentOwnership',
    'priorNames',
    'externalAudit',
    'controlEnvironment',
    'corporateRegistration',
    'goodStanding',
    'licenses',
    'annualRecurringRevenue',
    'monthlyRecurringRevenue',
    'marketCapitalization',
    'lifetimeCustomerValue',
    'financialStatements',
    'operationalPolicies',
    'dataVolume',
    'dataTypes',
    'sanctionsCheck',
    'dueDiligence',
    'investigationsIncidents',
    'regulatoryActions'
  ],
  groups: [
    'companyProfile',
    'governanceLeadership',
    'financialProfile',
    'operationsCompliance'
  ],
  sampleField: {
    id: 1,
    field_key: 'legalEntityName',
    display_name: 'Legal Entity Name',
    field_type: 'TEXT',
    question: 'What is the registered business name?',
    group: 'companyProfile',
    required: true,
    order: 1,
    step_index: 0,
    validation_rules: null,
    help_text: 'The official name under which your business is registered with government authorities.',
    created_at: 2025-03-05T07:32:29.195Z,
    updated_at: 2025-03-05T07:32:29.195Z
  }
}
8:26:01 PM [info] GET /api/kyb/fields 304 in 92ms :: {"fields":[{"id":1,"field_key":"legalEntityName","display_name":"Legal Entity...
[KYB API Debug] Loading progress for task: 348
[KYB Debug] Retrieved task: {
  id: 348,
  status: 'ready_for_submission',
  progress: 100,
  metadata: [
    'company_id',
    'created_at',
    'statusFlow',
    'created_via',
    'formVersion',
    'kybFormFile',
    'lastUpdated',
    'status_flow',
    'company_name',
    'created_by_id',
    'submissionDate',
    'prerequisite_for'
  ],
  timestamp: '2025-04-15T20:26:01.830Z'
}
[KYB Debug] Retrieved responses: {
  responseCount: 30,
  fields: [
    { field: 'externalAudit', status: 'complete', hasValue: true },
    {
      field: 'lifetimeCustomerValue',
      status: 'complete',
      hasValue: true
    },
    {
      field: 'financialStatements',
      status: 'complete',
      hasValue: true
    },
    {
      field: 'operationalPolicies',
      status: 'complete',
      hasValue: true
    },
    { field: 'dataVolume', status: 'complete', hasValue: true }
  ],
  timestamp: '2025-04-15T20:26:01.861Z'
}
[KYB API Debug] Retrieved task data: {
  id: 348,
  responseCount: 30,
  progress: 100,
  status: 'ready_for_submission',
  formDataKeys: [
    'externalAudit',
    'lifetimeCustomerValue',
    'financialStatements',
    'operationalPolicies',
    'dataVolume',
    'dataTypes',
    'sanctionsCheck',
    'dueDiligence',
    'investigationsIncidents',
    'regulatoryActions',
    'legalEntityName',
    'registrationNumber',
    'incorporationDate',
    'businessType',
    'jurisdiction',
    'registeredAddress',
    'companyPhone',
    'contactEmail',
    'directorsAndOfficers',
    'ultimateBeneficialOwners',
    'authorizedSigners',
    'governmentOwnership',
    'priorNames',
    'controlEnvironment',
    'corporateRegistration',
    'goodStanding',
    'licenses',
    'annualRecurringRevenue',
    'monthlyRecurringRevenue',
    'marketCapitalization'
  ],
  formData: {
    externalAudit: 'asdf',
    lifetimeCustomerValue: 'asdf',
    financialStatements: 'asdf',
    operationalPolicies: 'asdf',
    dataVolume: 'asdf',
    dataTypes: 'asdf',
    sanctionsCheck: 'asdf',
    dueDiligence: 'asdf',
    investigationsIncidents: 'asdf',
    regulatoryActions: 'asdf',
    legalEntityName: 'asdfasdf',
    registrationNumber: 'bcdefghijk',
    incorporationDate: 'ab',
    businessType: 'ff',
    jurisdiction: 'asd',
    registeredAddress: 'dd',
    companyPhone: 'ff',
    contactEmail: 'AASFD',
    directorsAndOfficers: 'asdf',
    ultimateBeneficialOwners: 'asdf',
    authorizedSigners: 'asdf',
    governmentOwnership: 'asdf',
    priorNames: 'r',
    controlEnvironment: 'asdf',
    corporateRegistration: 'asdf',
    goodStanding: 'asdf',
    licenses: 'asdf',
    annualRecurringRevenue: 'asdf',
    monthlyRecurringRevenue: 'asdf',
    marketCapitalization: 'asdf'
  }
}
8:26:01 PM [info] GET /api/kyb/progress/348 304 in 91ms :: {"formData":{"externalAudit":"asdf","lifetimeCustomerValue":"asdf","financial...
[KYB API Debug] Loading progress for task: 348
[KYB Debug] Retrieved task: {
  id: 348,
  status: 'ready_for_submission',
  progress: 100,
  metadata: [
    'company_id',
    'created_at',
    'statusFlow',
    'created_via',
    'formVersion',
    'kybFormFile',
    'lastUpdated',
    'status_flow',
    'company_name',
    'created_by_id',
    'submissionDate',
    'prerequisite_for'
  ],
  timestamp: '2025-04-15T20:26:02.070Z'
}
[KYB Debug] Retrieved responses: {
  responseCount: 30,
  fields: [
    { field: 'externalAudit', status: 'complete', hasValue: true },
    {
      field: 'lifetimeCustomerValue',
      status: 'complete',
      hasValue: true
    },
    {
      field: 'financialStatements',
      status: 'complete',
      hasValue: true
    },
    {
      field: 'operationalPolicies',
      status: 'complete',
      hasValue: true
    },
    { field: 'dataVolume', status: 'complete', hasValue: true }
  ],
  timestamp: '2025-04-15T20:26:02.099Z'
}
[KYB API Debug] Retrieved task data: {
  id: 348,
  responseCount: 30,
  progress: 100,
  status: 'ready_for_submission',
  formDataKeys: [
    'externalAudit',
    'lifetimeCustomerValue',
    'financialStatements',
    'operationalPolicies',
    'dataVolume',
    'dataTypes',
    'sanctionsCheck',
    'dueDiligence',
    'investigationsIncidents',
    'regulatoryActions',
    'legalEntityName',
    'registrationNumber',
    'incorporationDate',
    'businessType',
    'jurisdiction',
    'registeredAddress',
    'companyPhone',
    'contactEmail',
    'directorsAndOfficers',
    'ultimateBeneficialOwners',
    'authorizedSigners',
    'governmentOwnership',
    'priorNames',
    'controlEnvironment',
    'corporateRegistration',
    'goodStanding',
    'licenses',
    'annualRecurringRevenue',
    'monthlyRecurringRevenue',
    'marketCapitalization'
  ],
  formData: {
    externalAudit: 'asdf',
    lifetimeCustomerValue: 'asdf',
    financialStatements: 'asdf',
    operationalPolicies: 'asdf',
    dataVolume: 'asdf',
    dataTypes: 'asdf',
    sanctionsCheck: 'asdf',
    dueDiligence: 'asdf',
    investigationsIncidents: 'asdf',
    regulatoryActions: 'asdf',
    legalEntityName: 'asdfasdf',
    registrationNumber: 'bcdefghijk',
    incorporationDate: 'ab',
    businessType: 'ff',
    jurisdiction: 'asd',
    registeredAddress: 'dd',
    companyPhone: 'ff',
    contactEmail: 'AASFD',
    directorsAndOfficers: 'asdf',
    ultimateBeneficialOwners: 'asdf',
    authorizedSigners: 'asdf',
    governmentOwnership: 'asdf',
    priorNames: 'r',
    controlEnvironment: 'asdf',
    corporateRegistration: 'asdf',
    goodStanding: 'asdf',
    licenses: 'asdf',
    annualRecurringRevenue: 'asdf',
    monthlyRecurringRevenue: 'asdf',
    marketCapitalization: 'asdf'
  }
}
8:26:02 PM [info] GET /api/kyb/progress/348 304 in 90ms :: {"formData":{"externalAudit":"asdf","lifetimeCustomerValue":"asdf","financial...
[2025-04-15T20:26:03.882Z] [INFO] [KYB] Converting KYB fields to CSV {"fieldCount":30,"formDataKeys":31,"sampleKeys":["legalEntityName","registrationNumber","incorporationDate","businessType","jurisdiction"]}
[2025-04-15T20:26:03.883Z] [INFO] [KYB] Saved CSV file to ./uploads/kyb_348_1744748763883.csv
[2025-04-15T20:26:03.913Z] [INFO] [KYB] Starting transaction for KYB submission {"taskId":348,"userId":210}
[2025-04-15T20:26:03.913Z] [INFO] [KYB] Inserting file record with data {"fileName":"kyb_form_348_2025-04-15T202603.csv","taskId":348}
[2025-04-15T20:26:03.958Z] [INFO] [KYB] File record created in transaction {"fileId":683,"taskId":348}
[2025-04-15T20:26:03.987Z] [INFO] [KYB] Company data retrieved in transaction {"companyId":169,"availableTabs":["task-center","file-vault"]}
[2025-04-15T20:26:04.017Z] [INFO] [KYB] Task updated in transaction {"taskId":348,"status":"submitted"}
[2025-04-15T20:26:04.046Z] [INFO] [KYB] Found existing responses {"taskId":348,"count":30,"timestamp":"2025-04-15T20:26:04.046Z"}
[2025-04-15T20:26:04.076Z] [INFO] [KYB] Updated existing response for field: legalEntityName {"fieldId":1,"responseId":158}
[2025-04-15T20:26:04.106Z] [INFO] [KYB] Updated existing response for field: registrationNumber {"fieldId":2,"responseId":159}
[2025-04-15T20:26:04.135Z] [INFO] [KYB] Updated existing response for field: incorporationDate {"fieldId":3,"responseId":160}
[2025-04-15T20:26:04.164Z] [INFO] [KYB] Updated existing response for field: businessType {"fieldId":4,"responseId":161}
[2025-04-15T20:26:04.193Z] [INFO] [KYB] Updated existing response for field: jurisdiction {"fieldId":5,"responseId":162}
[2025-04-15T20:26:04.221Z] [INFO] [KYB] Updated existing response for field: registeredAddress {"fieldId":6,"responseId":163}
[2025-04-15T20:26:04.251Z] [INFO] [KYB] Updated existing response for field: companyPhone {"fieldId":7,"responseId":164}
[2025-04-15T20:26:04.279Z] [INFO] [KYB] Updated existing response for field: contactEmail {"fieldId":8,"responseId":166}
[2025-04-15T20:26:04.310Z] [INFO] [KYB] Updated existing response for field: directorsAndOfficers {"fieldId":9,"responseId":167}
[2025-04-15T20:26:04.339Z] [INFO] [KYB] Updated existing response for field: ultimateBeneficialOwners {"fieldId":10,"responseId":168}
[2025-04-15T20:26:04.367Z] [INFO] [KYB] Updated existing response for field: authorizedSigners {"fieldId":11,"responseId":169}
[2025-04-15T20:26:04.396Z] [INFO] [KYB] Updated existing response for field: governmentOwnership {"fieldId":12,"responseId":170}
[2025-04-15T20:26:04.425Z] [INFO] [KYB] Updated existing response for field: priorNames {"fieldId":13,"responseId":165}
[2025-04-15T20:26:04.454Z] [INFO] [KYB] Updated existing response for field: externalAudit {"fieldId":14,"responseId":171}
[2025-04-15T20:26:04.483Z] [INFO] [KYB] Updated existing response for field: controlEnvironment {"fieldId":15,"responseId":172}
[2025-04-15T20:26:04.511Z] [INFO] [KYB] Updated existing response for field: corporateRegistration {"fieldId":16,"responseId":173}
[2025-04-15T20:26:04.540Z] [INFO] [KYB] Updated existing response for field: goodStanding {"fieldId":17,"responseId":174}
[2025-04-15T20:26:04.569Z] [INFO] [KYB] Updated existing response for field: licenses {"fieldId":18,"responseId":175}
[2025-04-15T20:26:04.597Z] [INFO] [KYB] Updated existing response for field: annualRecurringRevenue {"fieldId":19,"responseId":176}
[2025-04-15T20:26:04.626Z] [INFO] [KYB] Updated existing response for field: monthlyRecurringRevenue {"fieldId":20,"responseId":177}
[2025-04-15T20:26:04.655Z] [INFO] [KYB] Updated existing response for field: marketCapitalization {"fieldId":21,"responseId":178}
[2025-04-15T20:26:04.683Z] [INFO] [KYB] Updated existing response for field: lifetimeCustomerValue {"fieldId":22,"responseId":179}
[2025-04-15T20:26:04.712Z] [INFO] [KYB] Updated existing response for field: financialStatements {"fieldId":23,"responseId":180}
[2025-04-15T20:26:04.742Z] [INFO] [KYB] Updated existing response for field: operationalPolicies {"fieldId":24,"responseId":181}
[2025-04-15T20:26:04.771Z] [INFO] [KYB] Updated existing response for field: dataVolume {"fieldId":25,"responseId":182}
[2025-04-15T20:26:04.800Z] [INFO] [KYB] Updated existing response for field: dataTypes {"fieldId":26,"responseId":183}
[2025-04-15T20:26:04.830Z] [INFO] [KYB] Updated existing response for field: sanctionsCheck {"fieldId":27,"responseId":184}
[2025-04-15T20:26:04.859Z] [INFO] [KYB] Updated existing response for field: dueDiligence {"fieldId":28,"responseId":185}
[2025-04-15T20:26:04.888Z] [INFO] [KYB] Updated existing response for field: investigationsIncidents {"fieldId":29,"responseId":186}
[2025-04-15T20:26:04.917Z] [INFO] [KYB] Updated existing response for field: regulatoryActions {"fieldId":30,"responseId":187}
[2025-04-15T20:26:04.917Z] [INFO] [KYB] All responses saved in transaction {"taskId":348,"responseCount":30}
[2025-04-15T20:26:04.947Z] [INFO] [KYB] KYB form complete and responses saved successfully {"taskId":348,"fileId":683,"responseCount":30,"warningCount":0}
8:26:04 PM [info] POST /api/kyb/save 200 in 1154ms :: {"success":true,"fileId":683}
[WebSocket] Received pong
[WebSocket] Received pong
[WebSocket] Received message: {
  type: 'pong',
  payload: { timestamp: '2025-04-15T20:26:40.876Z' },
  connectionId: 'ws-1'
}