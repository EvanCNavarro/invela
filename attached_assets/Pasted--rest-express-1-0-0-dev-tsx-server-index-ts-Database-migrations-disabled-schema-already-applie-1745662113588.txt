> rest-express@1.0.0 dev
> tsx server/index.ts

Database migrations disabled - schema already applied
[EmailService] Initializing email service
[EmailService] Email service initialized successfully
[OpenAI] Service initialized with API key: API key is set
[Auth] Setting up authentication...
[Auth] Authentication setup completed
[2025-04-26T09:50:15.603Z] [INFO] [OpenBankingRoutes] [OpenBankingRoutes] Setting up routes...
[Routes] Routes setup completed
[WebSocket] Server initialized on path: /ws
9:50:15 AM [info] Setting up Vite development server
9:50:15 AM [express] Server running on port 5000
New WebSocket client connected
New WebSocket client connected
[WebSocket] Received ping
[WebSocket] Received ping
[WebSocket] Received ping
[WebSocket] Received ping
[WebSocket] Received ping
[WebSocket] Received ping
[WebSocket] Received ping
[WebSocket] Received ping
[WebSocket] Received ping
[WebSocket] Received ping
[WebSocket] Received ping
[WebSocket] Received ping
[WebSocket] Received ping
[WebSocket] Received ping
[WebSocket] Received ping
WebSocket client disconnected with code 1006 and reason: 
WebSocket client disconnected with code 1006 and reason: 
New WebSocket client connected
New WebSocket client connected
[WebSocket] Received ping

> rest-express@1.0.0 dev
> tsx server/index.ts

Database migrations disabled - schema already applied
[EmailService] Initializing email service
[EmailService] Email service initialized successfully
[OpenAI] Service initialized with API key: API key is set
[Auth] Setting up authentication...
[Auth] Authentication setup completed
[2025-04-26T09:50:15.603Z] [INFO] [OpenBankingRoutes] [OpenBankingRoutes] Setting up routes...
[Routes] Routes setup completed
[WebSocket] Server initialized on path: /ws
9:50:15 AM [info] Setting up Vite development server
9:50:15 AM [express] Server running on port 5000
New WebSocket client connected
New WebSocket client connected
[WebSocket] Received ping
[WebSocket] Received ping
[WebSocket] Received ping
[WebSocket] Received ping
[WebSocket] Received ping
[WebSocket] Received ping
[WebSocket] Received ping
[WebSocket] Received ping
[WebSocket] Received ping
[WebSocket] Received ping
[WebSocket] Received ping
[WebSocket] Received ping
[WebSocket] Received ping
[WebSocket] Received ping
[WebSocket] Received ping
WebSocket client disconnected with code 1006 and reason: 
WebSocket client disconnected with code 1006 and reason: 
New WebSocket client connected
New WebSocket client connected
[WebSocket] Received ping
[2025-04-26T10:03:25.572Z] New client connected to the pool (1/3)
[WebSocket] Received ping
[Auth] Deserializing user: 288
[Current Company] Fetching company for user: { userId: 288, companyId: 246 }
[Current Company] Found company: {
  id: 246,
  name: 'DevTest35',
  onboardingCompleted: false,
  riskScore: null,
  chosenScore: null,
  isDemo: true
}
10:03:26 AM [info] GET /api/companies/current 304 in 153ms :: {"id":246,"name":"DevTest35","category":"FinTech","is_demo":true,"revenue_tie...
10:03:36 AM [info] GET /api/companies/current 304 in 39ms :: {"id":246,"name":"DevTest35","category":"FinTech","is_demo":true,"revenue_tie...
10:03:46 AM [info] GET /api/companies/current 304 in 40ms :: {"id":246,"name":"DevTest35","category":"FinTech","is_demo":true,"revenue_tie...
[WebSocket] Received ping
10:03:56 AM [info] GET /api/companies/current 304 in 31ms :: {"id":246,"name":"DevTest35","category":"FinTech","is_demo":true,"revenue_tie...
10:04:07 AM [info] GET /api/companies/current 304 in 31ms :: {"id":246,"name":"DevTest35","category":"FinTech","is_demo":true,"revenue_tie...
10:04:17 AM [info] GET /api/companies/current 304 in 31ms :: {"id":246,"name":"DevTest35","category":"FinTech","is_demo":true,"revenue_tie...
[WebSocket] Received ping
[WebSocket] Received ping
[WebSocket] Received ping
[Current Company] Fetching company for user: { userId: 288, companyId: 246 }
[Current Company] Found company: {
  id: 246,
  name: 'DevTest35',
  onboardingCompleted: false,
  riskScore: null,
  chosenScore: null,
  isDemo: true
}
10:04:55 AM [info] GET /api/companies/current 304 in 61ms :: {"id":246,"name":"DevTest35","category":"FinTech","is_demo":true,"revenue_tie...
10:05:05 AM [info] GET /api/companies/current 304 in 36ms :: {"id":246,"name":"DevTest35","category":"FinTech","is_demo":true,"revenue_tie...
10:05:16 AM [info] GET /api/companies/current 304 in 32ms :: {"id":246,"name":"DevTest35","category":"FinTech","is_demo":true,"revenue_tie...
[Tasks] ====== Starting task fetch =====
[Tasks] User details: { id: 288, company_id: 246, email: '35@e.com' }
[2025-04-26T10:05:23.733Z] [INFO] [KYBRoutes] Performing dynamic task unlocking check for company {"companyId":246,"userId":288}
[2025-04-26T10:05:23.782Z] [INFO] [KYBRoutes] No completed KYB tasks found, skipping security task unlock check {"companyId":246}
[Tasks] Automatically unlocking all tasks for company { userId: 288, companyId: 246, requestedBy: 'automatic_task_unlock' }
[2025-04-26T10:05:23.784Z] [INFO] [TaskDependencies] [TaskDependencies] Unlocking ALL tasks for company {"companyId":246}
[2025-04-26T10:05:23.816Z] [INFO] [TaskDependencies] [TaskDependencies] Found tasks to unlock {"companyId":246,"count":3,"taskIds":[654,653,655],"taskTypes":["ky3p","company_kyb","open_banking"]}
[2025-04-26T10:05:23.855Z] [INFO] [TaskDependencies] [TaskDependencies] Unlocked task {"companyId":246,"taskId":654,"taskType":"ky3p"}
[WebSocket] Broadcast "task_updated" sent to 2 clients {
  type: 'task_updated',
  dataKeys: [ 'id', 'status', 'metadata', 'timestamp' ],
  timestamp: '2025-04-26T10:05:23.855Z',
  clientCount: 2
}
[2025-04-26T10:05:23.886Z] [INFO] [TaskDependencies] [TaskDependencies] Unlocked task {"companyId":246,"taskId":653,"taskType":"company_kyb"}
[WebSocket] Broadcast "task_updated" sent to 2 clients {
  type: 'task_updated',
  dataKeys: [ 'id', 'status', 'metadata', 'timestamp' ],
  timestamp: '2025-04-26T10:05:23.886Z',
  clientCount: 2
}
[2025-04-26T10:05:23.917Z] [INFO] [TaskDependencies] [TaskDependencies] Unlocked task {"companyId":246,"taskId":655,"taskType":"open_banking"}
[WebSocket] Broadcast "task_updated" sent to 2 clients {
  type: 'task_updated',
  dataKeys: [ 'id', 'status', 'metadata', 'timestamp' ],
  timestamp: '2025-04-26T10:05:23.917Z',
  clientCount: 2
}
[2025-04-26T10:05:23.917Z] [INFO] [TaskDependencies] [TaskDependencies] Successfully unlocked all tasks {"companyId":246,"count":3}
[Tasks] Successfully unlocked all tasks for company: 246
[Tasks] KYB tasks found: { count: 1 }
[Tasks] Query conditions: {
  conditions: {
    condition1: 'tasks.assigned_to = 288',
    condition2: 'tasks.created_by = 288',
    condition3: "tasks.company_id = 246 AND tasks.assigned_to IS NULL AND tasks.task_scope = 'company'",
    condition4: "tasks.task_type = 'user_onboarding' AND LOWER(tasks.user_email) = LOWER('35@e.com')"
  }
}
[Tasks] Tasks found: { count: 4 }
10:05:24 AM [info] GET /api/tasks 200 in 283ms :: [{"id":652,"title":"New User Invitation: 35@e.com","description":"Complete us...
[WebSocket] Received ping
10:05:26 AM [info] GET /api/companies/current 304 in 32ms :: {"id":246,"name":"DevTest35","category":"FinTech","is_demo":true,"revenue_tie...
10:05:36 AM [info] GET /api/companies/current 304 in 33ms :: {"id":246,"name":"DevTest35","category":"FinTech","is_demo":true,"revenue_tie...
10:05:46 AM [info] GET /api/companies/current 304 in 31ms :: {"id":246,"name":"DevTest35","category":"FinTech","is_demo":true,"revenue_tie...
[WebSocket] Received ping
[Current Company] Fetching company for user: { userId: 288, companyId: 246 }
[Current Company] Found company: {
  id: 246,
  name: 'DevTest35',
  onboardingCompleted: false,
  riskScore: null,
  chosenScore: null,
  isDemo: true
}
10:05:56 AM [info] GET /api/companies/current 304 in 60ms :: {"id":246,"name":"DevTest35","category":"FinTech","is_demo":true,"revenue_tie...
10:06:07 AM [info] GET /api/companies/current 304 in 31ms :: {"id":246,"name":"DevTest35","category":"FinTech","is_demo":true,"revenue_tie...
10:06:17 AM [info] GET /api/companies/current 304 in 31ms :: {"id":246,"name":"DevTest35","category":"FinTech","is_demo":true,"revenue_tie...
[WebSocket] Received ping
[WebSocket] Received ping
[Current Company] Using cached company data: 246
10:06:27 AM [info] GET /api/companies/current 304 in 30ms :: {"id":246,"name":"DevTest35","category":"FinTech","is_demo":true,"revenue_tie...
10:06:37 AM [info] GET /api/companies/current 304 in 32ms :: {"id":246,"name":"DevTest35","category":"FinTech","is_demo":true,"revenue_tie...
10:06:47 AM [info] GET /api/companies/current 304 in 31ms :: {"id":246,"name":"DevTest35","category":"FinTech","is_demo":true,"revenue_tie...
[WebSocket] Received ping
[Current Company] Fetching company for user: { userId: 288, companyId: 246 }
[Current Company] Found company: {
  id: 246,
  name: 'DevTest35',
  onboardingCompleted: false,
  riskScore: null,
  chosenScore: null,
  isDemo: true
}
10:06:58 AM [info] GET /api/companies/current 304 in 61ms :: {"id":246,"name":"DevTest35","category":"FinTech","is_demo":true,"revenue_tie...
10:07:08 AM [info] GET /api/companies/current 304 in 30ms :: {"id":246,"name":"DevTest35","category":"FinTech","is_demo":true,"revenue_tie...
10:07:18 AM [info] GET /api/companies/current 304 in 30ms :: {"id":246,"name":"DevTest35","category":"FinTech","is_demo":true,"revenue_tie...
[WebSocket] Received ping
10:07:28 AM [info] GET /api/companies/current 304 in 33ms :: {"id":246,"name":"DevTest35","category":"FinTech","is_demo":true,"revenue_tie...
10:07:38 AM [info] GET /api/companies/current 304 in 29ms :: {"id":246,"name":"DevTest35","category":"FinTech","is_demo":true,"revenue_tie...
[Tasks] ====== Starting task fetch =====
[Tasks] User details: { id: 288, company_id: 246, email: '35@e.com' }
[2025-04-26T10:07:41.358Z] [INFO] [KYBRoutes] Performing dynamic task unlocking check for company {"companyId":246,"userId":288}
[2025-04-26T10:07:41.388Z] [INFO] [KYBRoutes] No completed KYB tasks found, skipping security task unlock check {"companyId":246}
[Tasks] Automatically unlocking all tasks for company { userId: 288, companyId: 246, requestedBy: 'automatic_task_unlock' }
[2025-04-26T10:07:41.389Z] [INFO] [TaskDependencies] [TaskDependencies] Unlocking ALL tasks for company {"companyId":246}
[2025-04-26T10:07:41.420Z] [INFO] [TaskDependencies] [TaskDependencies] Found tasks to unlock {"companyId":246,"count":3,"taskIds":[654,653,655],"taskTypes":["ky3p","company_kyb","open_banking"]}
[2025-04-26T10:07:41.451Z] [INFO] [TaskDependencies] [TaskDependencies] Unlocked task {"companyId":246,"taskId":654,"taskType":"ky3p"}
[WebSocket] Broadcast "task_updated" sent to 2 clients {
  type: 'task_updated',
  dataKeys: [ 'id', 'status', 'metadata', 'timestamp' ],
  timestamp: '2025-04-26T10:07:41.451Z',
  clientCount: 2
}
[2025-04-26T10:07:41.482Z] [INFO] [TaskDependencies] [TaskDependencies] Unlocked task {"companyId":246,"taskId":653,"taskType":"company_kyb"}
[WebSocket] Broadcast "task_updated" sent to 2 clients {
  type: 'task_updated',
  dataKeys: [ 'id', 'status', 'metadata', 'timestamp' ],
  timestamp: '2025-04-26T10:07:41.482Z',
  clientCount: 2
}
[2025-04-26T10:07:41.513Z] [INFO] [TaskDependencies] [TaskDependencies] Unlocked task {"companyId":246,"taskId":655,"taskType":"open_banking"}
[WebSocket] Broadcast "task_updated" sent to 2 clients {
  type: 'task_updated',
  dataKeys: [ 'id', 'status', 'metadata', 'timestamp' ],
  timestamp: '2025-04-26T10:07:41.513Z',
  clientCount: 2
}
[2025-04-26T10:07:41.514Z] [INFO] [TaskDependencies] [TaskDependencies] Successfully unlocked all tasks {"companyId":246,"count":3}
[Tasks] Successfully unlocked all tasks for company: 246
[Tasks] KYB tasks found: { count: 1 }
[Tasks] Query conditions: {
  conditions: {
    condition1: 'tasks.assigned_to = 288',
    condition2: 'tasks.created_by = 288',
    condition3: "tasks.company_id = 246 AND tasks.assigned_to IS NULL AND tasks.task_scope = 'company'",
    condition4: "tasks.task_type = 'user_onboarding' AND LOWER(tasks.user_email) = LOWER('35@e.com')"
  }
}
[Tasks] Tasks found: { count: 4 }
10:07:41 AM [info] GET /api/tasks 200 in 247ms :: [{"id":652,"title":"New User Invitation: 35@e.com","description":"Complete us...
10:07:41 AM [info] GET /api/tasks 304 in 31ms :: [{"id":652,"title":"New User Invitation: 35@e.com","description":"Complete us...
[2025-04-26T10:07:41.872Z] New client connected to the pool (2/3)
10:07:41 AM [info] GET /api/companies/current 304 in 31ms :: {"id":246,"name":"DevTest35","category":"FinTech","is_demo":true,"revenue_tie...
[Current Company] Using cached company data: 246
[Tasks Routes] Fetching task by ID (special .json endpoint): {
  taskId: 653,
  userCompanyId: 246,
  timestamp: '2025-04-26T10:07:45.121Z'
}
10:07:45 AM [info] GET /api/companies/current 304 in 31ms :: {"id":246,"name":"DevTest35","category":"FinTech","is_demo":true,"revenue_tie...
[Tasks Routes] Fetching latest KYB form data for task (special .json endpoint): 653
[Tasks Routes] Task found by ID (special .json endpoint): {
  taskId: 653,
  title: '1. KYB Form: DevTest35',
  type: 'company_kyb',
  formDataFields: 0,
  timestamp: '2025-04-26T10:07:45.233Z'
}
10:07:45 AM [info] GET /api/tasks.json/653 200 in 144ms :: {"id":653,"title":"1. KYB Form: DevTest35","description":"Complete KYB verifi...
New WebSocket client connected
[Auth] Returning user session data
[Tasks Routes] Updating task progress: { taskId: 653, timestamp: '2025-04-26T10:07:45.467Z' }
[Task Reconciliation] Found 0 responses for task 653 (type: company_kyb)
[STATUS DETERMINATION] Calculating status for task with: {
  progress: 0,
  currentStatus: 'not_started',
  hasSubmissionDate: false,
  hasSubmittedFlag: false,
  hasResponses: false,
  timestamp: '2025-04-26T10:07:45.536Z'
}
[STATUS DETERMINATION] Task has 0% progress, setting to NOT_STARTED
[Task Reconciliation] Progress calculation: {
  taskId: 653,
  currentProgress: 0,
  calculatedProgress: 0,
  currentStatus: 'not_started',
  calculatedStatus: 'not_started',
  responseCount: 0,
  completeCount: 0
}
[Task Reconciliation] Correcting task 653: {
  progressFrom: 0,
  progressTo: 0,
  statusFrom: 'not_started',
  statusTo: 'not_started',
  forceUpdate: true
}
[2025-04-26T10:07:45.538Z] New client connected to the pool (3/3)
[Progress Utils] Broadcasting task progress update: {
  taskId: 653,
  progress: 0,
  requestedStatus: 'not_started',
  finalStatus: 'not_started',
  hasSubmissionDate: false,
  hasSubmittedFlag: false,
  timestamp: '2025-04-26T10:07:45.567Z'
}
[WebSocket] Broadcast "task_updated" sent to 3 clients {
  type: 'task_updated',
  dataKeys: [ 'id', 'status', 'progress', 'metadata', 'timestamp' ],
  timestamp: '2025-04-26T10:07:45.568Z',
  clientCount: 3
}
[Task Templates API] Fetching template for task type: company_kyb, user: 288
[Tasks Routes] Task progress reconciled: {
  taskId: 653,
  progress: 0,
  status: 'not_started',
  timestamp: '2025-04-26T10:07:45.599Z'
}
10:07:45 AM [info] POST /api/tasks/653/update-progress 200 in 163ms :: {"success":true,"progress":0,"status":"not_started","taskId":653}
[Task Templates API] Found template: 1 (KYB Form) for task type: company_kyb
[Task Templates API] Retrieved 9 configuration items for template ID: 1
10:07:45 AM [info] GET /api/task-templates/by-type/company_kyb 304 in 121ms :: {"id":1,"name":"KYB Form","description":"Know Your Business form for company ...
[Tasks Routes] Fetching task by ID (special .json endpoint): {
  taskId: 653,
  userCompanyId: 246,
  timestamp: '2025-04-26T10:07:45.720Z'
}
[Tasks Routes] Fetching latest KYB form data for task (special .json endpoint): 653
[Tasks Routes] Task found by ID (special .json endpoint): {
  taskId: 653,
  title: '1. KYB Form: DevTest35',
  type: 'company_kyb',
  formDataFields: 0,
  timestamp: '2025-04-26T10:07:45.811Z'
}
10:07:45 AM [info] GET /api/tasks.json/653 200 in 122ms :: {"id":653,"title":"1. KYB Form: DevTest35","description":"Complete KYB verifi...
[Tasks Routes] Updating task progress: { taskId: 653, timestamp: '2025-04-26T10:07:45.862Z' }
[2025-04-26T10:07:45.865Z] [INFO] [KYBRoutes] Fetching KYB fields
[2025-04-26T10:07:45.897Z] [INFO] [KYBRoutes] KYB fields retrieved successfully {"fieldCount":30,"groups":["companyProfile","financialProfile","governanceLeadership","operationsCompliance"]}
[Task Reconciliation] Found 0 responses for task 653 (type: company_kyb)
[STATUS DETERMINATION] Calculating status for task with: {
  progress: 0,
  currentStatus: 'not_started',
  hasSubmissionDate: false,
  hasSubmittedFlag: false,
  hasResponses: false,
  timestamp: '2025-04-26T10:07:45.926Z'
}
[STATUS DETERMINATION] Task has 0% progress, setting to NOT_STARTED
[Task Reconciliation] Progress calculation: {
  taskId: 653,
  currentProgress: 0,
  calculatedProgress: 0,
  currentStatus: 'not_started',
  calculatedStatus: 'not_started',
  responseCount: 0,
  completeCount: 0
}
[Task Reconciliation] Correcting task 653: {
  progressFrom: 0,
  progressTo: 0,
  statusFrom: 'not_started',
  statusTo: 'not_started',
  forceUpdate: true
}
10:07:45 AM [info] GET /api/kyb/fields 304 in 62ms :: [{"id":1,"field_key":"legalEntityName","display_name":"Legal Entity Name","fi...
[Progress Utils] Broadcasting task progress update: {
  taskId: 653,
  progress: 0,
  requestedStatus: 'not_started',
  finalStatus: 'not_started',
  hasSubmissionDate: false,
  hasSubmittedFlag: false,
  timestamp: '2025-04-26T10:07:45.957Z'
}
[WebSocket] Broadcast "task_updated" sent to 3 clients {
  type: 'task_updated',
  dataKeys: [ 'id', 'status', 'progress', 'metadata', 'timestamp' ],
  timestamp: '2025-04-26T10:07:45.957Z',
  clientCount: 3
}
[Tasks Routes] Task progress reconciled: {
  taskId: 653,
  progress: 0,
  status: 'not_started',
  timestamp: '2025-04-26T10:07:45.989Z'
}
10:07:46 AM [info] POST /api/tasks/653/update-progress 200 in 157ms :: {"success":true,"progress":0,"status":"not_started","taskId":653}
[KYB API Debug] Loading progress for task: 653
[Tasks Routes] Updating task progress: { taskId: 653, timestamp: '2025-04-26T10:07:46.094Z' }
[Tasks Routes] Fetching task by ID (special .json endpoint): {
  taskId: 653,
  userCompanyId: 246,
  timestamp: '2025-04-26T10:07:46.135Z'
}
[Task Reconciliation] Found 0 responses for task 653 (type: company_kyb)
[STATUS DETERMINATION] Calculating status for task with: {
  progress: 0,
  currentStatus: 'not_started',
  hasSubmissionDate: false,
  hasSubmittedFlag: false,
  hasResponses: false,
  timestamp: '2025-04-26T10:07:46.154Z'
}
[STATUS DETERMINATION] Task has 0% progress, setting to NOT_STARTED
[Task Reconciliation] Progress calculation: {
  taskId: 653,
  currentProgress: 0,
  calculatedProgress: 0,
  currentStatus: 'not_started',
  calculatedStatus: 'not_started',
  responseCount: 0,
  completeCount: 0
}
[Task Reconciliation] No updates needed for task 653
[Task Reconciliation] Found 0 responses for task 653 (type: company_kyb)
[STATUS DETERMINATION] Calculating status for task with: {
  progress: 0,
  currentStatus: 'not_started',
  hasSubmissionDate: false,
  hasSubmittedFlag: false,
  hasResponses: false,
  timestamp: '2025-04-26T10:07:46.157Z'
}
[STATUS DETERMINATION] Task has 0% progress, setting to NOT_STARTED
[Task Reconciliation] Progress calculation: {
  taskId: 653,
  currentProgress: 0,
  calculatedProgress: 0,
  currentStatus: 'not_started',
  calculatedStatus: 'not_started',
  responseCount: 0,
  completeCount: 0
}
[Task Reconciliation] Correcting task 653: {
  progressFrom: 0,
  progressTo: 0,
  statusFrom: 'not_started',
  statusTo: 'not_started',
  forceUpdate: true
}
[Tasks Routes] Fetching latest KYB form data for task (special .json endpoint): 653
[KYB API Debug] Retrieved task: {
  taskId: 653,
  status: 'not_started',
  progress: 0,
  metadata: [
    'locked',
    'company_id',
    'created_at',
    'created_via',
    'status_flow',
    'company_name',
    'created_by_id',
    'prerequisite_for',
    'prerequisite_completed',
    'prerequisite_completed_at',
    'lastProgressReconciliation'
  ],
  timestamp: '2025-04-26T10:07:46.184Z'
}
[Progress Utils] Broadcasting task progress update: {
  taskId: 653,
  progress: 0,
  requestedStatus: 'not_started',
  finalStatus: 'not_started',
  hasSubmissionDate: false,
  hasSubmittedFlag: false,
  timestamp: '2025-04-26T10:07:46.188Z'
}
[WebSocket] Broadcast "task_updated" sent to 3 clients {
  type: 'task_updated',
  dataKeys: [ 'id', 'status', 'progress', 'metadata', 'timestamp' ],
  timestamp: '2025-04-26T10:07:46.188Z',
  clientCount: 3
}
[KYB API Debug] Retrieved responses: { responseCount: 0, fields: [], timestamp: '2025-04-26T10:07:46.214Z' }
[SERVER DEBUG] No savedFormData found in task table
[SERVER DEBUG] No KYB form file ID found in task metadata
[KYB API Debug] Retrieved task data: {
  id: 653,
  responseCount: 0,
  progress: 0,
  status: 'not_started',
  formDataKeys: []
}
===============================================
[SERVER DEBUG] PREPARING GET RESPONSE at 2025-04-26T10:07:46.214Z
[SERVER DEBUG] Task ID: 653, Found 0 fields in database
===============================================
[SERVER DEBUG] Checking field corporateRegistration in retrieved data: NOT PRESENT
[SERVER DEBUG] Checking field goodStanding in retrieved data: NOT PRESENT
[SERVER DEBUG] Checking field regulatoryActions in retrieved data: NOT PRESENT
[SERVER DEBUG] Checking field investigationsIncidents in retrieved data: NOT PRESENT
[SERVER DEBUG] No fields with value "asdf" found in GET response data
[SERVER DEBUG] Sending GET response with 0 fields, status: not_started, progress: 0%
===============================================
[Tasks Routes] Task progress reconciled: {
  taskId: 653,
  progress: 0,
  status: 'not_started',
  timestamp: '2025-04-26T10:07:46.217Z'
}
[Tasks Routes] Task found by ID (special .json endpoint): {
  taskId: 653,
  title: '1. KYB Form: DevTest35',
  type: 'company_kyb',
  formDataFields: 0,
  timestamp: '2025-04-26T10:07:46.224Z'
}
10:07:46 AM [info] GET /api/kyb/progress/653 304 in 153ms :: {"formData":{},"progress":0,"status":"not_started"}
10:07:46 AM [info] POST /api/tasks/653/update-progress 200 in 155ms :: {"success":true,"progress":0,"status":"not_started","taskId":653}
10:07:46 AM [info] GET /api/tasks.json/653 200 in 119ms :: {"id":653,"title":"1. KYB Form: DevTest35","description":"Complete KYB verifi...
[KYB API Debug] Loading progress for task: 653
[Tasks Routes] Fetching task by ID (special .json endpoint): {
  taskId: 653,
  userCompanyId: 246,
  timestamp: '2025-04-26T10:07:46.402Z'
}
[Tasks Routes] Fetching latest KYB form data for task (special .json endpoint): 653
[Task Reconciliation] Found 0 responses for task 653 (type: company_kyb)
[STATUS DETERMINATION] Calculating status for task with: {
  progress: 0,
  currentStatus: 'not_started',
  hasSubmissionDate: false,
  hasSubmittedFlag: false,
  hasResponses: false,
  timestamp: '2025-04-26T10:07:46.455Z'
}
[STATUS DETERMINATION] Task has 0% progress, setting to NOT_STARTED
[Task Reconciliation] Progress calculation: {
  taskId: 653,
  currentProgress: 0,
  calculatedProgress: 0,
  currentStatus: 'not_started',
  calculatedStatus: 'not_started',
  responseCount: 0,
  completeCount: 0
}
[Task Reconciliation] No updates needed for task 653
[KYB API Debug] Retrieved task: {
  taskId: 653,
  status: 'not_started',
  progress: 0,
  metadata: [
    'locked',
    'company_id',
    'created_at',
    'created_via',
    'status_flow',
    'company_name',
    'created_by_id',
    'prerequisite_for',
    'prerequisite_completed',
    'prerequisite_completed_at',
    'lastProgressReconciliation'
  ],
  timestamp: '2025-04-26T10:07:46.484Z'
}
[Tasks Routes] Task found by ID (special .json endpoint): {
  taskId: 653,
  title: '1. KYB Form: DevTest35',
  type: 'company_kyb',
  formDataFields: 0,
  timestamp: '2025-04-26T10:07:46.512Z'
}
[KYB API Debug] Retrieved responses: { responseCount: 0, fields: [], timestamp: '2025-04-26T10:07:46.514Z' }
[SERVER DEBUG] No savedFormData found in task table
[SERVER DEBUG] No KYB form file ID found in task metadata
[KYB API Debug] Retrieved task data: {
  id: 653,
  responseCount: 0,
  progress: 0,
  status: 'not_started',
  formDataKeys: []
}
===============================================
[SERVER DEBUG] PREPARING GET RESPONSE at 2025-04-26T10:07:46.515Z
[SERVER DEBUG] Task ID: 653, Found 0 fields in database
===============================================
[SERVER DEBUG] Checking field corporateRegistration in retrieved data: NOT PRESENT
[SERVER DEBUG] Checking field goodStanding in retrieved data: NOT PRESENT
[SERVER DEBUG] Checking field regulatoryActions in retrieved data: NOT PRESENT
[SERVER DEBUG] Checking field investigationsIncidents in retrieved data: NOT PRESENT
[SERVER DEBUG] No fields with value "asdf" found in GET response data
[SERVER DEBUG] Sending GET response with 0 fields, status: not_started, progress: 0%
===============================================
10:07:46 AM [info] GET /api/tasks.json/653 200 in 145ms :: {"id":653,"title":"1. KYB Form: DevTest35","description":"Complete KYB verifi...
10:07:46 AM [info] GET /api/kyb/progress/653 304 in 153ms :: {"formData":{},"progress":0,"status":"not_started"}
[KYB API Debug] Loading progress for task: 653
[Task Reconciliation] Found 0 responses for task 653 (type: company_kyb)
[STATUS DETERMINATION] Calculating status for task with: {
  progress: 0,
  currentStatus: 'not_started',
  hasSubmissionDate: false,
  hasSubmittedFlag: false,
  hasResponses: false,
  timestamp: '2025-04-26T10:07:46.760Z'
}
[STATUS DETERMINATION] Task has 0% progress, setting to NOT_STARTED
[Task Reconciliation] Progress calculation: {
  taskId: 653,
  currentProgress: 0,
  calculatedProgress: 0,
  currentStatus: 'not_started',
  calculatedStatus: 'not_started',
  responseCount: 0,
  completeCount: 0
}
[Task Reconciliation] No updates needed for task 653
[KYB API Debug] Retrieved task: {
  taskId: 653,
  status: 'not_started',
  progress: 0,
  metadata: [
    'locked',
    'company_id',
    'created_at',
    'created_via',
    'status_flow',
    'company_name',
    'created_by_id',
    'prerequisite_for',
    'prerequisite_completed',
    'prerequisite_completed_at',
    'lastProgressReconciliation'
  ],
  timestamp: '2025-04-26T10:07:46.790Z'
}
[KYB API Debug] Retrieved responses: { responseCount: 0, fields: [], timestamp: '2025-04-26T10:07:46.821Z' }
[SERVER DEBUG] No savedFormData found in task table
[SERVER DEBUG] No KYB form file ID found in task metadata
[KYB API Debug] Retrieved task data: {
  id: 653,
  responseCount: 0,
  progress: 0,
  status: 'not_started',
  formDataKeys: []
}
===============================================
[SERVER DEBUG] PREPARING GET RESPONSE at 2025-04-26T10:07:46.821Z
[SERVER DEBUG] Task ID: 653, Found 0 fields in database
===============================================
[SERVER DEBUG] Checking field corporateRegistration in retrieved data: NOT PRESENT
[SERVER DEBUG] Checking field goodStanding in retrieved data: NOT PRESENT
[SERVER DEBUG] Checking field regulatoryActions in retrieved data: NOT PRESENT
[SERVER DEBUG] Checking field investigationsIncidents in retrieved data: NOT PRESENT
[SERVER DEBUG] No fields with value "asdf" found in GET response data
[SERVER DEBUG] Sending GET response with 0 fields, status: not_started, progress: 0%
===============================================
10:07:46 AM [info] GET /api/kyb/progress/653 304 in 153ms :: {"formData":{},"progress":0,"status":"not_started"}
[KYB API Debug] Loading progress for task: 653
[Task Reconciliation] Found 0 responses for task 653 (type: company_kyb)
[STATUS DETERMINATION] Calculating status for task with: {
  progress: 0,
  currentStatus: 'not_started',
  hasSubmissionDate: false,
  hasSubmittedFlag: false,
  hasResponses: false,
  timestamp: '2025-04-26T10:07:47.062Z'
}
[STATUS DETERMINATION] Task has 0% progress, setting to NOT_STARTED
[Task Reconciliation] Progress calculation: {
  taskId: 653,
  currentProgress: 0,
  calculatedProgress: 0,
  currentStatus: 'not_started',
  calculatedStatus: 'not_started',
  responseCount: 0,
  completeCount: 0
}
[Task Reconciliation] No updates needed for task 653
[KYB API Debug] Retrieved task: {
  taskId: 653,
  status: 'not_started',
  progress: 0,
  metadata: [
    'locked',
    'company_id',
    'created_at',
    'created_via',
    'status_flow',
    'company_name',
    'created_by_id',
    'prerequisite_for',
    'prerequisite_completed',
    'prerequisite_completed_at',
    'lastProgressReconciliation'
  ],
  timestamp: '2025-04-26T10:07:47.092Z'
}
[KYB API Debug] Retrieved responses: { responseCount: 0, fields: [], timestamp: '2025-04-26T10:07:47.122Z' }
[SERVER DEBUG] No savedFormData found in task table
[SERVER DEBUG] No KYB form file ID found in task metadata
[KYB API Debug] Retrieved task data: {
  id: 653,
  responseCount: 0,
  progress: 0,
  status: 'not_started',
  formDataKeys: []
}
===============================================
[SERVER DEBUG] PREPARING GET RESPONSE at 2025-04-26T10:07:47.123Z
[SERVER DEBUG] Task ID: 653, Found 0 fields in database
===============================================
[SERVER DEBUG] Checking field corporateRegistration in retrieved data: NOT PRESENT
[SERVER DEBUG] Checking field goodStanding in retrieved data: NOT PRESENT
[SERVER DEBUG] Checking field regulatoryActions in retrieved data: NOT PRESENT
[SERVER DEBUG] Checking field investigationsIncidents in retrieved data: NOT PRESENT
[SERVER DEBUG] No fields with value "asdf" found in GET response data
[SERVER DEBUG] Sending GET response with 0 fields, status: not_started, progress: 0%
===============================================
10:07:47 AM [info] GET /api/kyb/progress/653 304 in 154ms :: {"formData":{},"progress":0,"status":"not_started"}
[KYB API Debug] Loading progress for task: 653
[Task Reconciliation] Found 0 responses for task 653 (type: company_kyb)
[STATUS DETERMINATION] Calculating status for task with: {
  progress: 0,
  currentStatus: 'not_started',
  hasSubmissionDate: false,
  hasSubmittedFlag: false,
  hasResponses: false,
  timestamp: '2025-04-26T10:07:47.367Z'
}
[STATUS DETERMINATION] Task has 0% progress, setting to NOT_STARTED
[Task Reconciliation] Progress calculation: {
  taskId: 653,
  currentProgress: 0,
  calculatedProgress: 0,
  currentStatus: 'not_started',
  calculatedStatus: 'not_started',
  responseCount: 0,
  completeCount: 0
}
[Task Reconciliation] No updates needed for task 653
[KYB API Debug] Retrieved task: {
  taskId: 653,
  status: 'not_started',
  progress: 0,
  metadata: [
    'locked',
    'company_id',
    'created_at',
    'created_via',
    'status_flow',
    'company_name',
    'created_by_id',
    'prerequisite_for',
    'prerequisite_completed',
    'prerequisite_completed_at',
    'lastProgressReconciliation'
  ],
  timestamp: '2025-04-26T10:07:47.397Z'
}
[KYB API Debug] Retrieved responses: { responseCount: 0, fields: [], timestamp: '2025-04-26T10:07:47.428Z' }
[SERVER DEBUG] No savedFormData found in task table
[SERVER DEBUG] No KYB form file ID found in task metadata
[KYB API Debug] Retrieved task data: {
  id: 653,
  responseCount: 0,
  progress: 0,
  status: 'not_started',
  formDataKeys: []
}
===============================================
[SERVER DEBUG] PREPARING GET RESPONSE at 2025-04-26T10:07:47.428Z
[SERVER DEBUG] Task ID: 653, Found 0 fields in database
===============================================
[SERVER DEBUG] Checking field corporateRegistration in retrieved data: NOT PRESENT
[SERVER DEBUG] Checking field goodStanding in retrieved data: NOT PRESENT
[SERVER DEBUG] Checking field regulatoryActions in retrieved data: NOT PRESENT
[SERVER DEBUG] Checking field investigationsIncidents in retrieved data: NOT PRESENT
[SERVER DEBUG] No fields with value "asdf" found in GET response data
[SERVER DEBUG] Sending GET response with 0 fields, status: not_started, progress: 0%
===============================================
10:07:47 AM [info] GET /api/kyb/progress/653 304 in 152ms :: {"formData":{},"progress":0,"status":"not_started"}
WebSocket client disconnected with code 1005 and reason: 
10:07:47 AM [info] GET /api/companies/current 304 in 31ms :: {"id":246,"name":"DevTest35","category":"FinTech","is_demo":true,"revenue_tie...
10:07:47 AM [info] GET /api/tasks 304 in 32ms :: [{"id":652,"title":"New User Invitation: 35@e.com","description":"Complete us...
[Tasks Routes] Fetching task by ID (special .json endpoint): {
  taskId: 654,
  userCompanyId: 246,
  timestamp: '2025-04-26T10:07:48.371Z'
}
10:07:48 AM [info] GET /api/companies/current 304 in 30ms :: {"id":246,"name":"DevTest35","category":"FinTech","is_demo":true,"revenue_tie...
[Tasks Routes] Task found by ID (special .json endpoint): {
  taskId: 654,
  title: '2. S&P KY3P Security Assessment: DevTest35',
  type: 'ky3p',
  formDataFields: 0,
  timestamp: '2025-04-26T10:07:48.402Z'
}
10:07:48 AM [info] GET /api/tasks.json/654 200 in 64ms :: {"id":654,"title":"2. S&P KY3P Security Assessment: DevTest35","description":...
New WebSocket client connected
[Tasks Routes] Updating task progress: { taskId: 654, timestamp: '2025-04-26T10:07:49.595Z' }
[Auth] Using cached user data: 288
[Task Templates API] Fetching template for task type: ky3p, user: 288
[Task Reconciliation] Fetching KY3P responses for task 654
[Task Templates API] Found template: 48 (S&P KY3P Security Assessment) for task type: ky3p
[Task Templates API] Retrieved 10 configuration items for template ID: 48
10:07:49 AM [info] GET /api/task-templates/by-type/ky3p 304 in 94ms :: {"id":48,"name":"S&P KY3P Security Assessment","description":"S&P KY3P Securi...
[Task Reconciliation] Recalculated KY3P progress: {
  taskId: 654,
  totalFields: '120',
  completedFields: '0',
  currentProgress: 0,
  calculatedProgress: 0
}
[Task Reconciliation] Updating KY3P task progress: {
  taskId: 654,
  progressFrom: 0,
  progressTo: 0,
  statusFrom: 'not_started',
  statusTo: 'not_started'
}
[Progress Utils] Broadcasting task progress update: {
  taskId: 654,
  progress: 0,
  requestedStatus: 'not_started',
  finalStatus: 'not_started',
  hasSubmissionDate: false,
  hasSubmittedFlag: false,
  timestamp: '2025-04-26T10:07:49.737Z'
}
[WebSocket] Broadcast "task_updated" sent to 3 clients {
  type: 'task_updated',
  dataKeys: [ 'id', 'status', 'progress', 'metadata', 'timestamp' ],
  timestamp: '2025-04-26T10:07:49.737Z',
  clientCount: 3
}
[Tasks Routes] Task progress reconciled: {
  taskId: 654,
  progress: 0,
  status: 'not_started',
  timestamp: '2025-04-26T10:07:49.767Z'
}
10:07:49 AM [info] POST /api/tasks/654/update-progress 200 in 203ms :: {"success":true,"progress":0,"status":"not_started","taskId":654}
[Tasks Routes] Updating task progress: { taskId: 654, timestamp: '2025-04-26T10:07:49.844Z' }
[2025-04-26T10:07:49.852Z] [INFO] [KY3PRoutes] [KY3P API] Fetching KY3P fields. User authenticated: true
[Task Reconciliation] Fetching KY3P responses for task 654
[Tasks Routes] Fetching task by ID (special .json endpoint): {
  taskId: 654,
  userCompanyId: 246,
  timestamp: '2025-04-26T10:07:49.884Z'
}
[Tasks Routes] Task found by ID (special .json endpoint): {
  taskId: 654,
  title: '2. S&P KY3P Security Assessment: DevTest35',
  type: 'ky3p',
  formDataFields: 0,
  timestamp: '2025-04-26T10:07:49.913Z'
}
[Task Reconciliation] Recalculated KY3P progress: {
  taskId: 654,
  totalFields: '120',
  completedFields: '0',
  currentProgress: 0,
  calculatedProgress: 0
}
[Task Reconciliation] Updating KY3P task progress: {
  taskId: 654,
  progressFrom: 0,
  progressTo: 0,
  statusFrom: 'not_started',
  statusTo: 'not_started'
}
10:07:49 AM [info] GET /api/tasks.json/654 200 in 60ms :: {"id":654,"title":"2. S&P KY3P Security Assessment: DevTest35","description":...
[2025-04-26T10:07:49.952Z] [INFO] [KY3PRoutes] [KY3P API] Successfully retrieved 120 KY3P fields
[2025-04-26T10:07:49.952Z] [INFO] [KY3PRoutes] [KY3P API] Fields grouped by step: ["Step 0: 120 fields"]
[Progress Utils] Broadcasting task progress update: {
  taskId: 654,
  progress: 0,
  requestedStatus: 'not_started',
  finalStatus: 'not_started',
  hasSubmissionDate: false,
  hasSubmittedFlag: false,
  timestamp: '2025-04-26T10:07:49.965Z'
}
[WebSocket] Broadcast "task_updated" sent to 3 clients {
  type: 'task_updated',
  dataKeys: [ 'id', 'status', 'progress', 'metadata', 'timestamp' ],
  timestamp: '2025-04-26T10:07:49.965Z',
  clientCount: 3
}
10:07:49 AM [info] GET /api/ky3p-fields 304 in 130ms :: [{"id":1,"order":1,"field_key":"externalSystems","display_name":"External Sys...
[Tasks Routes] Task progress reconciled: {
  taskId: 654,
  progress: 0,
  status: 'not_started',
  timestamp: '2025-04-26T10:07:49.994Z'
}
10:07:50 AM [info] POST /api/tasks/654/update-progress 200 in 181ms :: {"success":true,"progress":0,"status":"not_started","taskId":654}
[Tasks Routes] Fetching task by ID (special .json endpoint): {
  taskId: 654,
  userCompanyId: 246,
  timestamp: '2025-04-26T10:07:50.114Z'
}
[Auth] Using cached user data: 288
[KYB API Debug] Loading progress for task: 654
[Tasks Routes] Updating task progress: { taskId: 654, timestamp: '2025-04-26T10:07:50.140Z' }
[Tasks Routes] Task found by ID (special .json endpoint): {
  taskId: 654,
  title: '2. S&P KY3P Security Assessment: DevTest35',
  type: 'ky3p',
  formDataFields: 0,
  timestamp: '2025-04-26T10:07:50.142Z'
}
[Task Reconciliation] Fetching KY3P responses for task 654
[Task Reconciliation] Fetching KY3P responses for task 654
10:07:50 AM [info] GET /api/tasks.json/654 200 in 59ms :: {"id":654,"title":"2. S&P KY3P Security Assessment: DevTest35","description":...
[Task Reconciliation] Recalculated KY3P progress: {
  taskId: 654,
  totalFields: '120',
  completedFields: '0',
  currentProgress: 0,
  calculatedProgress: 0
}
[Task Reconciliation] Recalculated KY3P progress: {
  taskId: 654,
  totalFields: '120',
  completedFields: '0',
  currentProgress: 0,
  calculatedProgress: 0
}
[Task Reconciliation] Updating KY3P task progress: {
  taskId: 654,
  progressFrom: 0,
  progressTo: 0,
  statusFrom: 'not_started',
  statusTo: 'not_started'
}
[KYB API Debug] Retrieved task: {
  taskId: 654,
  status: 'not_started',
  progress: 0,
  metadata: [
    'locked',
    'company_id',
    'created_at',
    'created_via',
    'status_flow',
    'company_name',
    'last_updated',
    'created_by_id',
    'progressHistory',
    'prerequisite_for',
    'prerequisite_task_id',
    'prerequisite_completed',
    'prerequisite_task_type',
    'prerequisite_completed_at',
    'lastProgressReconciliation'
  ],
  timestamp: '2025-04-26T10:07:50.252Z'
}
[Progress Utils] Broadcasting task progress update: {
  taskId: 654,
  progress: 0,
  requestedStatus: 'not_started',
  finalStatus: 'not_started',
  hasSubmissionDate: false,
  hasSubmittedFlag: false,
  timestamp: '2025-04-26T10:07:50.256Z'
}
[WebSocket] Broadcast "task_updated" sent to 3 clients {
  type: 'task_updated',
  dataKeys: [ 'id', 'status', 'progress', 'metadata', 'timestamp' ],
  timestamp: '2025-04-26T10:07:50.256Z',
  clientCount: 3
}
[KYB API Debug] Retrieved responses: { responseCount: 0, fields: [], timestamp: '2025-04-26T10:07:50.280Z' }
[SERVER DEBUG] No savedFormData found in task table
[SERVER DEBUG] No KYB form file ID found in task metadata
[KYB API Debug] Retrieved task data: {
  id: 654,
  responseCount: 0,
  progress: 0,
  status: 'not_started',
  formDataKeys: []
}
===============================================
[SERVER DEBUG] PREPARING GET RESPONSE at 2025-04-26T10:07:50.281Z
[SERVER DEBUG] Task ID: 654, Found 0 fields in database
===============================================
[SERVER DEBUG] Checking field corporateRegistration in retrieved data: NOT PRESENT
[SERVER DEBUG] Checking field goodStanding in retrieved data: NOT PRESENT
[SERVER DEBUG] Checking field regulatoryActions in retrieved data: NOT PRESENT
[SERVER DEBUG] Checking field investigationsIncidents in retrieved data: NOT PRESENT
[SERVER DEBUG] No fields with value "asdf" found in GET response data
[SERVER DEBUG] Sending GET response with 0 fields, status: not_started, progress: 0%
===============================================
[Tasks Routes] Task progress reconciled: {
  taskId: 654,
  progress: 0,
  status: 'not_started',
  timestamp: '2025-04-26T10:07:50.286Z'
}
10:07:50 AM [info] GET /api/kyb/progress/654 304 in 175ms :: {"formData":{},"progress":0,"status":"not_started"}
10:07:50 AM [info] POST /api/tasks/654/update-progress 200 in 176ms :: {"success":true,"progress":0,"status":"not_started","taskId":654}
[Tasks Routes] Fetching task by ID (special .json endpoint): {
  taskId: 654,
  userCompanyId: 246,
  timestamp: '2025-04-26T10:07:50.408Z'
}
[Tasks Routes] Task found by ID (special .json endpoint): {
  taskId: 654,
  title: '2. S&P KY3P Security Assessment: DevTest35',
  type: 'ky3p',
  formDataFields: 0,
  timestamp: '2025-04-26T10:07:50.437Z'
}
10:07:50 AM [info] GET /api/tasks.json/654 200 in 59ms :: {"id":654,"title":"2. S&P KY3P Security Assessment: DevTest35","description":...
[Auth] Using cached user data: 288
[KYB API Debug] Loading progress for task: 654
[Task Reconciliation] Fetching KY3P responses for task 654
[Task Reconciliation] Recalculated KY3P progress: {
  taskId: 654,
  totalFields: '120',
  completedFields: '0',
  currentProgress: 0,
  calculatedProgress: 0
}
[KYB API Debug] Retrieved task: {
  taskId: 654,
  status: 'not_started',
  progress: 0,
  metadata: [
    'locked',
    'company_id',
    'created_at',
    'created_via',
    'status_flow',
    'company_name',
    'last_updated',
    'created_by_id',
    'progressHistory',
    'prerequisite_for',
    'prerequisite_task_id',
    'prerequisite_completed',
    'prerequisite_task_type',
    'prerequisite_completed_at',
    'lastProgressReconciliation'
  ],
  timestamp: '2025-04-26T10:07:50.584Z'
}
[KYB API Debug] Retrieved responses: { responseCount: 0, fields: [], timestamp: '2025-04-26T10:07:50.615Z' }
[SERVER DEBUG] No savedFormData found in task table
[SERVER DEBUG] No KYB form file ID found in task metadata
[KYB API Debug] Retrieved task data: {
  id: 654,
  responseCount: 0,
  progress: 0,
  status: 'not_started',
  formDataKeys: []
}
===============================================
[SERVER DEBUG] PREPARING GET RESPONSE at 2025-04-26T10:07:50.615Z
[SERVER DEBUG] Task ID: 654, Found 0 fields in database
===============================================
[SERVER DEBUG] Checking field corporateRegistration in retrieved data: NOT PRESENT
[SERVER DEBUG] Checking field goodStanding in retrieved data: NOT PRESENT
[SERVER DEBUG] Checking field regulatoryActions in retrieved data: NOT PRESENT
[SERVER DEBUG] Checking field investigationsIncidents in retrieved data: NOT PRESENT
[SERVER DEBUG] No fields with value "asdf" found in GET response data
[SERVER DEBUG] Sending GET response with 0 fields, status: not_started, progress: 0%
===============================================
10:07:50 AM [info] GET /api/kyb/progress/654 304 in 178ms :: {"formData":{},"progress":0,"status":"not_started"}
[KYB API Debug] Loading progress for task: 654
[Task Reconciliation] Fetching KY3P responses for task 654
[Task Reconciliation] Recalculated KY3P progress: {
  taskId: 654,
  totalFields: '120',
  completedFields: '0',
  currentProgress: 0,
  calculatedProgress: 0
}
[KYB API Debug] Retrieved task: {
  taskId: 654,
  status: 'not_started',
  progress: 0,
  metadata: [
    'locked',
    'company_id',
    'created_at',
    'created_via',
    'status_flow',
    'company_name',
    'last_updated',
    'created_by_id',
    'progressHistory',
    'prerequisite_for',
    'prerequisite_task_id',
    'prerequisite_completed',
    'prerequisite_task_type',
    'prerequisite_completed_at',
    'lastProgressReconciliation'
  ],
  timestamp: '2025-04-26T10:07:50.914Z'
}
[KYB API Debug] Retrieved responses: { responseCount: 0, fields: [], timestamp: '2025-04-26T10:07:50.945Z' }
[SERVER DEBUG] No savedFormData found in task table
[SERVER DEBUG] No KYB form file ID found in task metadata
[KYB API Debug] Retrieved task data: {
  id: 654,
  responseCount: 0,
  progress: 0,
  status: 'not_started',
  formDataKeys: []
}
===============================================
[SERVER DEBUG] PREPARING GET RESPONSE at 2025-04-26T10:07:50.945Z
[SERVER DEBUG] Task ID: 654, Found 0 fields in database
===============================================
[SERVER DEBUG] Checking field corporateRegistration in retrieved data: NOT PRESENT
[SERVER DEBUG] Checking field goodStanding in retrieved data: NOT PRESENT
[SERVER DEBUG] Checking field regulatoryActions in retrieved data: NOT PRESENT
[SERVER DEBUG] Checking field investigationsIncidents in retrieved data: NOT PRESENT
[SERVER DEBUG] No fields with value "asdf" found in GET response data
[SERVER DEBUG] Sending GET response with 0 fields, status: not_started, progress: 0%
===============================================
10:07:50 AM [info] GET /api/kyb/progress/654 304 in 183ms :: {"formData":{},"progress":0,"status":"not_started"}
New WebSocket client connected
[KYB API Debug] Loading progress for task: 654
[Task Reconciliation] Fetching KY3P responses for task 654
[Task Reconciliation] Recalculated KY3P progress: {
  taskId: 654,
  totalFields: '120',
  completedFields: '0',
  currentProgress: 0,
  calculatedProgress: 0
}
[KYB API Debug] Retrieved task: {
  taskId: 654,
  status: 'not_started',
  progress: 0,
  metadata: [
    'locked',
    'company_id',
    'created_at',
    'created_via',
    'status_flow',
    'company_name',
    'last_updated',
    'created_by_id',
    'progressHistory',
    'prerequisite_for',
    'prerequisite_task_id',
    'prerequisite_completed',
    'prerequisite_task_type',
    'prerequisite_completed_at',
    'lastProgressReconciliation'
  ],
  timestamp: '2025-04-26T10:07:51.248Z'
}
[KYB API Debug] Retrieved responses: { responseCount: 0, fields: [], timestamp: '2025-04-26T10:07:51.279Z' }
[SERVER DEBUG] No savedFormData found in task table
[SERVER DEBUG] No KYB form file ID found in task metadata
[KYB API Debug] Retrieved task data: {
  id: 654,
  responseCount: 0,
  progress: 0,
  status: 'not_started',
  formDataKeys: []
}
===============================================
[SERVER DEBUG] PREPARING GET RESPONSE at 2025-04-26T10:07:51.279Z
[SERVER DEBUG] Task ID: 654, Found 0 fields in database
===============================================
[SERVER DEBUG] Checking field corporateRegistration in retrieved data: NOT PRESENT
[SERVER DEBUG] Checking field goodStanding in retrieved data: NOT PRESENT
[SERVER DEBUG] Checking field regulatoryActions in retrieved data: NOT PRESENT
[SERVER DEBUG] Checking field investigationsIncidents in retrieved data: NOT PRESENT
[SERVER DEBUG] No fields with value "asdf" found in GET response data
[SERVER DEBUG] Sending GET response with 0 fields, status: not_started, progress: 0%
===============================================
10:07:51 AM [info] GET /api/kyb/progress/654 304 in 184ms :: {"formData":{},"progress":0,"status":"not_started"}
[KYB API Debug] Loading progress for task: 654
[Task Reconciliation] Fetching KY3P responses for task 654
[Task Reconciliation] Recalculated KY3P progress: {
  taskId: 654,
  totalFields: '120',
  completedFields: '0',
  currentProgress: 0,
  calculatedProgress: 0
}
[KYB API Debug] Retrieved task: {
  taskId: 654,
  status: 'not_started',
  progress: 0,
  metadata: [
    'locked',
    'company_id',
    'created_at',
    'created_via',
    'status_flow',
    'company_name',
    'last_updated',
    'created_by_id',
    'progressHistory',
    'prerequisite_for',
    'prerequisite_task_id',
    'prerequisite_completed',
    'prerequisite_task_type',
    'prerequisite_completed_at',
    'lastProgressReconciliation'
  ],
  timestamp: '2025-04-26T10:07:51.582Z'
}
[KYB API Debug] Retrieved responses: { responseCount: 0, fields: [], timestamp: '2025-04-26T10:07:51.612Z' }
[SERVER DEBUG] No savedFormData found in task table
[SERVER DEBUG] No KYB form file ID found in task metadata
[KYB API Debug] Retrieved task data: {
  id: 654,
  responseCount: 0,
  progress: 0,
  status: 'not_started',
  formDataKeys: []
}
===============================================
[SERVER DEBUG] PREPARING GET RESPONSE at 2025-04-26T10:07:51.612Z
[SERVER DEBUG] Task ID: 654, Found 0 fields in database
===============================================
[SERVER DEBUG] Checking field corporateRegistration in retrieved data: NOT PRESENT
[SERVER DEBUG] Checking field goodStanding in retrieved data: NOT PRESENT
[SERVER DEBUG] Checking field regulatoryActions in retrieved data: NOT PRESENT
[SERVER DEBUG] Checking field investigationsIncidents in retrieved data: NOT PRESENT
[SERVER DEBUG] No fields with value "asdf" found in GET response data
[SERVER DEBUG] Sending GET response with 0 fields, status: not_started, progress: 0%
===============================================
10:07:51 AM [info] GET /api/kyb/progress/654 304 in 179ms :: {"formData":{},"progress":0,"status":"not_started"}
[KYB API Debug] Loading progress for task: 654
[Task Reconciliation] Fetching KY3P responses for task 654
[Task Reconciliation] Recalculated KY3P progress: {
  taskId: 654,
  totalFields: '120',
  completedFields: '0',
  currentProgress: 0,
  calculatedProgress: 0
}
[KYB API Debug] Retrieved task: {
  taskId: 654,
  status: 'not_started',
  progress: 0,
  metadata: [
    'locked',
    'company_id',
    'created_at',
    'created_via',
    'status_flow',
    'company_name',
    'last_updated',
    'created_by_id',
    'progressHistory',
    'prerequisite_for',
    'prerequisite_task_id',
    'prerequisite_completed',
    'prerequisite_task_type',
    'prerequisite_completed_at',
    'lastProgressReconciliation'
  ],
  timestamp: '2025-04-26T10:07:51.917Z'
}
[KYB API Debug] Retrieved responses: { responseCount: 0, fields: [], timestamp: '2025-04-26T10:07:51.946Z' }
[SERVER DEBUG] No savedFormData found in task table
[SERVER DEBUG] No KYB form file ID found in task metadata
[KYB API Debug] Retrieved task data: {
  id: 654,
  responseCount: 0,
  progress: 0,
  status: 'not_started',
  formDataKeys: []
}
===============================================
[SERVER DEBUG] PREPARING GET RESPONSE at 2025-04-26T10:07:51.946Z
[SERVER DEBUG] Task ID: 654, Found 0 fields in database
===============================================
[SERVER DEBUG] Checking field corporateRegistration in retrieved data: NOT PRESENT
[SERVER DEBUG] Checking field goodStanding in retrieved data: NOT PRESENT
[SERVER DEBUG] Checking field regulatoryActions in retrieved data: NOT PRESENT
[SERVER DEBUG] Checking field investigationsIncidents in retrieved data: NOT PRESENT
[SERVER DEBUG] No fields with value "asdf" found in GET response data
[SERVER DEBUG] Sending GET response with 0 fields, status: not_started, progress: 0%
===============================================
10:07:51 AM [info] GET /api/kyb/progress/654 304 in 184ms :: {"formData":{},"progress":0,"status":"not_started"}
[Tasks Routes] Updating task progress: { taskId: 654, timestamp: '2025-04-26T10:07:52.162Z' }
[Task Reconciliation] Fetching KY3P responses for task 654
[Task Reconciliation] Recalculated KY3P progress: {
  taskId: 654,
  totalFields: '120',
  completedFields: '0',
  currentProgress: 0,
  calculatedProgress: 0
}
[Task Reconciliation] Updating KY3P task progress: {
  taskId: 654,
  progressFrom: 0,
  progressTo: 0,
  statusFrom: 'not_started',
  statusTo: 'not_started'
}
[Progress Utils] Broadcasting task progress update: {
  taskId: 654,
  progress: 0,
  requestedStatus: 'not_started',
  finalStatus: 'not_started',
  hasSubmissionDate: false,
  hasSubmittedFlag: false,
  timestamp: '2025-04-26T10:07:52.280Z'
}
[WebSocket] Broadcast "task_updated" sent to 4 clients {
  type: 'task_updated',
  dataKeys: [ 'id', 'status', 'progress', 'metadata', 'timestamp' ],
  timestamp: '2025-04-26T10:07:52.281Z',
  clientCount: 4
}
[Tasks Routes] Task progress reconciled: {
  taskId: 654,
  progress: 0,
  status: 'not_started',
  timestamp: '2025-04-26T10:07:52.309Z'
}
10:07:52 AM [info] POST /api/tasks/654/update-progress 200 in 177ms :: {"success":true,"progress":0,"status":"not_started","taskId":654}
[Tasks Routes] Fetching task by ID (special .json endpoint): {
  taskId: 654,
  userCompanyId: 246,
  timestamp: '2025-04-26T10:07:52.432Z'
}
[Tasks Routes] Task found by ID (special .json endpoint): {
  taskId: 654,
  title: '2. S&P KY3P Security Assessment: DevTest35',
  type: 'ky3p',
  formDataFields: 0,
  timestamp: '2025-04-26T10:07:52.462Z'
}
10:07:52 AM [info] GET /api/tasks.json/654 200 in 61ms :: {"id":654,"title":"2. S&P KY3P Security Assessment: DevTest35","description":...
[2025-04-26T10:07:53.083Z] [INFO] [KY3PDemoAutofill] Demo auto-fill requested for KY3P task {"taskId":654,"userId":288}
[2025-04-26T10:07:53.176Z] [INFO] [KY3PDemoAutofill] Found 120 KY3P fields with demo values for task 654
[2025-04-26T10:07:53.207Z] [INFO] [KY3PDemoAutofill] Cleared existing responses for task 654
[2025-04-26T10:07:54.435Z] [INFO] [KY3PDemoAutofill] Successfully inserted 120 KY3P responses for task 654
[2025-04-26T10:07:54.466Z] [INFO] [KY3PDemoAutofill] Updated task progress after demo auto-fill {"taskId":654,"progress":100,"status":"ready_for_submission"}
[WebSocket] Broadcast "task_updated" sent to 4 clients {
  type: 'task_updated',
  dataKeys: [ 'id', 'taskId', 'status', 'progress', 'source', 'timestamp' ],
  timestamp: '2025-04-26T10:07:54.466Z',
  clientCount: 4
}
10:07:54 AM [info] POST /api/ky3p/demo-autofill/654 200 in 1420ms :: {"success":true,"message":"KY3P form auto-filled with demo data","responsesIn...
[Tasks Routes] Fetching task by ID (special .json endpoint): {
  taskId: 654,
  userCompanyId: 246,
  timestamp: '2025-04-26T10:07:54.649Z'
}
[Tasks Routes] Updating task progress: { taskId: 654, timestamp: '2025-04-26T10:07:54.651Z' }
[Tasks Routes] Task found by ID (special .json endpoint): {
  taskId: 654,
  title: '2. S&P KY3P Security Assessment: DevTest35',
  type: 'ky3p',
  formDataFields: 0,
  timestamp: '2025-04-26T10:07:54.679Z'
}
[Task Reconciliation] Fetching KY3P responses for task 654
[Tasks Routes] Updating task progress: { taskId: 654, timestamp: '2025-04-26T10:07:54.682Z' }
10:07:54 AM [info] GET /api/tasks.json/654 200 in 61ms :: {"id":654,"title":"2. S&P KY3P Security Assessment: DevTest35","description":...
[Task Reconciliation] Fetching KY3P responses for task 654
[Task Reconciliation] Recalculated KY3P progress: {
  taskId: 654,
  totalFields: '120',
  completedFields: '120',
  currentProgress: 100,
  calculatedProgress: 100
}
[Task Reconciliation] Updating KY3P task progress: {
  taskId: 654,
  progressFrom: 100,
  progressTo: 100,
  statusFrom: 'ready_for_submission',
  statusTo: 'ready_for_submission'
}
[Task Reconciliation] Recalculated KY3P progress: {
  taskId: 654,
  totalFields: '120',
  completedFields: '120',
  currentProgress: 100,
  calculatedProgress: 100
}
[Task Reconciliation] Updating KY3P task progress: {
  taskId: 654,
  progressFrom: 100,
  progressTo: 100,
  statusFrom: 'ready_for_submission',
  statusTo: 'ready_for_submission'
}
[Progress Utils] Broadcasting task progress update: {
  taskId: 654,
  progress: 100,
  requestedStatus: 'ready_for_submission',
  finalStatus: 'ready_for_submission',
  hasSubmissionDate: false,
  hasSubmittedFlag: false,
  timestamp: '2025-04-26T10:07:54.772Z'
}
[WebSocket] Broadcast "task_updated" sent to 4 clients {
  type: 'task_updated',
  dataKeys: [ 'id', 'status', 'progress', 'metadata', 'timestamp' ],
  timestamp: '2025-04-26T10:07:54.772Z',
  clientCount: 4
}
[Progress Utils] Broadcasting task progress update: {
  taskId: 654,
  progress: 100,
  requestedStatus: 'ready_for_submission',
  finalStatus: 'ready_for_submission',
  hasSubmissionDate: false,
  hasSubmittedFlag: false,
  timestamp: '2025-04-26T10:07:54.802Z'
}
[WebSocket] Broadcast "task_updated" sent to 4 clients {
  type: 'task_updated',
  dataKeys: [ 'id', 'status', 'progress', 'metadata', 'timestamp' ],
  timestamp: '2025-04-26T10:07:54.802Z',
  clientCount: 4
}
[Tasks Routes] Task progress reconciled: {
  taskId: 654,
  progress: 100,
  status: 'ready_for_submission',
  timestamp: '2025-04-26T10:07:54.803Z'
}
[Tasks Routes] Task progress reconciled: {
  taskId: 654,
  progress: 100,
  status: 'ready_for_submission',
  timestamp: '2025-04-26T10:07:54.831Z'
}
10:07:54 AM [info] POST /api/tasks/654/update-progress 200 in 183ms :: {"success":true,"progress":100,"status":"ready_for_submission","taskId":654}
10:07:54 AM [info] POST /api/tasks/654/update-progress 200 in 179ms :: {"success":true,"progress":100,"status":"ready_for_submission","taskId":654}
[Tasks Routes] Fetching task by ID (special .json endpoint): {
  taskId: 654,
  userCompanyId: 246,
  timestamp: '2025-04-26T10:07:54.925Z'
}
[Tasks Routes] Task found by ID (special .json endpoint): {
  taskId: 654,
  title: '2. S&P KY3P Security Assessment: DevTest35',
  type: 'ky3p',
  formDataFields: 0,
  timestamp: '2025-04-26T10:07:54.954Z'
}
10:07:54 AM [info] GET /api/tasks.json/654 200 in 60ms :: {"id":654,"title":"2. S&P KY3P Security Assessment: DevTest35","description":...
[Tasks Routes] Fetching task by ID (special .json endpoint): {
  taskId: 654,
  userCompanyId: 246,
  timestamp: '2025-04-26T10:07:55.134Z'
}
[Tasks Routes] Task found by ID (special .json endpoint): {
  taskId: 654,
  title: '2. S&P KY3P Security Assessment: DevTest35',
  type: 'ky3p',
  formDataFields: 0,
  timestamp: '2025-04-26T10:07:55.164Z'
}
10:07:55 AM [info] GET /api/tasks.json/654 304 in 60ms :: {"id":654,"title":"2. S&P KY3P Security Assessment: DevTest35","description":...
[WebSocket] Received ping
[Current Company] Fetching company for user: { userId: 288, companyId: 246 }
[Current Company] Found company: {
  id: 246,
  name: 'DevTest35',
  onboardingCompleted: false,
  riskScore: null,
  chosenScore: null,
  isDemo: true
}
10:07:58 AM [info] GET /api/companies/current 304 in 58ms :: {"id":246,"name":"DevTest35","category":"FinTech","is_demo":true,"revenue_tie...
10:08:08 AM [info] GET /api/companies/current 304 in 31ms :: {"id":246,"name":"DevTest35","category":"FinTech","is_demo":true,"revenue_tie...