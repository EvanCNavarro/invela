3:44:45 AM [info] GET /api/tasks 304 in 95ms :: [{"id":197,"title":"New User Invitation: e.v.a.nc.na.va.r.r.o@gmail.com","des...
New WebSocket client connected
WebSocket client disconnected with code 1005 and reason: 
[Auth] Deserializing user: 150
[2025-03-18T03:44:46.680Z] [INFO] [CardRoutes] Fetching CARD task {"companyName":"Vector","userId":150,"companyId":113}
[2025-03-18T03:44:46.714Z] [INFO] [CardRoutes] Task lookup result {"found":true,"taskId":196,"taskType":"company_card","taskStatus":"in_progress"}
3:44:46 AM [info] GET /api/tasks/card/Vector 304 in 67ms :: {"id":196,"title":"Company CARD: Vector","description":"Provide Compliance an...
New WebSocket client connected
[Auth] Deserializing user: 150
[Files] Processing file upload request
[WebSocket] Broadcasting upload progress: {
  type: 'UPLOAD_PROGRESS',
  fileId: null,
  fileName: 'soc2-type2 (1).pdf',
  status: 'uploading',
  progress: 0
}
[Files] File details: {
  originalname: 'soc2-type2 (1).pdf',
  mimetype: 'application/pdf',
  size: 760657,
  filename: '20250318034450.pdf'
}
[Files] Document category detection: {
  filename: 'soc2-type2 (1).pdf',
  lowerFilename: 'soc2-type2 (1).pdf',
  detectedCategory: 'soc2_audit',
  timestamp: '2025-03-18T03:44:50.995Z',
  matches: {
    isSoc2: true,
    isIso27001: false,
    isPentest: false,
    isBusinessContinuity: false,
    exactMatch: 'soc2-type2 (1).pdf'
  }
}
[Files] Detected category: soc2_audit
[Files] Created file record: {
  id: 391,
  name: 'soc2-type2 (1).pdf',
  status: 'uploaded',
  category: 'soc2_audit'
}
[WebSocket] Broadcasting upload progress: {
  type: 'UPLOAD_PROGRESS',
  fileId: 391,
  fileName: 'soc2-type2 (1).pdf',
  status: 'uploaded',
  progress: 100
}
[WebSocket] Broadcasting document count update: {
  type: 'COUNT_UPDATE',
  category: 'soc2_audit',
  count: 1,
  companyId: '113'
}
3:44:51 AM [info] POST /api/files 201 in 642ms :: {"id":391,"name":"soc2-type2 (1).pdf","size":760657,"type":"application/pdf",...
[Auth] Deserializing user: 150
[Auth] Deserializing user: 150
[Tasks] ====== Starting task fetch =====
[Tasks] User details: { id: 150, company_id: 113, email: 'e.v.a.nc.na.va.r.r.o@gmail.com' }
[Tasks] KYB tasks found: {
  count: 1,
  tasks: [
    {
      id: 195,
      company_id: 113,
      task_scope: 'company',
      task_type: 'company_kyb',
      assigned_to: null,
      status: 'submitted'
    }
  ]
}
[Tasks] Query conditions: {
  conditions: {
    condition1: 'tasks.assigned_to = 150',
    condition2: 'tasks.created_by = 150',
    condition3: "tasks.company_id = 113 AND tasks.assigned_to IS NULL AND tasks.task_scope = 'company'",
    condition4: "tasks.task_type = 'user_onboarding' AND LOWER(tasks.user_email) = LOWER('e.v.a.nc.na.va.r.r.o@gmail.com')"
  }
}
[Tasks] Tasks found: {
  count: 3,
  tasks: [
    {
      id: 197,
      title: 'New User Invitation: e.v.a.nc.na.va.r.r.o@gmail.com',
      assigned_to: 150,
      company_id: 113,
      task_scope: 'user',
      task_type: 'user_onboarding',
      status: 'completed'
    },
    {
      id: 195,
      title: 'Company KYB: Vector',
      assigned_to: null,
      company_id: 113,
      task_scope: 'company',
      task_type: 'company_kyb',
      status: 'submitted'
    },
    {
      id: 196,
      title: 'Company CARD: Vector',
      assigned_to: null,
      company_id: 113,
      task_scope: 'company',
      task_type: 'company_card',
      status: 'in_progress'
    }
  ]
}
3:44:51 AM [info] GET /api/tasks 304 in 94ms :: [{"id":197,"title":"New User Invitation: e.v.a.nc.na.va.r.r.o@gmail.com","des...
[Auth] Deserializing user: 150
[Current Company] Fetching company for user: { userId: 150, companyId: 113 }
[Current Company] Found company: { id: 113, name: 'Vector', onboardingCompleted: true }
3:44:52 AM [info] GET /api/companies/current 304 in 64ms :: {"id":113,"name":"Vector","description":"FinTech partner company Vector","cat...
[Files] Processing file upload request
[WebSocket] Broadcasting upload progress: {
  type: 'UPLOAD_PROGRESS',
  fileId: null,
  fileName: 'Anonymised-BlackBox-Penetration-Testing-Report.pdf',
  status: 'uploading',
  progress: 0
}
[Files] File details: {
  originalname: 'Anonymised-BlackBox-Penetration-Testing-Report.pdf',
  mimetype: 'application/pdf',
  size: 2328443,
  filename: '20250318034451.pdf'
}
[Files] Document category detection: {
  filename: 'Anonymised-BlackBox-Penetration-Testing-Report.pdf',
  lowerFilename: 'anonymised-blackbox-penetration-testing-report.pdf',
  detectedCategory: 'pentest_report',
  timestamp: '2025-03-18T03:44:53.194Z',
  matches: {
    isSoc2: false,
    isIso27001: false,
    isPentest: false,
    isBusinessContinuity: false,
    exactMatch: 'anonymised-blackbox-penetration-testing-report.pdf'
  }
}
[Files] Detected category: pentest_report
[Files] Created file record: {
  id: 392,
  name: 'Anonymised-BlackBox-Penetration-Testing-Report.pdf',
  status: 'uploaded',
  category: 'pentest_report'
}
[WebSocket] Broadcasting upload progress: {
  type: 'UPLOAD_PROGRESS',
  fileId: 392,
  fileName: 'Anonymised-BlackBox-Penetration-Testing-Report.pdf',
  status: 'uploaded',
  progress: 100
}
[WebSocket] Broadcasting document count update: {
  type: 'COUNT_UPDATE',
  category: 'pentest_report',
  count: 1,
  companyId: '113'
}
3:44:53 AM [info] POST /api/files 201 in 2054ms :: {"id":392,"name":"Anonymised-BlackBox-Penetration-Testing-Report.pdf","size":...
[Auth] Deserializing user: 150
[Files] Processing file upload request
[WebSocket] Broadcasting upload progress: {
  type: 'UPLOAD_PROGRESS',
  fileId: null,
  fileName: 'spg-business-continuity-plan.pdf',
  status: 'uploading',
  progress: 0
}
[Files] File details: {
  originalname: 'spg-business-continuity-plan.pdf',
  mimetype: 'application/pdf',
  size: 200021,
  filename: '20250318034453.pdf'
}
[Files] Document category detection: {
  filename: 'spg-business-continuity-plan.pdf',
  lowerFilename: 'spg-business-continuity-plan.pdf',
  detectedCategory: 'business_continuity',
  timestamp: '2025-03-18T03:44:53.476Z',
  matches: {
    isSoc2: false,
    isIso27001: false,
    isPentest: false,
    isBusinessContinuity: false,
    exactMatch: 'spg-business-continuity-plan.pdf'
  }
}
[Files] Detected category: business_continuity
[Files] Created file record: {
  id: 393,
  name: 'spg-business-continuity-plan.pdf',
  status: 'uploaded',
  category: 'business_continuity'
}
[WebSocket] Broadcasting upload progress: {
  type: 'UPLOAD_PROGRESS',
  fileId: 393,
  fileName: 'spg-business-continuity-plan.pdf',
  status: 'uploaded',
  progress: 100
}
[WebSocket] Broadcasting document count update: {
  type: 'COUNT_UPDATE',
  category: 'business_continuity',
  count: 1,
  companyId: '113'
}
3:44:53 AM [info] POST /api/files 201 in 140ms :: {"id":393,"name":"spg-business-continuity-plan.pdf","size":200021,"type":"app...
[Auth] Deserializing user: 150
[Files] Processing file upload request
[WebSocket] Broadcasting upload progress: {
  type: 'UPLOAD_PROGRESS',
  fileId: null,
  fileName: 'Anonymized-ISO-27001-Assessment-Report (1).pdf',
  status: 'uploading',
  progress: 0
}
[Files] File details: {
  originalname: 'Anonymized-ISO-27001-Assessment-Report (1).pdf',
  mimetype: 'application/pdf',
  size: 889081,
  filename: '20250318034453.pdf'
}
[Files] Document category detection: {
  filename: 'Anonymized-ISO-27001-Assessment-Report (1).pdf',
  lowerFilename: 'anonymized-iso-27001-assessment-report (1).pdf',
  detectedCategory: 'iso27001_cert',
  timestamp: '2025-03-18T03:44:54.250Z',
  matches: {
    isSoc2: false,
    isIso27001: false,
    isPentest: false,
    isBusinessContinuity: false,
    exactMatch: 'anonymized-iso-27001-assessment-report (1).pdf'
  }
}
[Files] Detected category: iso27001_cert
[Files] Created file record: {
  id: 394,
  name: 'Anonymized-ISO-27001-Assessment-Report (1).pdf',
  status: 'uploaded',
  category: 'iso27001_cert'
}
[WebSocket] Broadcasting upload progress: {
  type: 'UPLOAD_PROGRESS',
  fileId: 394,
  fileName: 'Anonymized-ISO-27001-Assessment-Report (1).pdf',
  status: 'uploaded',
  progress: 100
}
[WebSocket] Broadcasting document count update: {
  type: 'COUNT_UPDATE',
  category: 'iso27001_cert',
  count: 1,
  companyId: '113'
}
3:44:54 AM [info] POST /api/files 201 in 632ms :: {"id":394,"name":"Anonymized-ISO-27001-Assessment-Report (1).pdf","size":8890...
[Auth] Deserializing user: 150
[Tasks] ====== Starting task fetch =====
[Tasks] User details: { id: 150, company_id: 113, email: 'e.v.a.nc.na.va.r.r.o@gmail.com' }
[Tasks] KYB tasks found: {
  count: 1,
  tasks: [
    {
      id: 195,
      company_id: 113,
      task_scope: 'company',
      task_type: 'company_kyb',
      assigned_to: null,
      status: 'submitted'
    }
  ]
}
[Tasks] Query conditions: {
  conditions: {
    condition1: 'tasks.assigned_to = 150',
    condition2: 'tasks.created_by = 150',
    condition3: "tasks.company_id = 113 AND tasks.assigned_to IS NULL AND tasks.task_scope = 'company'",
    condition4: "tasks.task_type = 'user_onboarding' AND LOWER(tasks.user_email) = LOWER('e.v.a.nc.na.va.r.r.o@gmail.com')"
  }
}
[Tasks] Tasks found: {
  count: 3,
  tasks: [
    {
      id: 197,
      title: 'New User Invitation: e.v.a.nc.na.va.r.r.o@gmail.com',
      assigned_to: 150,
      company_id: 113,
      task_scope: 'user',
      task_type: 'user_onboarding',
      status: 'completed'
    },
    {
      id: 195,
      title: 'Company KYB: Vector',
      assigned_to: null,
      company_id: 113,
      task_scope: 'company',
      task_type: 'company_kyb',
      status: 'submitted'
    },
    {
      id: 196,
      title: 'Company CARD: Vector',
      assigned_to: null,
      company_id: 113,
      task_scope: 'company',
      task_type: 'company_card',
      status: 'in_progress'
    }
  ]
}
3:44:57 AM [info] GET /api/tasks 304 in 94ms :: [{"id":197,"title":"New User Invitation: e.v.a.nc.na.va.r.r.o@gmail.com","des...
[Auth] Deserializing user: 150
[Current Company] Fetching company for user: { userId: 150, companyId: 113 }
[Current Company] Found company: { id: 113, name: 'Vector', onboardingCompleted: true }
3:44:57 AM [info] GET /api/companies/current 304 in 63ms :: {"id":113,"name":"Vector","description":"FinTech partner company Vector","cat...
[Auth] Deserializing user: 150
[Tasks] ====== Starting task fetch =====
[Tasks] User details: { id: 150, company_id: 113, email: 'e.v.a.nc.na.va.r.r.o@gmail.com' }
[Tasks] KYB tasks found: {
  count: 1,
  tasks: [
    {
      id: 195,
      company_id: 113,
      task_scope: 'company',
      task_type: 'company_kyb',
      assigned_to: null,
      status: 'submitted'
    }
  ]
}
[Tasks] Query conditions: {
  conditions: {
    condition1: 'tasks.assigned_to = 150',
    condition2: 'tasks.created_by = 150',
    condition3: "tasks.company_id = 113 AND tasks.assigned_to IS NULL AND tasks.task_scope = 'company'",
    condition4: "tasks.task_type = 'user_onboarding' AND LOWER(tasks.user_email) = LOWER('e.v.a.nc.na.va.r.r.o@gmail.com')"
  }
}
[Tasks] Tasks found: {
  count: 3,
  tasks: [
    {
      id: 197,
      title: 'New User Invitation: e.v.a.nc.na.va.r.r.o@gmail.com',
      assigned_to: 150,
      company_id: 113,
      task_scope: 'user',
      task_type: 'user_onboarding',
      status: 'completed'
    },
    {
      id: 195,
      title: 'Company KYB: Vector',
      assigned_to: null,
      company_id: 113,
      task_scope: 'company',
      task_type: 'company_kyb',
      status: 'submitted'
    },
    {
      id: 196,
      title: 'Company CARD: Vector',
      assigned_to: null,
      company_id: 113,
      task_scope: 'company',
      task_type: 'company_card',
      status: 'in_progress'
    }
  ]
}
3:45:02 AM [info] GET /api/tasks 304 in 94ms :: [{"id":197,"title":"New User Invitation: e.v.a.nc.na.va.r.r.o@gmail.com","des...
[Auth] Deserializing user: 150
[Current Company] Fetching company for user: { userId: 150, companyId: 113 }
[Current Company] Found company: { id: 113, name: 'Vector', onboardingCompleted: true }
3:45:02 AM [info] GET /api/companies/current 304 in 63ms :: {"id":113,"name":"Vector","description":"FinTech partner company Vector","cat...
WebSocket client disconnected with code 1005 and reason: 
[Auth] Deserializing user: 150
[2025-03-18T03:45:02.816Z] [INFO] [CardRoutes] Fetching CARD fields
3:45:02 AM [info] GET /api/card/fields 304 in 125ms :: [{"id":1,"field_key":"security_access_control","wizard_section":"Security","q...
[Auth] Deserializing user: 150
[Document Processing] Creating chunks for file: {
  fileId: 391,
  fileName: 'soc2-type2 (1).pdf',
  mimeType: 'application/pdf',
  timestamp: '2025-03-18T03:45:03.140Z'
}
[DocumentChunking] Starting document chunking: {
  filePath: '/home/runner/workspace/uploads/documents/20250318034450.pdf',
  mimeType: 'application/pdf',
  chunkSize: 4000,
  timestamp: '2025-03-18T03:45:03.140Z'
}
[PDF Service] Extraction complete: {
  fileName: '20250318034450.pdf',
  totalPages: 56,
  extractedPages: 56,
  totalContent: 137813,
  averageContentPerPage: 2461,
  invalidContentItems: 3331,
  timestamp: '2025-03-18T03:45:04.837Z'
}
[DocumentChunking] Content extracted: {
  contentLength: 64000,
  mimeType: 'application/pdf',
  timestamp: '2025-03-18T03:45:04.838Z'
}
[DocumentChunking] Created chunk: {
  chunkIndex: 0,
  chunkSize: 4094,
  startsWithWord: 'PRODUCT FRUITS S.R.O',
  endsWithWord: 'ganization controls.',
  timestamp: '2025-03-18T03:45:04.838Z'
}
[DocumentChunking] Created chunk: {
  chunkIndex: 1,
  chunkSize: 4055,
  startsWithWord: 'Service O rganizatio',
  endsWithWord: 't services criteria.',
  timestamp: '2025-03-18T03:45:04.838Z'
}
[DocumentChunking] Created chunk: {
  chunkIndex: 2,
  chunkSize: 3909,
  startsWithWord: 'Also, the projection',
  endsWithWord: 'cription criteria) .',
  timestamp: '2025-03-18T03:45:04.838Z'
}
[DocumentChunking] Created chunk: {
  chunkIndex: 3,
  chunkSize: 3901,
  startsWithWord: 'The description is i',
  endsWithWord: 'abases, and tables).',
  timestamp: '2025-03-18T03:45:04.838Z'
}
[DocumentChunking] Created chunk: {
  chunkIndex: 4,
  chunkSize: 3981,
  startsWithWord: '4. The boundaries or',
  endsWithWord: ' how staff is hired.',
  timestamp: '2025-03-18T03:45:04.838Z'
}
[DocumentChunking] Created chunk: {
  chunkIndex: 5,
  chunkSize: 3919,
  startsWithWord: 'Components of the Sy',
  endsWithWord: 'in a timely ma nner.',
  timestamp: '2025-03-18T03:45:04.838Z'
}
[DocumentChunking] Created chunk: {
  chunkIndex: 6,
  chunkSize: 3915,
  startsWithWord: 'Compliance Program M',
  endsWithWord: '. • Public website .',
  timestamp: '2025-03-18T03:45:04.838Z'
}
[DocumentChunking] Created chunk: {
  chunkIndex: 7,
  chunkSize: 4002,
  startsWithWord: 'Further, all custome',
  endsWithWord: 'eased to production.',
  timestamp: '2025-03-18T03:45:04.839Z'
}
[DocumentChunking] Created chunk: {
  chunkIndex: 8,
  chunkSize: 3938,
  startsWithWord: '15 The ability to im',
  endsWithWord: 'e system boundaries.',
  timestamp: '2025-03-18T03:45:04.839Z'
}
[DocumentChunking] Created chunk: {
  chunkIndex: 9,
  chunkSize: 3981,
  startsWithWord: 'Policies enforced on',
  endsWithWord: 'e senior management.',
  timestamp: '2025-03-18T03:45:04.839Z'
}
[DocumentChunking] Created chunk: {
  chunkIndex: 10,
  chunkSize: 3951,
  startsWithWord: '• Annual Security Aw',
  endsWithWord: ' on an annual basis.',
  timestamp: '2025-03-18T03:45:04.839Z'
}
[DocumentChunking] Created chunk: {
  chunkIndex: 11,
  chunkSize: 3970,
  startsWithWord: '• If an employee vio',
  endsWithWord: 'es. Any vendor risks',
  timestamp: '2025-03-18T03:45:04.839Z'
}
[DocumentChunking] Created chunk: {
  chunkIndex: 12,
  chunkSize: 3916,
  startsWithWord: '20 identified are re',
  endsWithWord: ' system boundaries).',
  timestamp: '2025-03-18T03:45:04.839Z'
}
[DocumentChunking] Created chunk: {
  chunkIndex: 13,
  chunkSize: 3922,
  startsWithWord: 'Confidentiality requ',
  endsWithWord: 'roduct Fruits s.r.o.',
  timestamp: '2025-03-18T03:45:04.839Z'
}
[DocumentChunking] Created chunk: {
  chunkIndex: 14,
  chunkSize: 4036,
  startsWithWord: 'periodically reviews',
  endsWithWord: 's, or logged events.',
  timestamp: '2025-03-18T03:45:04.839Z'
}
[DocumentChunking] Created chunk: {
  chunkIndex: 15,
  chunkSize: 4030,
  startsWithWord: 'In some cases, inspe',
  endsWithWord: ', and effectiveness.',
  timestamp: '2025-03-18T03:45:04.839Z'
}
[DocumentChunking] Created chunk: {
  chunkIndex: 16,
  chunkSize: 462,
  startsWithWord: 'Inspected the M anag',
  endsWithWord: 'anization Test Appli',
  timestamp: '2025-03-18T03:45:04.839Z'
}
[DocumentChunking] Chunks created: {
  totalChunks: 17,
  averageChunkSize: 3763.6470588235293,
  timestamp: '2025-03-18T03:45:04.839Z'
}
[Document Processing] Processing chunk: {
  fileId: 391,
  chunkIndex: 0,
  progress: '1/17',
  timestamp: '2025-03-18T03:45:04.877Z'
}
[DocumentChunking] Processing chunk: {
  chunkIndex: 0,
  contentLength: 4094,
  fieldsCount: 1,
  timestamp: '2025-03-18T03:45:04.877Z'
}
[OpenAI Service] Starting document analysis: {
  textLength: 4094,
  fieldsCount: 1,
  fieldKeys: [ 'all' ],
  timestamp: '2025-03-18T03:45:04.878Z'
}
[OpenAI Service] Sending request: { promptLength: 4894, timestamp: '2025-03-18T03:45:04.878Z' }
3:45:04 AM [info] POST /api/documents/391/process 200 in 1810ms :: {"status":"processing","totalChunks":17}
[Auth] Deserializing user: 150
New WebSocket client connected
3:45:05 AM [info] GET /api/documents/391/progress 200 in 63ms :: {"status":"processing","progress":{"chunksProcessed":0,"totalChunks":1},"answ...
[Auth] Deserializing user: 150
[OpenAI Service] Analysis completed: {
  answersFound: 1,
  duration: 1437,
  fieldsAnswered: [ 'all' ],
  timestamp: '2025-03-18T03:45:06.315Z'
}
3:45:06 AM [info] GET /api/documents/391/progress 304 in 67ms :: {"status":"processing","progress":{"chunksProcessed":0,"totalChunks":1},"answ...
[DocumentChunking] Chunk processed: {
  chunkIndex: 0,
  answersFound: 1,
  timestamp: '2025-03-18T03:45:06.360Z'
}
[WebSocket] Broadcasting task update: {
  taskId: 391,
  status: 'processing',
  progress: 5.88235294117647,
  metadata: { chunksProcessed: 1, totalChunks: 17, answersFound: 0 }
}
[Document Processing] Chunk processing error: {
  fileId: 391,
  chunkIndex: 0,
  error: 'syntax error at or near "where"',
  timestamp: '2025-03-18T03:45:06.420Z'
}
[Document Processing] Processing chunk: {
  fileId: 391,
  chunkIndex: 1,
  progress: '2/17',
  timestamp: '2025-03-18T03:45:06.420Z'
}
[DocumentChunking] Processing chunk: {
  chunkIndex: 1,
  contentLength: 4055,
  fieldsCount: 1,
  timestamp: '2025-03-18T03:45:06.420Z'
}
[OpenAI Service] Starting document analysis: {
  textLength: 4055,
  fieldsCount: 1,
  fieldKeys: [ 'all' ],
  timestamp: '2025-03-18T03:45:06.420Z'
}
[OpenAI Service] Sending request: { promptLength: 4855, timestamp: '2025-03-18T03:45:06.420Z' }
[Auth] Deserializing user: 150
[Tasks] ====== Starting task fetch =====
[Tasks] User details: { id: 150, company_id: 113, email: 'e.v.a.nc.na.va.r.r.o@gmail.com' }
[Tasks] KYB tasks found: {
  count: 1,
  tasks: [
    {
      id: 195,
      company_id: 113,
      task_scope: 'company',
      task_type: 'company_kyb',
      assigned_to: null,
      status: 'submitted'
    }
  ]
}
[Tasks] Query conditions: {
  conditions: {
    condition1: 'tasks.assigned_to = 150',
    condition2: 'tasks.created_by = 150',
    condition3: "tasks.company_id = 113 AND tasks.assigned_to IS NULL AND tasks.task_scope = 'company'",
    condition4: "tasks.task_type = 'user_onboarding' AND LOWER(tasks.user_email) = LOWER('e.v.a.nc.na.va.r.r.o@gmail.com')"
  }
}
[Tasks] Tasks found: {
  count: 3,
  tasks: [
    {
      id: 197,
      title: 'New User Invitation: e.v.a.nc.na.va.r.r.o@gmail.com',
      assigned_to: 150,
      company_id: 113,
      task_scope: 'user',
      task_type: 'user_onboarding',
      status: 'completed'
    },
    {
      id: 195,
      title: 'Company KYB: Vector',
      assigned_to: null,
      company_id: 113,
      task_scope: 'company',
      task_type: 'company_kyb',
      status: 'submitted'
    },
    {
      id: 196,
      title: 'Company CARD: Vector',
      assigned_to: null,
      company_id: 113,
      task_scope: 'company',
      task_type: 'company_card',
      status: 'in_progress'
    }
  ]
}
3:45:06 AM [info] GET /api/tasks 304 in 94ms :: [{"id":197,"title":"New User Invitation: e.v.a.nc.na.va.r.r.o@gmail.com","des...
[Auth] Deserializing user: 150
[Tasks] ====== Starting task fetch =====
[Tasks] User details: { id: 150, company_id: 113, email: 'e.v.a.nc.na.va.r.r.o@gmail.com' }
[Tasks] KYB tasks found: {
  count: 1,
  tasks: [
    {
      id: 195,
      company_id: 113,
      task_scope: 'company',
      task_type: 'company_kyb',
      assigned_to: null,
      status: 'submitted'
    }
  ]
}
[Tasks] Query conditions: {
  conditions: {
    condition1: 'tasks.assigned_to = 150',
    condition2: 'tasks.created_by = 150',
    condition3: "tasks.company_id = 113 AND tasks.assigned_to IS NULL AND tasks.task_scope = 'company'",
    condition4: "tasks.task_type = 'user_onboarding' AND LOWER(tasks.user_email) = LOWER('e.v.a.nc.na.va.r.r.o@gmail.com')"
  }
}
[Tasks] Tasks found: {
  count: 3,
  tasks: [
    {
      id: 197,
      title: 'New User Invitation: e.v.a.nc.na.va.r.r.o@gmail.com',
      assigned_to: 150,
      company_id: 113,
      task_scope: 'user',
      task_type: 'user_onboarding',
      status: 'completed'
    },
    {
      id: 195,
      title: 'Company KYB: Vector',
      assigned_to: null,
      company_id: 113,
      task_scope: 'company',
      task_type: 'company_kyb',
      status: 'submitted'
    },
    {
      id: 196,
      title: 'Company CARD: Vector',
      assigned_to: null,
      company_id: 113,
      task_scope: 'company',
      task_type: 'company_card',
      status: 'in_progress'
    }
  ]
}
3:45:06 AM [info] GET /api/tasks 304 in 94ms :: [{"id":197,"title":"New User Invitation: e.v.a.nc.na.va.r.r.o@gmail.com","des...
[Auth] Deserializing user: 150
3:45:07 AM [info] GET /api/documents/391/progress 304 in 63ms :: {"status":"processing","progress":{"chunksProcessed":0,"totalChunks":1},"answ...
[Auth] Deserializing user: 150
[Current Company] Fetching company for user: { userId: 150, companyId: 113 }
[Current Company] Found company: { id: 113, name: 'Vector', onboardingCompleted: true }
3:45:07 AM [info] GET /api/companies/current 304 in 63ms :: {"id":113,"name":"Vector","description":"FinTech partner company Vector","cat...
[OpenAI Service] Analysis completed: {
  answersFound: 1,
  duration: 2081,
  fieldsAnswered: [ 'all' ],
  timestamp: '2025-03-18T03:45:08.501Z'
}
[DocumentChunking] Chunk processed: {
  chunkIndex: 1,
  answersFound: 1,
  timestamp: '2025-03-18T03:45:08.534Z'
}
[WebSocket] Broadcasting task update: {
  taskId: 391,
  status: 'processing',
  progress: 11.76470588235294,
  metadata: { chunksProcessed: 2, totalChunks: 17, answersFound: 1 }
}
[Document Processing] Chunk processing error: {
  fileId: 391,
  chunkIndex: 1,
  error: 'syntax error at or near "where"',
  timestamp: '2025-03-18T03:45:08.595Z'
}
[Document Processing] Processing chunk: {
  fileId: 391,
  chunkIndex: 2,
  progress: '3/17',
  timestamp: '2025-03-18T03:45:08.595Z'
}
[DocumentChunking] Processing chunk: {
  chunkIndex: 2,
  contentLength: 3909,
  fieldsCount: 1,
  timestamp: '2025-03-18T03:45:08.596Z'
}
[OpenAI Service] Starting document analysis: {
  textLength: 3909,
  fieldsCount: 1,
  fieldKeys: [ 'all' ],
  timestamp: '2025-03-18T03:45:08.596Z'
}
[OpenAI Service] Sending request: { promptLength: 4709, timestamp: '2025-03-18T03:45:08.596Z' }
[2025-03-18T03:45:08.703Z] New client connected to the pool
[2025-03-18T03:45:08.736Z] New client connected to the pool
[Auth] Deserializing user: 150
[Tasks] ====== Starting task fetch =====
[Tasks] User details: { id: 150, company_id: 113, email: 'e.v.a.nc.na.va.r.r.o@gmail.com' }
[Auth] Deserializing user: 150
[Tasks] KYB tasks found: {
  count: 1,
  tasks: [
    {
      id: 195,
      company_id: 113,
      task_scope: 'company',
      task_type: 'company_kyb',
      assigned_to: null,
      status: 'submitted'
    }
  ]
}
[Tasks] Query conditions: {
  conditions: {
    condition1: 'tasks.assigned_to = 150',
    condition2: 'tasks.created_by = 150',
    condition3: "tasks.company_id = 113 AND tasks.assigned_to IS NULL AND tasks.task_scope = 'company'",
    condition4: "tasks.task_type = 'user_onboarding' AND LOWER(tasks.user_email) = LOWER('e.v.a.nc.na.va.r.r.o@gmail.com')"
  }
}
[Tasks] Tasks found: {
  count: 3,
  tasks: [
    {
      id: 197,
      title: 'New User Invitation: e.v.a.nc.na.va.r.r.o@gmail.com',
      assigned_to: 150,
      company_id: 113,
      task_scope: 'user',
      task_type: 'user_onboarding',
      status: 'completed'
    },
    {
      id: 195,
      title: 'Company KYB: Vector',
      assigned_to: null,
      company_id: 113,
      task_scope: 'company',
      task_type: 'company_kyb',
      status: 'submitted'
    },
    {
      id: 196,
      title: 'Company CARD: Vector',
      assigned_to: null,
      company_id: 113,
      task_scope: 'company',
      task_type: 'company_card',
      status: 'in_progress'
    }
  ]
}
3:45:08 AM [info] GET /api/tasks 304 in 92ms :: [{"id":197,"title":"New User Invitation: e.v.a.nc.na.va.r.r.o@gmail.com","des...
3:45:08 AM [info] GET /api/documents/391/progress 304 in 62ms :: {"status":"processing","progress":{"chunksProcessed":0,"totalChunks":1},"answ...
[Auth] Deserializing user: 150
[Tasks] ====== Starting task fetch =====
[Tasks] User details: { id: 150, company_id: 113, email: 'e.v.a.nc.na.va.r.r.o@gmail.com' }
[Tasks] KYB tasks found: {
  count: 1,
  tasks: [
    {
      id: 195,
      company_id: 113,
      task_scope: 'company',
      task_type: 'company_kyb',
      assigned_to: null,
      status: 'submitted'
    }
  ]
}
[Tasks] Query conditions: {
  conditions: {
    condition1: 'tasks.assigned_to = 150',
    condition2: 'tasks.created_by = 150',
    condition3: "tasks.company_id = 113 AND tasks.assigned_to IS NULL AND tasks.task_scope = 'company'",
    condition4: "tasks.task_type = 'user_onboarding' AND LOWER(tasks.user_email) = LOWER('e.v.a.nc.na.va.r.r.o@gmail.com')"
  }
}
[Tasks] Tasks found: {
  count: 3,
  tasks: [
    {
      id: 197,
      title: 'New User Invitation: e.v.a.nc.na.va.r.r.o@gmail.com',
      assigned_to: 150,
      company_id: 113,
      task_scope: 'user',
      task_type: 'user_onboarding',
      status: 'completed'
    },
    {
      id: 195,
      title: 'Company KYB: Vector',
      assigned_to: null,
      company_id: 113,
      task_scope: 'company',
      task_type: 'company_kyb',
      status: 'submitted'
    },
    {
      id: 196,
      title: 'Company CARD: Vector',
      assigned_to: null,
      company_id: 113,
      task_scope: 'company',
      task_type: 'company_card',
      status: 'in_progress'
    }
  ]
}
3:45:09 AM [info] GET /api/tasks 304 in 104ms :: [{"id":197,"title":"New User Invitation: e.v.a.nc.na.va.r.r.o@gmail.com","des...
[OpenAI Service] Analysis completed: {
  answersFound: 2,
  duration: 1279,
  fieldsAnswered: [ 'all', 'all' ],
  timestamp: '2025-03-18T03:45:09.875Z'
}
[DocumentChunking] Chunk processed: {
  chunkIndex: 2,
  answersFound: 2,
  timestamp: '2025-03-18T03:45:09.912Z'
}
[WebSocket] Broadcasting task update: {
  taskId: 391,
  status: 'processing',
  progress: 17.647058823529413,
  metadata: { chunksProcessed: 3, totalChunks: 17, answersFound: 2 }
}
[Auth] Deserializing user: 150
[Document Processing] Chunk processing error: {
  fileId: 391,
  chunkIndex: 2,
  error: 'syntax error at or near "where"',
  timestamp: '2025-03-18T03:45:09.983Z'
}
[Document Processing] Processing chunk: {
  fileId: 391,
  chunkIndex: 3,
  progress: '4/17',
  timestamp: '2025-03-18T03:45:09.983Z'
}
[DocumentChunking] Processing chunk: {
  chunkIndex: 3,
  contentLength: 3901,
  fieldsCount: 1,
  timestamp: '2025-03-18T03:45:09.983Z'
}
[OpenAI Service] Starting document analysis: {
  textLength: 3901,
  fieldsCount: 1,
  fieldKeys: [ 'all' ],
  timestamp: '2025-03-18T03:45:09.983Z'
}
[OpenAI Service] Sending request: { promptLength: 4701, timestamp: '2025-03-18T03:45:09.983Z' }
3:45:10 AM [info] GET /api/documents/391/progress 304 in 61ms :: {"status":"processing","progress":{"chunksProcessed":0,"totalChunks":1},"answ...
[2025-03-18T03:45:10.076Z] New client connected to the pool
[Auth] Deserializing user: 150
[Tasks] ====== Starting task fetch =====
[Tasks] User details: { id: 150, company_id: 113, email: 'e.v.a.nc.na.va.r.r.o@gmail.com' }
[Tasks] KYB tasks found: {
  count: 1,
  tasks: [
    {
      id: 195,
      company_id: 113,
      task_scope: 'company',
      task_type: 'company_kyb',
      assigned_to: null,
      status: 'submitted'
    }
  ]
}
[Tasks] Query conditions: {
  conditions: {
    condition1: 'tasks.assigned_to = 150',
    condition2: 'tasks.created_by = 150',
    condition3: "tasks.company_id = 113 AND tasks.assigned_to IS NULL AND tasks.task_scope = 'company'",
    condition4: "tasks.task_type = 'user_onboarding' AND LOWER(tasks.user_email) = LOWER('e.v.a.nc.na.va.r.r.o@gmail.com')"
  }
}
[Tasks] Tasks found: {
  count: 3,
  tasks: [
    {
      id: 197,
      title: 'New User Invitation: e.v.a.nc.na.va.r.r.o@gmail.com',
      assigned_to: 150,
      company_id: 113,
      task_scope: 'user',
      task_type: 'user_onboarding',
      status: 'completed'
    },
    {
      id: 195,
      title: 'Company KYB: Vector',
      assigned_to: null,
      company_id: 113,
      task_scope: 'company',
      task_type: 'company_kyb',
      status: 'submitted'
    },
    {
      id: 196,
      title: 'Company CARD: Vector',
      assigned_to: null,
      company_id: 113,
      task_scope: 'company',
      task_type: 'company_card',
      status: 'in_progress'
    }
  ]
}
3:45:10 AM [info] GET /api/tasks 304 in 88ms :: [{"id":197,"title":"New User Invitation: e.v.a.nc.na.va.r.r.o@gmail.com","des...
[Auth] Deserializing user: 150
[Tasks] ====== Starting task fetch =====
[Tasks] User details: { id: 150, company_id: 113, email: 'e.v.a.nc.na.va.r.r.o@gmail.com' }
[Tasks] KYB tasks found: {
  count: 1,
  tasks: [
    {
      id: 195,
      company_id: 113,
      task_scope: 'company',
      task_type: 'company_kyb',
      assigned_to: null,
      status: 'submitted'
    }
  ]
}
[Tasks] Query conditions: {
  conditions: {
    condition1: 'tasks.assigned_to = 150',
    condition2: 'tasks.created_by = 150',
    condition3: "tasks.company_id = 113 AND tasks.assigned_to IS NULL AND tasks.task_scope = 'company'",
    condition4: "tasks.task_type = 'user_onboarding' AND LOWER(tasks.user_email) = LOWER('e.v.a.nc.na.va.r.r.o@gmail.com')"
  }
}
[Tasks] Tasks found: {
  count: 3,
  tasks: [
    {
      id: 197,
      title: 'New User Invitation: e.v.a.nc.na.va.r.r.o@gmail.com',
      assigned_to: 150,
      company_id: 113,
      task_scope: 'user',
      task_type: 'user_onboarding',
      status: 'completed'
    },
    {
      id: 195,
      title: 'Company KYB: Vector',
      assigned_to: null,
      company_id: 113,
      task_scope: 'company',
      task_type: 'company_kyb',
      status: 'submitted'
    },
    {
      id: 196,
      title: 'Company CARD: Vector',
      assigned_to: null,
      company_id: 113,
      task_scope: 'company',
      task_type: 'company_card',
      status: 'in_progress'
    }
  ]
}
3:45:10 AM [info] GET /api/tasks 304 in 90ms :: [{"id":197,"title":"New User Invitation: e.v.a.nc.na.va.r.r.o@gmail.com","des...
[Auth] Deserializing user: 150
3:45:11 AM [info] GET /api/documents/391/progress 304 in 63ms :: {"status":"processing","progress":{"chunksProcessed":0,"totalChunks":1},"answ...
[OpenAI Service] Analysis completed: {
  answersFound: 1,
  duration: 2060,
  fieldsAnswered: [ 'all' ],
  timestamp: '2025-03-18T03:45:12.043Z'
}
[DocumentChunking] Chunk processed: {
  chunkIndex: 3,
  answersFound: 1,
  timestamp: '2025-03-18T03:45:12.075Z'
}
[WebSocket] Broadcasting task update: {
  taskId: 391,
  status: 'processing',
  progress: 23.52941176470588,
  metadata: { chunksProcessed: 4, totalChunks: 17, answersFound: 4 }
}
[Document Processing] Chunk processing error: {
  fileId: 391,
  chunkIndex: 3,
  error: 'syntax error at or near "where"',
  timestamp: '2025-03-18T03:45:12.133Z'
}
[Document Processing] Processing chunk: {
  fileId: 391,
  chunkIndex: 4,
  progress: '5/17',
  timestamp: '2025-03-18T03:45:12.134Z'
}
[DocumentChunking] Processing chunk: {
  chunkIndex: 4,
  contentLength: 3981,
  fieldsCount: 1,
  timestamp: '2025-03-18T03:45:12.134Z'
}
[OpenAI Service] Starting document analysis: {
  textLength: 3981,
  fieldsCount: 1,
  fieldKeys: [ 'all' ],
  timestamp: '2025-03-18T03:45:12.134Z'
}
[OpenAI Service] Sending request: { promptLength: 4781, timestamp: '2025-03-18T03:45:12.134Z' }
[Auth] Deserializing user: 150
[Tasks] ====== Starting task fetch =====
[Tasks] User details: { id: 150, company_id: 113, email: 'e.v.a.nc.na.va.r.r.o@gmail.com' }
[Tasks] KYB tasks found: {
  count: 1,
  tasks: [
    {
      id: 195,
      company_id: 113,
      task_scope: 'company',
      task_type: 'company_kyb',
      assigned_to: null,
      status: 'submitted'
    }
  ]
}
[Tasks] Query conditions: {
  conditions: {
    condition1: 'tasks.assigned_to = 150',
    condition2: 'tasks.created_by = 150',
    condition3: "tasks.company_id = 113 AND tasks.assigned_to IS NULL AND tasks.task_scope = 'company'",
    condition4: "tasks.task_type = 'user_onboarding' AND LOWER(tasks.user_email) = LOWER('e.v.a.nc.na.va.r.r.o@gmail.com')"
  }
}
[Tasks] Tasks found: {
  count: 3,
  tasks: [
    {
      id: 197,
      title: 'New User Invitation: e.v.a.nc.na.va.r.r.o@gmail.com',
      assigned_to: 150,
      company_id: 113,
      task_scope: 'user',
      task_type: 'user_onboarding',
      status: 'completed'
    },
    {
      id: 195,
      title: 'Company KYB: Vector',
      assigned_to: null,
      company_id: 113,
      task_scope: 'company',
      task_type: 'company_kyb',
      status: 'submitted'
    },
    {
      id: 196,
      title: 'Company CARD: Vector',
      assigned_to: null,
      company_id: 113,
      task_scope: 'company',
      task_type: 'company_card',
      status: 'in_progress'
    }
  ]
}
3:45:12 AM [info] GET /api/tasks 304 in 95ms :: [{"id":197,"title":"New User Invitation: e.v.a.nc.na.va.r.r.o@gmail.com","des...
[Auth] Deserializing user: 150
[2025-03-18T03:45:12.446Z] New client connected to the pool
3:45:12 AM [info] GET /api/documents/391/progress 304 in 61ms :: {"status":"processing","progress":{"chunksProcessed":0,"totalChunks":1},"answ...
[Auth] Deserializing user: 150
[Tasks] ====== Starting task fetch =====
[Tasks] User details: { id: 150, company_id: 113, email: 'e.v.a.nc.na.va.r.r.o@gmail.com' }
[Tasks] KYB tasks found: {
  count: 1,
  tasks: [
    {
      id: 195,
      company_id: 113,
      task_scope: 'company',
      task_type: 'company_kyb',
      assigned_to: null,
      status: 'submitted'
    }
  ]
}
[Tasks] Query conditions: {
  conditions: {
    condition1: 'tasks.assigned_to = 150',
    condition2: 'tasks.created_by = 150',
    condition3: "tasks.company_id = 113 AND tasks.assigned_to IS NULL AND tasks.task_scope = 'company'",
    condition4: "tasks.task_type = 'user_onboarding' AND LOWER(tasks.user_email) = LOWER('e.v.a.nc.na.va.r.r.o@gmail.com')"
  }
}
[Tasks] Tasks found: {
  count: 3,
  tasks: [
    {
      id: 197,
      title: 'New User Invitation: e.v.a.nc.na.va.r.r.o@gmail.com',
      assigned_to: 150,
      company_id: 113,
      task_scope: 'user',
      task_type: 'user_onboarding',
      status: 'completed'
    },
    {
      id: 195,
      title: 'Company KYB: Vector',
      assigned_to: null,
      company_id: 113,
      task_scope: 'company',
      task_type: 'company_kyb',
      status: 'submitted'
    },
    {
      id: 196,
      title: 'Company CARD: Vector',
      assigned_to: null,
      company_id: 113,
      task_scope: 'company',
      task_type: 'company_card',
      status: 'in_progress'
    }
  ]
}
3:45:12 AM [info] GET /api/tasks 304 in 89ms :: [{"id":197,"title":"New User Invitation: e.v.a.nc.na.va.r.r.o@gmail.com","des...
[Auth] Deserializing user: 150
[Current Company] Fetching company for user: { userId: 150, companyId: 113 }
[Current Company] Found company: { id: 113, name: 'Vector', onboardingCompleted: true }
3:45:12 AM [info] GET /api/companies/current 304 in 59ms :: {"id":113,"name":"Vector","description":"FinTech partner company Vector","cat...
[Auth] Deserializing user: 150
3:45:13 AM [info] GET /api/documents/391/progress 304 in 59ms :: {"status":"processing","progress":{"chunksProcessed":0,"totalChunks":1},"answ...
[Auth] Deserializing user: 150
3:45:14 AM [info] GET /api/documents/391/progress 304 in 59ms :: {"status":"processing","progress":{"chunksProcessed":0,"totalChunks":1},"answ...
[OpenAI Service] Analysis completed: {
  answersFound: 6,
  duration: 3328,
  fieldsAnswered: [ 'all', 'all', 'all', 'all', 'all', 'all' ],
  timestamp: '2025-03-18T03:45:15.462Z'
}
[DocumentChunking] Chunk processed: {
  chunkIndex: 4,
  answersFound: 6,
  timestamp: '2025-03-18T03:45:15.493Z'
}
[WebSocket] Broadcasting task update: {
  taskId: 391,
  status: 'processing',
  progress: 29.411764705882355,
  metadata: { chunksProcessed: 5, totalChunks: 17, answersFound: 5 }
}
[Document Processing] Chunk processing error: {
  fileId: 391,
  chunkIndex: 4,
  error: 'syntax error at or near "where"',
  timestamp: '2025-03-18T03:45:15.550Z'
}
[Document Processing] Processing chunk: {
  fileId: 391,
  chunkIndex: 5,
  progress: '6/17',
  timestamp: '2025-03-18T03:45:15.550Z'
}
[DocumentChunking] Processing chunk: {
  chunkIndex: 5,
  contentLength: 3919,
  fieldsCount: 1,
  timestamp: '2025-03-18T03:45:15.550Z'
}
[OpenAI Service] Starting document analysis: {
  textLength: 3919,
  fieldsCount: 1,
  fieldKeys: [ 'all' ],
  timestamp: '2025-03-18T03:45:15.550Z'
}
[OpenAI Service] Sending request: { promptLength: 4719, timestamp: '2025-03-18T03:45:15.550Z' }
[Auth] Deserializing user: 150
[Tasks] ====== Starting task fetch =====
[Tasks] User details: { id: 150, company_id: 113, email: 'e.v.a.nc.na.va.r.r.o@gmail.com' }
[Tasks] KYB tasks found: {
  count: 1,
  tasks: [
    {
      id: 195,
      company_id: 113,
      task_scope: 'company',
      task_type: 'company_kyb',
      assigned_to: null,
      status: 'submitted'
    }
  ]
}
[Tasks] Query conditions: {
  conditions: {
    condition1: 'tasks.assigned_to = 150',
    condition2: 'tasks.created_by = 150',
    condition3: "tasks.company_id = 113 AND tasks.assigned_to IS NULL AND tasks.task_scope = 'company'",
    condition4: "tasks.task_type = 'user_onboarding' AND LOWER(tasks.user_email) = LOWER('e.v.a.nc.na.va.r.r.o@gmail.com')"
  }
}
[Tasks] Tasks found: {
  count: 3,
  tasks: [
    {
      id: 197,
      title: 'New User Invitation: e.v.a.nc.na.va.r.r.o@gmail.com',
      assigned_to: 150,
      company_id: 113,
      task_scope: 'user',
      task_type: 'user_onboarding',
      status: 'completed'
    },
    {
      id: 195,
      title: 'Company KYB: Vector',
      assigned_to: null,
      company_id: 113,
      task_scope: 'company',
      task_type: 'company_kyb',
      status: 'submitted'
    },
    {
      id: 196,
      title: 'Company CARD: Vector',
      assigned_to: null,
      company_id: 113,
      task_scope: 'company',
      task_type: 'company_card',
      status: 'in_progress'
    }
  ]
}
3:45:15 AM [info] GET /api/tasks 304 in 92ms :: [{"id":197,"title":"New User Invitation: e.v.a.nc.na.va.r.r.o@gmail.com","des...
[Auth] Deserializing user: 150
[Tasks] ====== Starting task fetch =====
[Tasks] User details: { id: 150, company_id: 113, email: 'e.v.a.nc.na.va.r.r.o@gmail.com' }
[Tasks] KYB tasks found: {
  count: 1,
  tasks: [
    {
      id: 195,
      company_id: 113,
      task_scope: 'company',
      task_type: 'company_kyb',
      assigned_to: null,
      status: 'submitted'
    }
  ]
}
[Tasks] Query conditions: {
  conditions: {
    condition1: 'tasks.assigned_to = 150',
    condition2: 'tasks.created_by = 150',
    condition3: "tasks.company_id = 113 AND tasks.assigned_to IS NULL AND tasks.task_scope = 'company'",
    condition4: "tasks.task_type = 'user_onboarding' AND LOWER(tasks.user_email) = LOWER('e.v.a.nc.na.va.r.r.o@gmail.com')"
  }
}
[Tasks] Tasks found: {
  count: 3,
  tasks: [
    {
      id: 197,
      title: 'New User Invitation: e.v.a.nc.na.va.r.r.o@gmail.com',
      assigned_to: 150,
      company_id: 113,
      task_scope: 'user',
      task_type: 'user_onboarding',
      status: 'completed'
    },
    {
      id: 195,
      title: 'Company KYB: Vector',
      assigned_to: null,
      company_id: 113,
      task_scope: 'company',
      task_type: 'company_kyb',
      status: 'submitted'
    },
    {
      id: 196,
      title: 'Company CARD: Vector',
      assigned_to: null,
      company_id: 113,
      task_scope: 'company',
      task_type: 'company_card',
      status: 'in_progress'
    }
  ]
}
3:45:15 AM [info] GET /api/tasks 304 in 91ms :: [{"id":197,"title":"New User Invitation: e.v.a.nc.na.va.r.r.o@gmail.com","des...
[2025-03-18T03:45:15.970Z] New client connected to the pool
[Auth] Deserializing user: 150
3:45:16 AM [info] GET /api/documents/391/progress 304 in 61ms :: {"status":"processing","progress":{"chunksProcessed":0,"totalChunks":1},"answ...
[Auth] Deserializing user: 150
3:45:17 AM [info] GET /api/documents/391/progress 304 in 60ms :: {"status":"processing","progress":{"chunksProcessed":0,"totalChunks":1},"answ...
[OpenAI Service] Analysis completed: {
  answersFound: 3,
  duration: 1926,
  fieldsAnswered: [ 'all', 'all', 'all' ],
  timestamp: '2025-03-18T03:45:17.476Z'
}
[DocumentChunking] Chunk processed: {
  chunkIndex: 5,
  answersFound: 3,
  timestamp: '2025-03-18T03:45:17.509Z'
}
[WebSocket] Broadcasting task update: {
  taskId: 391,
  status: 'processing',
  progress: 35.294117647058826,
  metadata: { chunksProcessed: 6, totalChunks: 17, answersFound: 11 }
}
[Document Processing] Chunk processing error: {
  fileId: 391,
  chunkIndex: 5,
  error: 'syntax error at or near "where"',
  timestamp: '2025-03-18T03:45:17.567Z'
}
[Document Processing] Processing chunk: {
  fileId: 391,
  chunkIndex: 6,
  progress: '7/17',
  timestamp: '2025-03-18T03:45:17.567Z'
}
[DocumentChunking] Processing chunk: {
  chunkIndex: 6,
  contentLength: 3915,
  fieldsCount: 1,
  timestamp: '2025-03-18T03:45:17.567Z'
}
[OpenAI Service] Starting document analysis: {
  textLength: 3915,
  fieldsCount: 1,
  fieldKeys: [ 'all' ],
  timestamp: '2025-03-18T03:45:17.567Z'
}
[OpenAI Service] Sending request: { promptLength: 4715, timestamp: '2025-03-18T03:45:17.568Z' }
[Auth] Deserializing user: 150
[Tasks] ====== Starting task fetch =====
[Tasks] User details: { id: 150, company_id: 113, email: 'e.v.a.nc.na.va.r.r.o@gmail.com' }
[Tasks] KYB tasks found: {
  count: 1,
  tasks: [
    {
      id: 195,
      company_id: 113,
      task_scope: 'company',
      task_type: 'company_kyb',
      assigned_to: null,
      status: 'submitted'
    }
  ]
}
[Tasks] Query conditions: {
  conditions: {
    condition1: 'tasks.assigned_to = 150',
    condition2: 'tasks.created_by = 150',
    condition3: "tasks.company_id = 113 AND tasks.assigned_to IS NULL AND tasks.task_scope = 'company'",
    condition4: "tasks.task_type = 'user_onboarding' AND LOWER(tasks.user_email) = LOWER('e.v.a.nc.na.va.r.r.o@gmail.com')"
  }
}
[Tasks] Tasks found: {
  count: 3,
  tasks: [
    {
      id: 197,
      title: 'New User Invitation: e.v.a.nc.na.va.r.r.o@gmail.com',
      assigned_to: 150,
      company_id: 113,
      task_scope: 'user',
      task_type: 'user_onboarding',
      status: 'completed'
    },
    {
      id: 195,
      title: 'Company KYB: Vector',
      assigned_to: null,
      company_id: 113,
      task_scope: 'company',
      task_type: 'company_kyb',
      status: 'submitted'
    },
    {
      id: 196,
      title: 'Company CARD: Vector',
      assigned_to: null,
      company_id: 113,
      task_scope: 'company',
      task_type: 'company_card',
      status: 'in_progress'
    }
  ]
}
3:45:17 AM [info] GET /api/tasks 304 in 89ms :: [{"id":197,"title":"New User Invitation: e.v.a.nc.na.va.r.r.o@gmail.com","des...
[Auth] Deserializing user: 150
[Tasks] ====== Starting task fetch =====
[Tasks] User details: { id: 150, company_id: 113, email: 'e.v.a.nc.na.va.r.r.o@gmail.com' }
[Tasks] KYB tasks found: {
  count: 1,
  tasks: [
    {
      id: 195,
      company_id: 113,
      task_scope: 'company',
      task_type: 'company_kyb',
      assigned_to: null,
      status: 'submitted'
    }
  ]
}
[Tasks] Query conditions: {
  conditions: {
    condition1: 'tasks.assigned_to = 150',
    condition2: 'tasks.created_by = 150',
    condition3: "tasks.company_id = 113 AND tasks.assigned_to IS NULL AND tasks.task_scope = 'company'",
    condition4: "tasks.task_type = 'user_onboarding' AND LOWER(tasks.user_email) = LOWER('e.v.a.nc.na.va.r.r.o@gmail.com')"
  }
}
[Tasks] Tasks found: {
  count: 3,
  tasks: [
    {
      id: 197,
      title: 'New User Invitation: e.v.a.nc.na.va.r.r.o@gmail.com',
      assigned_to: 150,
      company_id: 113,
      task_scope: 'user',
      task_type: 'user_onboarding',
      status: 'completed'
    },
    {
      id: 195,
      title: 'Company KYB: Vector',
      assigned_to: null,
      company_id: 113,
      task_scope: 'company',
      task_type: 'company_kyb',
      status: 'submitted'
    },
    {
      id: 196,
      title: 'Company CARD: Vector',
      assigned_to: null,
      company_id: 113,
      task_scope: 'company',
      task_type: 'company_card',
      status: 'in_progress'
    }
  ]
}
3:45:17 AM [info] GET /api/tasks 304 in 92ms :: [{"id":197,"title":"New User Invitation: e.v.a.nc.na.va.r.r.o@gmail.com","des...
[Auth] Deserializing user: 150
[Current Company] Fetching company for user: { userId: 150, companyId: 113 }
[Current Company] Found company: { id: 113, name: 'Vector', onboardingCompleted: true }
3:45:18 AM [info] GET /api/companies/current 304 in 62ms :: {"id":113,"name":"Vector","description":"FinTech partner company Vector","cat...
[Auth] Deserializing user: 150
3:45:18 AM [info] GET /api/documents/391/progress 304 in 60ms :: {"status":"processing","progress":{"chunksProcessed":0,"totalChunks":1},"answ...
[OpenAI Service] Analysis completed: {
  answersFound: 1,
  duration: 1126,
  fieldsAnswered: [ 'all' ],
  timestamp: '2025-03-18T03:45:18.693Z'
}
[DocumentChunking] Chunk processed: {
  chunkIndex: 6,
  answersFound: 1,
  timestamp: '2025-03-18T03:45:18.725Z'
}
[WebSocket] Broadcasting task update: {
  taskId: 391,
  status: 'processing',
  progress: 41.17647058823529,
  metadata: { chunksProcessed: 7, totalChunks: 17, answersFound: 14 }
}
[Document Processing] Chunk processing error: {
  fileId: 391,
  chunkIndex: 6,
  error: 'syntax error at or near "where"',
  timestamp: '2025-03-18T03:45:18.785Z'
}
[Document Processing] Processing chunk: {
  fileId: 391,
  chunkIndex: 7,
  progress: '8/17',
  timestamp: '2025-03-18T03:45:18.785Z'
}
[DocumentChunking] Processing chunk: {
  chunkIndex: 7,
  contentLength: 4002,
  fieldsCount: 1,
  timestamp: '2025-03-18T03:45:18.785Z'
}
[OpenAI Service] Starting document analysis: {
  textLength: 4002,
  fieldsCount: 1,
  fieldKeys: [ 'all' ],
  timestamp: '2025-03-18T03:45:18.786Z'
}
[OpenAI Service] Sending request: { promptLength: 4802, timestamp: '2025-03-18T03:45:18.786Z' }
[2025-03-18T03:45:18.880Z] New client connected to the pool
[Auth] Deserializing user: 150
[Tasks] ====== Starting task fetch =====
[Tasks] User details: { id: 150, company_id: 113, email: 'e.v.a.nc.na.va.r.r.o@gmail.com' }
[Tasks] KYB tasks found: {
  count: 1,
  tasks: [
    {
      id: 195,
      company_id: 113,
      task_scope: 'company',
      task_type: 'company_kyb',
      assigned_to: null,
      status: 'submitted'
    }
  ]
}
[Tasks] Query conditions: {
  conditions: {
    condition1: 'tasks.assigned_to = 150',
    condition2: 'tasks.created_by = 150',
    condition3: "tasks.company_id = 113 AND tasks.assigned_to IS NULL AND tasks.task_scope = 'company'",
    condition4: "tasks.task_type = 'user_onboarding' AND LOWER(tasks.user_email) = LOWER('e.v.a.nc.na.va.r.r.o@gmail.com')"
  }
}
[Tasks] Tasks found: {
  count: 3,
  tasks: [
    {
      id: 197,
      title: 'New User Invitation: e.v.a.nc.na.va.r.r.o@gmail.com',
      assigned_to: 150,
      company_id: 113,
      task_scope: 'user',
      task_type: 'user_onboarding',
      status: 'completed'
    },
    {
      id: 195,
      title: 'Company KYB: Vector',
      assigned_to: null,
      company_id: 113,
      task_scope: 'company',
      task_type: 'company_kyb',
      status: 'submitted'
    },
    {
      id: 196,
      title: 'Company CARD: Vector',
      assigned_to: null,
      company_id: 113,
      task_scope: 'company',
      task_type: 'company_card',
      status: 'in_progress'
    }
  ]
}
3:45:19 AM [info] GET /api/tasks 304 in 95ms :: [{"id":197,"title":"New User Invitation: e.v.a.nc.na.va.r.r.o@gmail.com","des...
[Auth] Deserializing user: 150
[Tasks] ====== Starting task fetch =====
[Tasks] User details: { id: 150, company_id: 113, email: 'e.v.a.nc.na.va.r.r.o@gmail.com' }
[Tasks] KYB tasks found: {
  count: 1,
  tasks: [
    {
      id: 195,
      company_id: 113,
      task_scope: 'company',
      task_type: 'company_kyb',
      assigned_to: null,
      status: 'submitted'
    }
  ]
}
[Tasks] Query conditions: {
  conditions: {
    condition1: 'tasks.assigned_to = 150',
    condition2: 'tasks.created_by = 150',
    condition3: "tasks.company_id = 113 AND tasks.assigned_to IS NULL AND tasks.task_scope = 'company'",
    condition4: "tasks.task_type = 'user_onboarding' AND LOWER(tasks.user_email) = LOWER('e.v.a.nc.na.va.r.r.o@gmail.com')"
  }
}
[Tasks] Tasks found: {
  count: 3,
  tasks: [
    {
      id: 197,
      title: 'New User Invitation: e.v.a.nc.na.va.r.r.o@gmail.com',
      assigned_to: 150,
      company_id: 113,
      task_scope: 'user',
      task_type: 'user_onboarding',
      status: 'completed'
    },
    {
      id: 195,
      title: 'Company KYB: Vector',
      assigned_to: null,
      company_id: 113,
      task_scope: 'company',
      task_type: 'company_kyb',
      status: 'submitted'
    },
    {
      id: 196,
      title: 'Company CARD: Vector',
      assigned_to: null,
      company_id: 113,
      task_scope: 'company',
      task_type: 'company_card',
      status: 'in_progress'
    }
  ]
}
3:45:19 AM [info] GET /api/tasks 304 in 90ms :: [{"id":197,"title":"New User Invitation: e.v.a.nc.na.va.r.r.o@gmail.com","des...
[Auth] Deserializing user: 150
3:45:19 AM [info] GET /api/documents/391/progress 304 in 60ms :: {"status":"processing","progress":{"chunksProcessed":0,"totalChunks":1},"answ...
[Auth] Deserializing user: 150
3:45:20 AM [info] GET /api/documents/391/progress 304 in 62ms :: {"status":"processing","progress":{"chunksProcessed":0,"totalChunks":1},"answ...
[Auth] Deserializing user: 150
[OpenAI Service] Analysis completed: {
  answersFound: 4,
  duration: 3229,
  fieldsAnswered: [ 'all', 'all', 'all', 'all' ],
  timestamp: '2025-03-18T03:45:22.014Z'
}
3:45:22 AM [info] GET /api/documents/391/progress 304 in 60ms :: {"status":"processing","progress":{"chunksProcessed":0,"totalChunks":1},"answ...
[2025-03-18T03:45:22.101Z] New client connected to the pool
[DocumentChunking] Chunk processed: {
  chunkIndex: 7,
  answersFound: 4,
  timestamp: '2025-03-18T03:45:22.141Z'
}
[WebSocket] Broadcasting task update: {
  taskId: 391,
  status: 'processing',
  progress: 47.05882352941176,
  metadata: { chunksProcessed: 8, totalChunks: 17, answersFound: 15 }
}
[Document Processing] Chunk processing error: {
  fileId: 391,
  chunkIndex: 7,
  error: 'syntax error at or near "where"',
  timestamp: '2025-03-18T03:45:22.224Z'
}
[Document Processing] Processing chunk: {
  fileId: 391,
  chunkIndex: 8,
  progress: '9/17',
  timestamp: '2025-03-18T03:45:22.224Z'
}
[DocumentChunking] Processing chunk: {
  chunkIndex: 8,
  contentLength: 3938,
  fieldsCount: 1,
  timestamp: '2025-03-18T03:45:22.224Z'
}
[OpenAI Service] Starting document analysis: {
  textLength: 3938,
  fieldsCount: 1,
  fieldKeys: [ 'all' ],
  timestamp: '2025-03-18T03:45:22.225Z'
}
[OpenAI Service] Sending request: { promptLength: 4738, timestamp: '2025-03-18T03:45:22.225Z' }
[Auth] Deserializing user: 150
[Tasks] ====== Starting task fetch =====
[Tasks] User details: { id: 150, company_id: 113, email: 'e.v.a.nc.na.va.r.r.o@gmail.com' }
[Tasks] KYB tasks found: {
  count: 1,
  tasks: [
    {
      id: 195,
      company_id: 113,
      task_scope: 'company',
      task_type: 'company_kyb',
      assigned_to: null,
      status: 'submitted'
    }
  ]
}
[Tasks] Query conditions: {
  conditions: {
    condition1: 'tasks.assigned_to = 150',
    condition2: 'tasks.created_by = 150',
    condition3: "tasks.company_id = 113 AND tasks.assigned_to IS NULL AND tasks.task_scope = 'company'",
    condition4: "tasks.task_type = 'user_onboarding' AND LOWER(tasks.user_email) = LOWER('e.v.a.nc.na.va.r.r.o@gmail.com')"
  }
}
[Tasks] Tasks found: {
  count: 3,
  tasks: [
    {
      id: 197,
      title: 'New User Invitation: e.v.a.nc.na.va.r.r.o@gmail.com',
      assigned_to: 150,
      company_id: 113,
      task_scope: 'user',
      task_type: 'user_onboarding',
      status: 'completed'
    },
    {
      id: 195,
      title: 'Company KYB: Vector',
      assigned_to: null,
      company_id: 113,
      task_scope: 'company',
      task_type: 'company_kyb',
      status: 'submitted'
    },
    {
      id: 196,
      title: 'Company CARD: Vector',
      assigned_to: null,
      company_id: 113,
      task_scope: 'company',
      task_type: 'company_card',
      status: 'in_progress'
    }
  ]
}
3:45:22 AM [info] GET /api/tasks 304 in 90ms :: [{"id":197,"title":"New User Invitation: e.v.a.nc.na.va.r.r.o@gmail.com","des...
[Auth] Deserializing user: 150
[Tasks] ====== Starting task fetch =====
[Tasks] User details: { id: 150, company_id: 113, email: 'e.v.a.nc.na.va.r.r.o@gmail.com' }
[Tasks] KYB tasks found: {
  count: 1,
  tasks: [
    {
      id: 195,
      company_id: 113,
      task_scope: 'company',
      task_type: 'company_kyb',
      assigned_to: null,
      status: 'submitted'
    }
  ]
}
[Tasks] Query conditions: {
  conditions: {
    condition1: 'tasks.assigned_to = 150',
    condition2: 'tasks.created_by = 150',
    condition3: "tasks.company_id = 113 AND tasks.assigned_to IS NULL AND tasks.task_scope = 'company'",
    condition4: "tasks.task_type = 'user_onboarding' AND LOWER(tasks.user_email) = LOWER('e.v.a.nc.na.va.r.r.o@gmail.com')"
  }
}
[Tasks] Tasks found: {
  count: 3,
  tasks: [
    {
      id: 197,
      title: 'New User Invitation: e.v.a.nc.na.va.r.r.o@gmail.com',
      assigned_to: 150,
      company_id: 113,
      task_scope: 'user',
      task_type: 'user_onboarding',
      status: 'completed'
    },
    {
      id: 195,
      title: 'Company KYB: Vector',
      assigned_to: null,
      company_id: 113,
      task_scope: 'company',
      task_type: 'company_kyb',
      status: 'submitted'
    },
    {
      id: 196,
      title: 'Company CARD: Vector',
      assigned_to: null,
      company_id: 113,
      task_scope: 'company',
      task_type: 'company_card',
      status: 'in_progress'
    }
  ]
}
3:45:22 AM [info] GET /api/tasks 304 in 90ms :: [{"id":197,"title":"New User Invitation: e.v.a.nc.na.va.r.r.o@gmail.com","des...
[Auth] Deserializing user: 150
3:45:23 AM [info] GET /api/documents/391/progress 304 in 61ms :: {"status":"processing","progress":{"chunksProcessed":0,"totalChunks":1},"answ...
[2025-03-18T03:45:23.261Z] New client connected to the pool
[Auth] Deserializing user: 150
[Current Company] Fetching company for user: { userId: 150, companyId: 113 }
[Current Company] Found company: { id: 113, name: 'Vector', onboardingCompleted: true }
3:45:23 AM [info] GET /api/companies/current 304 in 60ms :: {"id":113,"name":"Vector","description":"FinTech partner company Vector","cat...
[OpenAI Service] Analysis completed: {
  answersFound: 2,
  duration: 1307,
  fieldsAnswered: [ 'all', 'all' ],
  timestamp: '2025-03-18T03:45:23.532Z'
}
[DocumentChunking] Chunk processed: {
  chunkIndex: 8,
  answersFound: 2,
  timestamp: '2025-03-18T03:45:23.564Z'
}
[WebSocket] Broadcasting task update: {
  taskId: 391,
  status: 'processing',
  progress: 52.94117647058824,
  metadata: { chunksProcessed: 9, totalChunks: 17, answersFound: 19 }
}
[Document Processing] Chunk processing error: {
  fileId: 391,
  chunkIndex: 8,
  error: 'syntax error at or near "where"',
  timestamp: '2025-03-18T03:45:23.623Z'
}
[Document Processing] Processing chunk: {
  fileId: 391,
  chunkIndex: 9,
  progress: '10/17',
  timestamp: '2025-03-18T03:45:23.623Z'
}
[DocumentChunking] Processing chunk: {
  chunkIndex: 9,
  contentLength: 3981,
  fieldsCount: 1,
  timestamp: '2025-03-18T03:45:23.623Z'
}
[OpenAI Service] Starting document analysis: {
  textLength: 3981,
  fieldsCount: 1,
  fieldKeys: [ 'all' ],
  timestamp: '2025-03-18T03:45:23.623Z'
}
[OpenAI Service] Sending request: { promptLength: 4781, timestamp: '2025-03-18T03:45:23.623Z' }
[Auth] Deserializing user: 150
[Tasks] ====== Starting task fetch =====
[Tasks] User details: { id: 150, company_id: 113, email: 'e.v.a.nc.na.va.r.r.o@gmail.com' }
[Tasks] KYB tasks found: {
  count: 1,
  tasks: [
    {
      id: 195,
      company_id: 113,
      task_scope: 'company',
      task_type: 'company_kyb',
      assigned_to: null,
      status: 'submitted'
    }
  ]
}
[Tasks] Query conditions: {
  conditions: {
    condition1: 'tasks.assigned_to = 150',
    condition2: 'tasks.created_by = 150',
    condition3: "tasks.company_id = 113 AND tasks.assigned_to IS NULL AND tasks.task_scope = 'company'",
    condition4: "tasks.task_type = 'user_onboarding' AND LOWER(tasks.user_email) = LOWER('e.v.a.nc.na.va.r.r.o@gmail.com')"
  }
}
[Tasks] Tasks found: {
  count: 3,
  tasks: [
    {
      id: 197,
      title: 'New User Invitation: e.v.a.nc.na.va.r.r.o@gmail.com',
      assigned_to: 150,
      company_id: 113,
      task_scope: 'user',
      task_type: 'user_onboarding',
      status: 'completed'
    },
    {
      id: 195,
      title: 'Company KYB: Vector',
      assigned_to: null,
      company_id: 113,
      task_scope: 'company',
      task_type: 'company_kyb',
      status: 'submitted'
    },
    {
      id: 196,
      title: 'Company CARD: Vector',
      assigned_to: null,
      company_id: 113,
      task_scope: 'company',
      task_type: 'company_card',
      status: 'in_progress'
    }
  ]
}
3:45:23 AM [info] GET /api/tasks 304 in 90ms :: [{"id":197,"title":"New User Invitation: e.v.a.nc.na.va.r.r.o@gmail.com","des...
[Auth] Deserializing user: 150
[Tasks] ====== Starting task fetch =====
[Tasks] User details: { id: 150, company_id: 113, email: 'e.v.a.nc.na.va.r.r.o@gmail.com' }
[Tasks] KYB tasks found: {
  count: 1,
  tasks: [
    {
      id: 195,
      company_id: 113,
      task_scope: 'company',
      task_type: 'company_kyb',
      assigned_to: null,
      status: 'submitted'
    }
  ]
}
[Tasks] Query conditions: {
  conditions: {
    condition1: 'tasks.assigned_to = 150',
    condition2: 'tasks.created_by = 150',
    condition3: "tasks.company_id = 113 AND tasks.assigned_to IS NULL AND tasks.task_scope = 'company'",
    condition4: "tasks.task_type = 'user_onboarding' AND LOWER(tasks.user_email) = LOWER('e.v.a.nc.na.va.r.r.o@gmail.com')"
  }
}
[Tasks] Tasks found: {
  count: 3,
  tasks: [
    {
      id: 197,
      title: 'New User Invitation: e.v.a.nc.na.va.r.r.o@gmail.com',
      assigned_to: 150,
      company_id: 113,
      task_scope: 'user',
      task_type: 'user_onboarding',
      status: 'completed'
    },
    {
      id: 195,
      title: 'Company KYB: Vector',
      assigned_to: null,
      company_id: 113,
      task_scope: 'company',
      task_type: 'company_kyb',
      status: 'submitted'
    },
    {
      id: 196,
      title: 'Company CARD: Vector',
      assigned_to: null,
      company_id: 113,
      task_scope: 'company',
      task_type: 'company_card',
      status: 'in_progress'
    }
  ]
}
3:45:23 AM [info] GET /api/tasks 304 in 90ms :: [{"id":197,"title":"New User Invitation: e.v.a.nc.na.va.r.r.o@gmail.com","des...
[Auth] Deserializing user: 150