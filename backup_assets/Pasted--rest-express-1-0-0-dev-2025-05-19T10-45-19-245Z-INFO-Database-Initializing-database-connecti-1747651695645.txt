> rest-express@1.0.0 dev
[2025-05-19T10:45:19.245Z] [INFO] [Database] Initializing database connection with optimized settings for Neon PostgreSQL {"module":"Database"}
Database migrations disabled - schema already applied
[EmailService] Initializing email service
[EmailService] Email service initialized successfully
[OpenAI] Service initialized with API key: API key is set
[2025-05-19T10:45:19.382Z] [INFO] [NeonConnectionService] Initializing Neon Connection Service {"module":"NeonConnectionService"}
[WebSocketService] Initialized in fallback mode (WebSocket server not available)
[Routes] Registered KY3P form submission fix routes
[2025-05-19T10:45:19.543Z] [INFO] [App] [KY3P-BATCH-UPDATE] Registering KY3P batch update routes 
[2025-05-19T10:45:19.544Z] [INFO] [App] Registering KY3P batch update routes 
[2025-05-19T10:45:19.544Z] [INFO] [App] [UnifiedKY3P] Registering unified KY3P update routes 
[Routes] Registered KY3P field key router
[Routes] Registered KY3P field key router
[2025-05-19T10:45:19.544Z] [INFO] [App] Registering KY3P field update routes 
[Routes] Setting up unified clear fields router
[Routes] Successfully registered unified clear fields router
[Routes] Setting up task broadcast router
[Routes] Successfully registered task broadcast router
[2025-05-19T10:45:19.545Z] [INFO] [App] [OpenBankingRoutes] Setting up routes... 
[Routes] Setting up transaction-based unified form submission router
[Routes] Successfully registered transaction-based unified form submission router
[Routes] Setting up unified form submission router
[Routes] Successfully registered unified form submission router
[Routes] Setting up transactional form submission router
[Routes] Successfully registered transactional form submission router
[Routes] Routes setup completed
[2025-05-19T10:45:19.547Z] [INFO] [App] [WebSocket] Setting up unified WebSocket server on path /ws 
[2025-05-19T10:45:19.549Z] [INFO] [WebSocket] Unified WebSocket server initialized successfully {"module":"WebSocket","clients":0,"path":"/ws","id":"r7auuy","timestamp":"2025-05-19T10:45:19.549Z"}
[2025-05-19T10:45:19.549Z] [INFO] [App] [WebSocket] Unified WebSocket server initialized successfully 
[2025-05-19T10:45:19.550Z] [WARN] [App] [WebSocket] Form submission WebSocket initialization function not found 
[2025-05-19T10:45:19.550Z] [INFO] [App] [ServerStartup] WebSocket server initialized with unified implementation 
[2025-05-19T10:45:19.550Z] [INFO] [App] [TaskWebSocket] WebSocket server registered with unified implementation 
[2025-05-19T10:45:19.550Z] [INFO] [App] [ServerStartup] WebSocket server registered with task-update utility 
[TaskBroadcast] WebSocket server reference set up
[TaskBroadcast] WebSocket server active with 0 connected clients
[2025-05-19T10:45:19.550Z] [INFO] [App] [ServerStartup] WebSocket server registered with task-broadcast utility 
[2025-05-19T10:45:19.551Z] [INFO] [App] Setting up Vite development server 
[2025-05-19T10:45:19.552Z] [INFO] [App] [ENV] Server will listen on PORT=5000 (deployment mode: no) 
[2025-05-19T10:45:19.552Z] [INFO] [App] [ENV] Environment=development (NODE_ENV explicitly set) 
[2025-05-19T10:45:19.565Z] [INFO] [App] Server running on 0.0.0.0:5000 
[2025-05-19T10:45:19.565Z] [INFO] [App] Environment: development 
[Deployment] Server running on 0.0.0.0:5000
[Deployment] Environment: development
[Deployment] Port forwarding: Custom port: 5000
[Deployment] Development mode: Hot reloading enabled
[2025-05-19T10:45:19.568Z] [INFO] [App] Starting periodic task reconciliation system... 
[PeriodicTaskReconciliation] Stopped periodic reconciliation system
[PeriodicTaskReconciliation] Starting periodic reconciliation system (interval: 300000ms)
[2025-05-19T10:45:19.568Z] [INFO] [App] Task reconciliation system initialized successfully 
[2025-05-19T10:45:20.070Z] [INFO] [WebSocket] Client connected {"module":"WebSocket","clientId":"client-1747651520070-imzr4fo","clients":1}
[2025-05-19T10:45:20.650Z] [INFO] [App] [ServerStartup] WebSocket server active with 1 connected clients 
[2025-05-19T10:45:21.294Z] [INFO] [WebSocket] Client connected {"module":"WebSocket","clientId":"client-1747651521294-qndu226","clients":2}
[2025-05-19T10:45:24.550Z] [INFO] [WebSocket] Client connected {"module":"WebSocket","clientId":"client-1747651524550-kf3b4zc","clients":3}
[2025-05-19T10:45:25.807Z] [INFO] [WebSocket] Received message from client client-1747651524550-kf3b4zc {"module":"WebSocket","type":"authenticate","data":{"timestamp":"2025-05-19T10:45:24.559Z"}}
[2025-05-19T10:45:25.808Z] [INFO] [WebSocket] Authentication from client client-1747651524550-kf3b4zc {"module":"WebSocket","hasToken":true}
[2025-05-19T10:45:25.875Z] [INFO] [WebSocket] Client connected {"module":"WebSocket","clientId":"client-1747651525875-t96jpv1","clients":4}
[2025-05-19T10:45:26.515Z] [INFO] [Database] New database connection established {"module":"Database"}
[2025-05-19T10:45:26.924Z] [INFO] [WebSocket] Received message from client client-1747651520070-imzr4fo {"module":"WebSocket","type":"authenticate","userId":"8","companyId":"1","clientId":"ws_1747651519309_po3ypp8r0","timestamp":"2025-05-19T10:45:26.774Z"}
[2025-05-19T10:45:26.924Z] [INFO] [WebSocket] Authentication from client client-1747651520070-imzr4fo {"module":"WebSocket","userId":"8","companyId":"1","hasToken":true}
[2025-05-19T10:45:28.110Z] [INFO] [WebSocket] Client connected {"module":"WebSocket","clientId":"client-1747651528110-nesu4kf","clients":5}
[2025-05-19T10:45:28.122Z] [INFO] [WebSocket] Client connected {"module":"WebSocket","clientId":"client-1747651528122-4o6q40o","clients":6}
[2025-05-19T10:45:28.167Z] [INFO] [WebSocket] Received message from client client-1747651528110-nesu4kf {"module":"WebSocket","type":"authenticate","data":{"timestamp":"2025-05-19T10:45:28.166Z"}}
[2025-05-19T10:45:28.167Z] [INFO] [WebSocket] Authentication from client client-1747651528110-nesu4kf {"module":"WebSocket","hasToken":true}
[2025-05-19T10:45:28.214Z] [INFO] [WebSocket] Client connected {"module":"WebSocket","clientId":"client-1747651528214-r7wn0gf","clients":7}
[2025-05-19T10:45:28.477Z] [INFO] [WebSocket] Client disconnected {"module":"WebSocket","clientId":"client-1747651528110-nesu4kf","code":1001,"reason":"","remainingClients":6}
[2025-05-19T10:45:28.478Z] [INFO] [WebSocket] Client disconnected {"module":"WebSocket","clientId":"client-1747651528214-r7wn0gf","code":1001,"reason":"","remainingClients":5}
[2025-05-19T10:45:28.478Z] [INFO] [WebSocket] Client disconnected {"module":"WebSocket","clientId":"client-1747651528122-4o6q40o","code":1001,"reason":"","remainingClients":4}
[2025-05-19T10:45:29.570Z] [INFO] [App] Running background health checks... 
[2025-05-19T10:45:29.570Z] [StartupChecks] Running application startup health checks... 
[2025-05-19T10:45:29.570Z] [StartupChecks] Database health check attempt 1/3 
[2025-05-19T10:45:29.571Z] [INFO] [NeonConnectionService] Creating minimal connection pool for Neon PostgreSQL {"module":"NeonConnectionService"}
[2025-05-19T10:45:29.764Z] [INFO] [NeonConnectionService] New client connected to the pool {"module":"NeonConnectionService"}
[2025-05-19T10:45:29.793Z] [INFO] [NeonConnectionService] Connection pool initialized successfully {"module":"NeonConnectionService"}
[2025-05-19T10:45:29.831Z] [DBConnectionService] Database connection check successful 
[2025-05-19T10:45:29.831Z] [StartupChecks] Database health check passed 
[2025-05-19T10:45:29.831Z] [StartupChecks] All startup health checks passed! 
[2025-05-19T10:45:29.831Z] [INFO] [App] All background health checks passed successfully. 
[2025-05-19T10:45:40.190Z] [INFO] [WebSocket] Received message from client client-1747651520070-imzr4fo {"module":"WebSocket","type":"ping","timestamp":"2025-05-19T10:45:40.083Z","connectionId":"ws_1747651519309_po3ypp8r0"}
[PeriodicTaskReconciliation] Reconciling batch of 10 tasks: [
  965, 963, 964, 968,
  972, 967, 969, 973,
  971, 976
]
[Task Progress] Calculated progress for task 965 (open_banking): 0/44 = 0%
[Task Progress] Calculated progress for task 963 (company_kyb): 0/30 = 0%
[Task Progress] Calculated progress for task 964 (ky3p): 0/0 = 0%
[Task Progress] Calculated progress for task 968 (ky3p): 0/0 = 0%
[Task Progress] Calculated progress for task 972 (ky3p): 0/0 = 0%
[Task Progress] Calculated progress for task 967 (company_kyb): 0/30 = 0%
[Task Progress] Calculated progress for task 969 (open_banking): 0/44 = 0%
[Task Progress] Calculated progress for task 973 (open_banking): 0/44 = 0%
[Task Progress] Calculated progress for task 971 (company_kyb): 30/30 = 100%
[Task Progress] Calculated progress for task 976 (company_kyb): 0/30 = 0%
[2025-05-19T10:45:51.415Z] [INFO] [WebSocket] Received message from client client-1747651521294-qndu226 {"module":"WebSocket","type":"ping","timestamp":"2025-05-19T10:45:51.308Z","connectionId":"ws_1747650290873_c83kuohg6"}
[2025-05-19T10:45:54.668Z] [INFO] [WebSocket] Received message from client client-1747651524550-kf3b4zc {"module":"WebSocket","type":"ping"}
[2025-05-19T10:45:55.992Z] [INFO] [WebSocket] Received message from client client-1747651525875-t96jpv1 {"module":"WebSocket","type":"ping","timestamp":"2025-05-19T10:45:55.885Z","connectionId":"ws_1747650290387_hij4fl08h"}
[2025-05-19T10:46:00.191Z] [INFO] [WebSocket] Received message from client client-1747651520070-imzr4fo {"module":"WebSocket","type":"ping","timestamp":"2025-05-19T10:46:00.083Z","connectionId":"ws_1747651519309_po3ypp8r0"}
[2025-05-19T10:46:20.195Z] [INFO] [WebSocket] Received message from client client-1747651520070-imzr4fo {"module":"WebSocket","type":"ping","timestamp":"2025-05-19T10:46:20.083Z","connectionId":"ws_1747651519309_po3ypp8r0"}
[2025-05-19T10:46:21.418Z] [INFO] [WebSocket] Received message from client client-1747651521294-qndu226 {"module":"WebSocket","type":"ping","timestamp":"2025-05-19T10:46:21.308Z","connectionId":"ws_1747650290873_c83kuohg6"}
[2025-05-19T10:46:24.668Z] [INFO] [WebSocket] Received message from client client-1747651524550-kf3b4zc {"module":"WebSocket","type":"ping"}
[2025-05-19T10:46:25.992Z] [INFO] [WebSocket] Received message from client client-1747651525875-t96jpv1 {"module":"WebSocket","type":"ping","timestamp":"2025-05-19T10:46:25.885Z","connectionId":"ws_1747650290387_hij4fl08h"}
[2025-05-19T10:46:40.190Z] [INFO] [WebSocket] Received message from client client-1747651520070-imzr4fo {"module":"WebSocket","type":"ping","timestamp":"2025-05-19T10:46:40.083Z","connectionId":"ws_1747651519309_po3ypp8r0"}
[2025-05-19T10:46:51.416Z] [INFO] [WebSocket] Received message from client client-1747651521294-qndu226 {"module":"WebSocket","type":"ping","timestamp":"2025-05-19T10:46:51.308Z","connectionId":"ws_1747650290873_c83kuohg6"}
[2025-05-19T10:46:54.668Z] [INFO] [WebSocket] Received message from client client-1747651524550-kf3b4zc {"module":"WebSocket","type":"ping"}
[2025-05-19T10:46:55.992Z] [INFO] [WebSocket] Received message from client client-1747651525875-t96jpv1 {"module":"WebSocket","type":"ping","timestamp":"2025-05-19T10:46:55.886Z","connectionId":"ws_1747650290387_hij4fl08h"}
[2025-05-19T10:47:00.201Z] [INFO] [WebSocket] Received message from client client-1747651520070-imzr4fo {"module":"WebSocket","type":"ping","timestamp":"2025-05-19T10:47:00.083Z","connectionId":"ws_1747651519309_po3ypp8r0"}
[Invite Debug] Starting validation for code: D6284C
[Invite Debug] Found valid invitation: {
  id: 397,
  email: 'e@e.com',
  status: 'pending',
  expires_at: 2025-05-26T08:19:06.202Z
}
[2025-05-19T10:47:12.378Z] [INFO] [App] GET /api/invitations/D6284C/validate 304 in 107ms :: {"valid":true,"invitation":{"email":"e@e.com","invitee_name":"DemoTest","comp... 
[2025-05-19T10:47:20.190Z] [INFO] [WebSocket] Received message from client client-1747651520070-imzr4fo {"module":"WebSocket","type":"ping","timestamp":"2025-05-19T10:47:20.083Z","connectionId":"ws_1747651519309_po3ypp8r0"}
[2025-05-19T10:47:21.415Z] [INFO] [WebSocket] Received message from client client-1747651521294-qndu226 {"module":"WebSocket","type":"ping","timestamp":"2025-05-19T10:47:21.308Z","connectionId":"ws_1747650290873_c83kuohg6"}
[2025-05-19T10:47:22.104Z] [INFO] [WebSocket] Client disconnected {"module":"WebSocket","clientId":"client-1747651520070-imzr4fo","code":1001,"reason":"","remainingClients":3}
[2025-05-19T10:47:22.107Z] [INFO] [WebSocket] Client disconnected {"module":"WebSocket","clientId":"client-1747651525875-t96jpv1","code":1001,"reason":"","remainingClients":2}
[2025-05-19T10:47:22.107Z] [INFO] [WebSocket] Client disconnected {"module":"WebSocket","clientId":"client-1747651524550-kf3b4zc","code":1001,"reason":"","remainingClients":1}
[2025-05-19T10:47:22.107Z] [INFO] [WebSocket] Client disconnected {"module":"WebSocket","clientId":"client-1747651521294-qndu226","code":1001,"reason":"","remainingClients":0}
[2025-05-19T10:47:23.218Z] [INFO] [Database] New database connection established {"module":"Database"}
[2025-05-19T10:47:23.623Z] [INFO] [Database] New database connection established {"module":"Database"}
[2025-05-19T10:47:31.191Z] [INFO] [WebSocket] Client connected {"module":"WebSocket","clientId":"client-1747651651191-omp062r","clients":1}
[2025-05-19T10:47:31.307Z] [INFO] [WebSocket] Received message from client client-1747651651191-omp062r {"module":"WebSocket","type":"authenticate","data":{"timestamp":"2025-05-19T10:47:31.201Z"}}
[2025-05-19T10:47:31.307Z] [INFO] [WebSocket] Authentication from client client-1747651651191-omp062r {"module":"WebSocket","hasToken":true}
[2025-05-19T10:47:31.682Z] [INFO] [WebSocket] Client connected {"module":"WebSocket","clientId":"client-1747651651682-oara0d1","clients":2}
[2025-05-19T10:47:32.184Z] [INFO] [WebSocket] Client connected {"module":"WebSocket","clientId":"client-1747651652183-78efvg8","clients":3}
[2025-05-19T10:47:32.689Z] [INFO] [WebSocket] Client connected {"module":"WebSocket","clientId":"client-1747651652689-te58kz9","clients":4}
[Invite Debug] Starting validation for code: D6284C
[2025-05-19T10:47:33.186Z] [INFO] [WebSocket] Client connected {"module":"WebSocket","clientId":"client-1747651653186-k1blgm1","clients":5}
[Invite Debug] Found valid invitation: {
  id: 397,
  email: 'e@e.com',
  status: 'pending',
  expires_at: 2025-05-26T08:19:06.202Z
}
[2025-05-19T10:47:33.347Z] [INFO] [App] GET /api/invitations/D6284C/validate 304 in 163ms :: {"valid":true,"invitation":{"email":"e@e.com","invitee_name":"DemoTest","comp... 
[2025-05-19T10:47:33.479Z] [INFO] [WebSocket] Received message from client client-1747651653186-k1blgm1 {"module":"WebSocket","type":"authenticate","userId":"8","companyId":"1","clientId":"ws_1747651651761_2wtw47moa","timestamp":"2025-05-19T10:47:33.374Z"}
[2025-05-19T10:47:33.480Z] [INFO] [WebSocket] Authentication from client client-1747651653186-k1blgm1 {"module":"WebSocket","userId":"8","companyId":"1","hasToken":true}
[2025-05-19T10:47:43.095Z] [INFO] [App] POST /api/account-setup 200 in 38ms 
[AuthService] Login failed { email: undefined }
[Invite Debug] Starting validation for code: D6284C
[Invite Debug] Found valid invitation: {
  id: 397,
  email: 'e@e.com',
  status: 'pending',
  expires_at: 2025-05-26T08:19:06.202Z
}
[2025-05-19T10:47:43.664Z] [INFO] [App] GET /api/invitations/D6284C/validate 304 in 84ms :: {"valid":true,"invitation":{"email":"e@e.com","invitee_name":"DemoTest","comp... 
[2025-05-19T10:47:45.947Z] [INFO] [WebSocket] Client disconnected {"module":"WebSocket","clientId":"client-1747651653186-k1blgm1","code":1001,"reason":"","remainingClients":4}
[2025-05-19T10:47:45.948Z] [INFO] [WebSocket] Client disconnected {"module":"WebSocket","clientId":"client-1747651651191-omp062r","code":1001,"reason":"","remainingClients":3}
[2025-05-19T10:47:45.949Z] [INFO] [WebSocket] Client disconnected {"module":"WebSocket","clientId":"client-1747651652183-78efvg8","code":1001,"reason":"","remainingClients":2}
[2025-05-19T10:47:45.949Z] [INFO] [WebSocket] Client disconnected {"module":"WebSocket","clientId":"client-1747651651682-oara0d1","code":1001,"reason":"","remainingClients":1}
[2025-05-19T10:47:45.949Z] [INFO] [WebSocket] Client disconnected {"module":"WebSocket","clientId":"client-1747651652689-te58kz9","code":1001,"reason":"","remainingClients":0}
[2025-05-19T10:47:53.930Z] [INFO] [WebSocket] Client connected {"module":"WebSocket","clientId":"client-1747651673930-q7br9l4","clients":1}
[2025-05-19T10:47:54.047Z] [INFO] [WebSocket] Received message from client client-1747651673930-q7br9l4 {"module":"WebSocket","type":"authenticate","data":{"timestamp":"2025-05-19T10:47:53.939Z"}}
[2025-05-19T10:47:54.047Z] [INFO] [WebSocket] Authentication from client client-1747651673930-q7br9l4 {"module":"WebSocket","hasToken":true}
[2025-05-19T10:47:54.410Z] [INFO] [WebSocket] Client connected {"module":"WebSocket","clientId":"client-1747651674410-r4yin13","clients":2}
[2025-05-19T10:47:54.899Z] [INFO] [WebSocket] Client connected {"module":"WebSocket","clientId":"client-1747651674899-3la491m","clients":3}
[2025-05-19T10:47:55.382Z] [INFO] [WebSocket] Client connected {"module":"WebSocket","clientId":"client-1747651675382-6uqwnru","clients":4}
[2025-05-19T10:47:55.879Z] [INFO] [WebSocket] Client connected {"module":"WebSocket","clientId":"client-1747651675879-joevmv1","clients":5}
[2025-05-19T10:47:56.176Z] [INFO] [WebSocket] Received message from client client-1747651675879-joevmv1 {"module":"WebSocket","type":"authenticate","userId":"8","companyId":"1","clientId":"ws_1747651674500_5h0h817ya","timestamp":"2025-05-19T10:47:56.069Z"}
[2025-05-19T10:47:56.176Z] [INFO] [WebSocket] Authentication from client client-1747651675879-joevmv1 {"module":"WebSocket","userId":"8","companyId":"1","hasToken":true}